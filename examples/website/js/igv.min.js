!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.igv=t()}(this,function(){var e,t,n;n="undefined"!=typeof window?window:this,e=function(e){var t=[],n=e.document,i=t.slice,r=t.concat,o=t.push,a=t.indexOf,s={},l=s.toString,c=s.hasOwnProperty,h={},u=function(e,t){return new u.fn.init(e,t)},f=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,d=/-([\da-z])/gi,g=function(e,t){return t.toUpperCase()};function m(e){var t=!!e&&"length"in e&&e.length,n=u.type(e);return"function"!==n&&!u.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}u.fn=u.prototype={jquery:"1.12.4",constructor:u,selector:"",length:0,toArray:function(){return i.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:i.call(this)},pushStack:function(e){var t=u.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return u.each(this,e)},map:function(e){return this.pushStack(u.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:t.sort,splice:t.splice},u.extend=u.fn.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||u.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(r=arguments[s]))for(i in r)e=a[i],a!==(n=r[i])&&(c&&n&&(u.isPlainObject(n)||(t=u.isArray(n)))?(t?(t=!1,o=e&&u.isArray(e)?e:[]):o=e&&u.isPlainObject(e)?e:{},a[i]=u.extend(c,o,n)):void 0!==n&&(a[i]=n));return a},u.extend({expando:"jQuery"+("1.12.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===u.type(e)},isArray:Array.isArray||function(e){return"array"===u.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!u.isArray(e)&&t-parseFloat(t)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==u.type(e)||e.nodeType||u.isWindow(e))return!1;try{if(e.constructor&&!c.call(e,"constructor")&&!c.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(!h.ownFirst)for(t in e)return c.call(e,t);for(t in e);return void 0===t||c.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?s[l.call(e)]||"object":typeof e},globalEval:function(t){t&&u.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(p,"ms-").replace(d,g)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,i=0;if(m(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(f,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(m(Object(e))?u.merge(n,"string"==typeof e?[e]:e):o.call(n,e)),n},inArray:function(e,t,n){var i;if(t){if(a)return a.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;)e[r++]=t[i++];if(n!=n)for(;void 0!==t[i];)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,a=!n;r<o;r++)!t(e[r],r)!==a&&i.push(e[r]);return i},map:function(e,t,n){var i,o,a=0,s=[];if(m(e))for(i=e.length;a<i;a++)null!=(o=t(e[a],a,n))&&s.push(o);else for(a in e)null!=(o=t(e[a],a,n))&&s.push(o);return r.apply([],s)},guid:1,proxy:function(e,t){var n,r,o;if("string"==typeof t&&(o=e[t],t=e,e=o),u.isFunction(e))return n=i.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(i.call(arguments)))}).guid=e.guid=e.guid||u.guid++,r},now:function(){return+new Date},support:h}),"function"==typeof Symbol&&(u.fn[Symbol.iterator]=t[Symbol.iterator]),u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){s["[object "+t+"]"]=t.toLowerCase()});var v=function(e){var t,n,i,r,o,a,s,l,c,h,u,f,p,d,g,m,v,y,w,b="sizzle"+1*new Date,x=e.document,k=0,S=0,C=oe(),T=oe(),_=oe(),A=function(e,t){return e===t&&(u=!0),0},I=1<<31,R={}.hasOwnProperty,P=[],E=P.pop,L=P.push,M=P.push,D=P.slice,F=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",O="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",H="\\["+N+"*("+O+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+N+"*\\]",z=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+H+")*)|.*)\\)|)",$=new RegExp(N+"+","g"),G=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),U=new RegExp("^"+N+"*,"+N+"*"),W=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),V=new RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),q=new RegExp(z),j=new RegExp("^"+O+"$"),X={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,J=/[+~]/,ee=/'|\\/g,te=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),ne=function(e,t,n){var i="0x"+t-65536;return i!=i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},ie=function(){f()};try{M.apply(P=D.call(x.childNodes),x.childNodes),P[x.childNodes.length].nodeType}catch(e){M={apply:P.length?function(e,t){L.apply(e,D.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function re(e,t,i,r){var o,s,c,h,u,d,v,y,k=t&&t.ownerDocument,S=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==S&&9!==S&&11!==S)return i;if(!r&&((t?t.ownerDocument||t:x)!==p&&f(t),t=t||p,g)){if(11!==S&&(d=Q.exec(e)))if(o=d[1]){if(9===S){if(!(c=t.getElementById(o)))return i;if(c.id===o)return i.push(c),i}else if(k&&(c=k.getElementById(o))&&w(t,c)&&c.id===o)return i.push(c),i}else{if(d[2])return M.apply(i,t.getElementsByTagName(e)),i;if((o=d[3])&&n.getElementsByClassName&&t.getElementsByClassName)return M.apply(i,t.getElementsByClassName(o)),i}if(n.qsa&&!_[e+" "]&&(!m||!m.test(e))){if(1!==S)k=t,y=e;else if("object"!==t.nodeName.toLowerCase()){for((h=t.getAttribute("id"))?h=h.replace(ee,"\\$&"):t.setAttribute("id",h=b),v=a(e),s=v.length,u=j.test(h)?"#"+h:"[id='"+h+"']";s--;)v[s]=u+" "+ge(v[s]);y=v.join(","),k=J.test(e)&&pe(t.parentNode)||t}if(y)try{return M.apply(i,k.querySelectorAll(y)),i}catch(e){}finally{h===b&&t.removeAttribute("id")}}}return l(e.replace(G,"$1"),t,i,r)}function oe(){var e=[];return function t(n,r){return e.push(n+" ")>i.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function ae(e){return e[b]=!0,e}function se(e){var t=p.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var n=e.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=t}function ce(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||I)-(~e.sourceIndex||I);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function he(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ue(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function fe(e){return ae(function(t){return t=+t,ae(function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function pe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=re.support={},o=re.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},f=re.setDocument=function(e){var t,r,a=e?e.ownerDocument||e:x;return a!==p&&9===a.nodeType&&a.documentElement?(d=(p=a).documentElement,g=!o(p),(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ie,!1):r.attachEvent&&r.attachEvent("onunload",ie)),n.attributes=se(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=se(function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Z.test(p.getElementsByClassName),n.getById=se(function(e){return d.appendChild(e).id=b,!p.getElementsByName||!p.getElementsByName(b).length}),n.getById?(i.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}},i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],m=[],(n.qsa=Z.test(p.querySelectorAll))&&(se(function(e){d.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+N+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+N+"*(?:value|"+B+")"),e.querySelectorAll("[id~="+b+"-]").length||m.push("~="),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]")}),se(function(e){var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+N+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=Z.test(y=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&se(function(e){n.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),v.push("!=",z)}),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),t=Z.test(d.compareDocumentPosition),w=t||Z.test(d.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},A=t?function(e,t){if(e===t)return u=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i||(1&(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===i?e===p||e.ownerDocument===x&&w(x,e)?-1:t===p||t.ownerDocument===x&&w(x,t)?1:h?F(h,e)-F(h,t):0:4&i?-1:1)}:function(e,t){if(e===t)return u=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!r||!o)return e===p?-1:t===p?1:r?-1:o?1:h?F(h,e)-F(h,t):0;if(r===o)return ce(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[i]===s[i];)i++;return i?ce(a[i],s[i]):a[i]===x?-1:s[i]===x?1:0},p):p},re.matches=function(e,t){return re(e,null,null,t)},re.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&f(e),t=t.replace(V,"='$1']"),n.matchesSelector&&g&&!_[t+" "]&&(!v||!v.test(t))&&(!m||!m.test(t)))try{var i=y.call(e,t);if(i||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return re(t,p,null,[e]).length>0},re.contains=function(e,t){return(e.ownerDocument||e)!==p&&f(e),w(e,t)},re.attr=function(e,t){(e.ownerDocument||e)!==p&&f(e);var r=i.attrHandle[t.toLowerCase()],o=r&&R.call(i.attrHandle,t.toLowerCase())?r(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},re.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},re.uniqueSort=function(e){var t,i=[],r=0,o=0;if(u=!n.detectDuplicates,h=!n.sortStable&&e.slice(0),e.sort(A),u){for(;t=e[o++];)t===e[o]&&(r=i.push(o));for(;r--;)e.splice(i[r],1)}return h=null,e},r=re.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=r(t);return n},(i=re.selectors={cacheLength:50,createPseudo:ae,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||re.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&re.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&q.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|"+N+")"+e+"("+N+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(i){var r=re.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace($," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,h,u,f,p,d,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s,w=!1;if(m){if(o){for(;g;){for(f=t;f=f[g];)if(s?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[a?m.firstChild:m.lastChild],a&&y){for(u=(f=m)[b]||(f[b]={}),h=u[f.uniqueID]||(u[f.uniqueID]={}),c=h[e]||[],p=c[0]===k&&c[1],w=p&&c[2],f=p&&m.childNodes[p];f=++p&&f&&f[g]||(w=p=0)||d.pop();)if(1===f.nodeType&&++w&&f===t){h[e]=[k,p,w];break}}else if(y&&(u=(f=t)[b]||(f[b]={}),h=u[f.uniqueID]||(u[f.uniqueID]={}),c=h[e]||[],p=c[0]===k&&c[1],w=p),!1===w)for(;(f=++p&&f&&f[g]||(w=p=0)||d.pop())&&((s?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++w||(y&&(u=f[b]||(f[b]={}),(h=u[f.uniqueID]||(u[f.uniqueID]={}))[e]=[k,w]),f!==t)););return(w-=r)===i||w%i==0&&w/i>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||re.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ae(function(e,n){for(var i,o=r(e,t),a=o.length;a--;)i=F(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ae(function(e){var t=[],n=[],i=s(e.replace(G,"$1"));return i[b]?ae(function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}}),has:ae(function(e){return function(t){return re(e,t).length>0}}),contains:ae(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||t.innerText||r(t)).indexOf(e)>-1}}),lang:ae(function(e){return j.test(e||"")||re.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:fe(function(){return[0]}),last:fe(function(e,t){return[t-1]}),eq:fe(function(e,t,n){return[n<0?n+t:n]}),even:fe(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:fe(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:fe(function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i);return e}),gt:fe(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=he(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ue(t);function de(){}function ge(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function me(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=S++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,a){var s,l,c,h=[k,o];if(a){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||r){if(c=t[b]||(t[b]={}),l=c[t.uniqueID]||(c[t.uniqueID]={}),(s=l[i])&&s[0]===k&&s[1]===o)return h[2]=s[2];if(l[i]=h,h[2]=e(t,n,a))return!0}}}function ve(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function ye(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}function we(e,t,n,i,r,o){return i&&!i[b]&&(i=we(i)),r&&!r[b]&&(r=we(r,o)),ae(function(o,a,s,l){var c,h,u,f=[],p=[],d=a.length,g=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)re(e,t[i],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:ye(g,f,e,s,l),v=n?r||(o?e:d||i)?[]:a:m;if(n&&n(m,v,s,l),i)for(c=ye(v,p),i(c,[],s,l),h=c.length;h--;)(u=c[h])&&(v[p[h]]=!(m[p[h]]=u));if(o){if(r||e){if(r){for(c=[],h=v.length;h--;)(u=v[h])&&c.push(m[h]=u);r(null,v=[],c,l)}for(h=v.length;h--;)(u=v[h])&&(c=r?F(o,u):f[h])>-1&&(o[c]=!(a[c]=u))}}else v=ye(v===a?v.splice(d,v.length):v),r?r(null,a,v,l):M.apply(a,v)})}function be(e){for(var t,n,r,o=e.length,a=i.relative[e[0].type],s=a||i.relative[" "],l=a?1:0,h=me(function(e){return e===t},s,!0),u=me(function(e){return F(t,e)>-1},s,!0),f=[function(e,n,i){var r=!a&&(i||n!==c)||((t=n).nodeType?h(e,n,i):u(e,n,i));return t=null,r}];l<o;l++)if(n=i.relative[e[l].type])f=[me(ve(f),n)];else{if((n=i.filter[e[l].type].apply(null,e[l].matches))[b]){for(r=++l;r<o&&!i.relative[e[r].type];r++);return we(l>1&&ve(f),l>1&&ge(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(G,"$1"),n,l<r&&be(e.slice(l,r)),r<o&&be(e=e.slice(r)),r<o&&ge(e))}f.push(n)}return ve(f)}return de.prototype=i.filters=i.pseudos,i.setFilters=new de,a=re.tokenize=function(e,t){var n,r,o,a,s,l,c,h=T[e+" "];if(h)return t?0:h.slice(0);for(s=e,l=[],c=i.preFilter;s;){for(a in n&&!(r=U.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(o=[])),n=!1,(r=W.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(G," ")}),s=s.slice(n.length)),i.filter)!(r=X[a].exec(s))||c[a]&&!(r=c[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?re.error(e):T(e,l).slice(0)},s=re.compile=function(e,t){var n,r,o,s,l,h,u=[],d=[],m=_[e+" "];if(!m){for(t||(t=a(e)),n=t.length;n--;)(m=be(t[n]))[b]?u.push(m):d.push(m);(m=_(e,(r=d,s=(o=u).length>0,l=r.length>0,h=function(e,t,n,a,h){var u,d,m,v=0,y="0",w=e&&[],b=[],x=c,S=e||l&&i.find.TAG("*",h),C=k+=null==x?1:Math.random()||.1,T=S.length;for(h&&(c=t===p||t||h);y!==T&&null!=(u=S[y]);y++){if(l&&u){for(d=0,t||u.ownerDocument===p||(f(u),n=!g);m=r[d++];)if(m(u,t||p,n)){a.push(u);break}h&&(k=C)}s&&((u=!m&&u)&&v--,e&&w.push(u))}if(v+=y,s&&y!==v){for(d=0;m=o[d++];)m(w,b,t,n);if(e){if(v>0)for(;y--;)w[y]||b[y]||(b[y]=E.call(a));b=ye(b)}M.apply(a,b),h&&!e&&b.length>0&&v+o.length>1&&re.uniqueSort(a)}return h&&(k=C,c=x),w},s?ae(h):h))).selector=e}return m},l=re.select=function(e,t,r,o){var l,c,h,u,f,p="function"==typeof e&&e,d=!o&&a(e=p.selector||e);if(r=r||[],1===d.length){if((c=d[0]=d[0].slice(0)).length>2&&"ID"===(h=c[0]).type&&n.getById&&9===t.nodeType&&g&&i.relative[c[1].type]){if(!(t=(i.find.ID(h.matches[0].replace(te,ne),t)||[])[0]))return r;p&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(l=X.needsContext.test(e)?0:c.length;l--&&(h=c[l],!i.relative[u=h.type]);)if((f=i.find[u])&&(o=f(h.matches[0].replace(te,ne),J.test(c[0].type)&&pe(t.parentNode)||t))){if(c.splice(l,1),!(e=o.length&&ge(c)))return M.apply(r,o),r;break}}return(p||s(e,d))(o,t,!g,r,!t||J.test(e)&&pe(t.parentNode)||t),r},n.sortStable=b.split("").sort(A).join("")===b,n.detectDuplicates=!!u,f(),n.sortDetached=se(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),se(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&se(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),se(function(e){return null==e.getAttribute("disabled")})||le(B,function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),re}(e);u.find=v,u.expr=v.selectors,u.expr[":"]=u.expr.pseudos,u.uniqueSort=u.unique=v.uniqueSort,u.text=v.getText,u.isXMLDoc=v.isXML,u.contains=v.contains;var y=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&u(e).is(n))break;i.push(e)}return i},w=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},b=u.expr.match.needsContext,x=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,k=/^.[^:#\[\.,]*$/;function S(e,t,n){if(u.isFunction(t))return u.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return u.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(k.test(t))return u.filter(t,e,n);t=u.filter(t,e)}return u.grep(e,function(e){return u.inArray(e,t)>-1!==n})}u.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?u.find.matchesSelector(i,e)?[i]:[]:u.find.matches(e,u.grep(t,function(e){return 1===e.nodeType}))},u.fn.extend({find:function(e){var t,n=[],i=this,r=i.length;if("string"!=typeof e)return this.pushStack(u(e).filter(function(){for(t=0;t<r;t++)if(u.contains(i[t],this))return!0}));for(t=0;t<r;t++)u.find(e,i[t],n);return(n=this.pushStack(r>1?u.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(S(this,e||[],!1))},not:function(e){return this.pushStack(S(this,e||[],!0))},is:function(e){return!!S(this,"string"==typeof e&&b.test(e)?u(e):e||[],!1).length}});var C,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(u.fn.init=function(e,t,i){var r,o;if(!e)return this;if(i=i||C,"string"==typeof e){if(!(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e))||!r[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof u?t[0]:t,u.merge(this,u.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:n,!0)),x.test(r[1])&&u.isPlainObject(t))for(r in t)u.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}if((o=n.getElementById(r[2]))&&o.parentNode){if(o.id!==r[2])return C.find(e);this.length=1,this[0]=o}return this.context=n,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):u.isFunction(e)?void 0!==i.ready?i.ready(e):e(u):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),u.makeArray(e,this))}).prototype=u.fn,C=u(n);var _=/^(?:parents|prev(?:Until|All))/,A={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}u.fn.extend({has:function(e){var t,n=u(e,this),i=n.length;return this.filter(function(){for(t=0;t<i;t++)if(u.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=b.test(e)||"string"!=typeof e?u(e,t||this.context):0;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&u.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?u.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.inArray(this[0],u(e)):u.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(u.uniqueSort(u.merge(this.get(),u(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),u.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return y(e,"parentNode")},parentsUntil:function(e,t,n){return y(e,"parentNode",n)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return y(e,"nextSibling")},prevAll:function(e){return y(e,"previousSibling")},nextUntil:function(e,t,n){return y(e,"nextSibling",n)},prevUntil:function(e,t,n){return y(e,"previousSibling",n)},siblings:function(e){return w((e.parentNode||{}).firstChild,e)},children:function(e){return w(e.firstChild)},contents:function(e){return u.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:u.merge([],e.childNodes)}},function(e,t){u.fn[e]=function(n,i){var r=u.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=u.filter(i,r)),this.length>1&&(A[e]||(r=u.uniqueSort(r)),_.test(e)&&(r=r.reverse())),this.pushStack(r)}});var R,P,E=/\S+/g;function L(){n.addEventListener?(n.removeEventListener("DOMContentLoaded",M),e.removeEventListener("load",M)):(n.detachEvent("onreadystatechange",M),e.detachEvent("onload",M))}function M(){(n.addEventListener||"load"===e.event.type||"complete"===n.readyState)&&(L(),u.ready())}for(P in u.Callbacks=function(e){var t,n;e="string"==typeof e?(t=e,n={},u.each(t.match(E)||[],function(e,t){n[t]=!0}),n):u.extend({},e);var i,r,o,a,s=[],l=[],c=-1,h=function(){for(a=e.once,o=i=!0;l.length;c=-1)for(r=l.shift();++c<s.length;)!1===s[c].apply(r[0],r[1])&&e.stopOnFalse&&(c=s.length,r=!1);e.memory||(r=!1),i=!1,a&&(s=r?[]:"")},f={add:function(){return s&&(r&&!i&&(c=s.length-1,l.push(r)),function t(n){u.each(n,function(n,i){u.isFunction(i)?e.unique&&f.has(i)||s.push(i):i&&i.length&&"string"!==u.type(i)&&t(i)})}(arguments),r&&!i&&h()),this},remove:function(){return u.each(arguments,function(e,t){for(var n;(n=u.inArray(t,s,n))>-1;)s.splice(n,1),n<=c&&c--}),this},has:function(e){return e?u.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return a=l=[],s=r="",this},disabled:function(){return!s},lock:function(){return a=!0,r||f.disable(),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],l.push(t),i||h()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},u.extend({Deferred:function(e){var t=[["resolve","done",u.Callbacks("once memory"),"resolved"],["reject","fail",u.Callbacks("once memory"),"rejected"],["notify","progress",u.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return u.Deferred(function(n){u.each(t,function(t,o){var a=u.isFunction(e[t])&&e[t];r[o[1]](function(){var e=a&&a.apply(this,arguments);e&&u.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?u.extend(e,i):i}},r={};return i.pipe=i.then,u.each(t,function(e,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,r,o=0,a=i.call(arguments),s=a.length,l=1!==s||e&&u.isFunction(e.promise)?s:0,c=1===l?e:u.Deferred(),h=function(e,n,r){return function(o){n[e]=this,r[e]=arguments.length>1?i.call(arguments):o,r===t?c.notifyWith(n,r):--l||c.resolveWith(n,r)}};if(s>1)for(t=new Array(s),n=new Array(s),r=new Array(s);o<s;o++)a[o]&&u.isFunction(a[o].promise)?a[o].promise().progress(h(o,n,t)).done(h(o,r,a)).fail(c.reject):--l;return l||c.resolveWith(r,a),c.promise()}}),u.fn.ready=function(e){return u.ready.promise().done(e),this},u.extend({isReady:!1,readyWait:1,holdReady:function(e){e?u.readyWait++:u.ready(!0)},ready:function(e){(!0===e?--u.readyWait:u.isReady)||(u.isReady=!0,!0!==e&&--u.readyWait>0||(R.resolveWith(n,[u]),u.fn.triggerHandler&&(u(n).triggerHandler("ready"),u(n).off("ready"))))}}),u.ready.promise=function(t){if(!R)if(R=u.Deferred(),"complete"===n.readyState||"loading"!==n.readyState&&!n.documentElement.doScroll)e.setTimeout(u.ready);else if(n.addEventListener)n.addEventListener("DOMContentLoaded",M),e.addEventListener("load",M);else{n.attachEvent("onreadystatechange",M),e.attachEvent("onload",M);var i=!1;try{i=null==e.frameElement&&n.documentElement}catch(e){}i&&i.doScroll&&function t(){if(!u.isReady){try{i.doScroll("left")}catch(n){return e.setTimeout(t,50)}L(),u.ready()}}()}return R.promise(t)},u.ready.promise(),u(h))break;h.ownFirst="0"===P,h.inlineBlockNeedsLayout=!1,u(function(){var e,t,i,r;(i=n.getElementsByTagName("body")[0])&&i.style&&(t=n.createElement("div"),(r=n.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(r).appendChild(t),void 0!==t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",h.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(i.style.zoom=1)),i.removeChild(r))}),function(){var e=n.createElement("div");h.deleteExpando=!0;try{delete e.test}catch(e){h.deleteExpando=!1}e=null}();var D,F=function(e){var t=u.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||!0!==t&&e.getAttribute("classid")===t)},B=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(e,t,n){if(void 0===n&&1===e.nodeType){var i="data-"+t.replace(N,"-$1").toLowerCase();if("string"==typeof(n=e.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:B.test(n)?u.parseJSON(n):n)}catch(e){}u.data(e,t,n)}else n=void 0}return n}function H(e){var t;for(t in e)if(("data"!==t||!u.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function z(e,n,i,r){if(F(e)){var o,a,s=u.expando,l=e.nodeType,c=l?u.cache:e,h=l?e[s]:e[s]&&s;if(h&&c[h]&&(r||c[h].data)||void 0!==i||"string"!=typeof n)return h||(h=l?e[s]=t.pop()||u.guid++:s),c[h]||(c[h]=l?{}:{toJSON:u.noop}),"object"!=typeof n&&"function"!=typeof n||(r?c[h]=u.extend(c[h],n):c[h].data=u.extend(c[h].data,n)),a=c[h],r||(a.data||(a.data={}),a=a.data),void 0!==i&&(a[u.camelCase(n)]=i),"string"==typeof n?null==(o=a[n])&&(o=a[u.camelCase(n)]):o=a,o}}function $(e,t,n){if(F(e)){var i,r,o=e.nodeType,a=o?u.cache:e,s=o?e[u.expando]:u.expando;if(a[s]){if(t&&(i=n?a[s]:a[s].data)){t=u.isArray(t)?t.concat(u.map(t,u.camelCase)):t in i?[t]:(t=u.camelCase(t))in i?[t]:t.split(" "),r=t.length;for(;r--;)delete i[t[r]];if(n?!H(i):!u.isEmptyObject(i))return}(n||(delete a[s].data,H(a[s])))&&(o?u.cleanData([e],!0):h.deleteExpando||a!=a.window?delete a[s]:a[s]=void 0)}}}u.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?u.cache[e[u.expando]]:e[u.expando])&&!H(e)},data:function(e,t,n){return z(e,t,n)},removeData:function(e,t){return $(e,t)},_data:function(e,t,n){return z(e,t,n,!0)},_removeData:function(e,t){return $(e,t,!0)}}),u.fn.extend({data:function(e,t){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(r=u.data(o),1===o.nodeType&&!u._data(o,"parsedAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=u.camelCase(i.slice(5)),O(o,i,r[i]));u._data(o,"parsedAttrs",!0)}return r}return"object"==typeof e?this.each(function(){u.data(this,e)}):arguments.length>1?this.each(function(){u.data(this,e,t)}):o?O(o,e,u.data(o,e)):void 0},removeData:function(e){return this.each(function(){u.removeData(this,e)})}}),u.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=u._data(e,t),n&&(!i||u.isArray(n)?i=u._data(e,t,u.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=u.queue(e,t),i=n.length,r=n.shift(),o=u._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,function(){u.dequeue(e,t)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return u._data(e,n)||u._data(e,n,{empty:u.Callbacks("once memory").add(function(){u._removeData(e,t+"queue"),u._removeData(e,n)})})}}),u.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?u.queue(this[0],e):void 0===t?this:this.each(function(){var n=u.queue(this,e,t);u._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&u.dequeue(this,e)})},dequeue:function(e){return this.each(function(){u.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=u.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=u._data(o[a],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(t)}}),h.shrinkWrapBlocks=function(){return null!=D?D:(D=!1,(t=n.getElementsByTagName("body")[0])&&t.style?(e=n.createElement("div"),(i=n.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",t.appendChild(i).appendChild(e),void 0!==e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(n.createElement("div")).style.width="5px",D=3!==e.offsetWidth),t.removeChild(i),D):void 0);var e,t,i};var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,U=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),W=["Top","Right","Bottom","Left"],V=function(e,t){return e=t||e,"none"===u.css(e,"display")||!u.contains(e.ownerDocument,e)};function q(e,t,n,i){var r,o=1,a=20,s=i?function(){return i.cur()}:function(){return u.css(e,t,"")},l=s(),c=n&&n[3]||(u.cssNumber[t]?"":"px"),h=(u.cssNumber[t]||"px"!==c&&+l)&&U.exec(u.css(e,t));if(h&&h[3]!==c){c=c||h[3],n=n||[],h=+l||1;do{h/=o=o||".5",u.style(e,t,h+c)}while(o!==(o=s()/l)&&1!==o&&--a)}return n&&(h=+h||+l||0,r=n[1]?h+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=h,i.end=r)),r}var j,X,K,Y=function(e,t,n,i,r,o,a){var s=0,l=e.length,c=null==n;if("object"===u.type(n))for(s in r=!0,n)Y(e,t,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,u.isFunction(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(u(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):l?t(e[0],n):o},Z=/^(?:checkbox|radio)$/i,Q=/<([\w:-]+)/,J=/^$|\/(?:java|ecma)script/i,ee=/^\s+/,te="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";function ne(e){var t=te.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}j=n.createElement("div"),X=n.createDocumentFragment(),K=n.createElement("input"),j.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",h.leadingWhitespace=3===j.firstChild.nodeType,h.tbody=!j.getElementsByTagName("tbody").length,h.htmlSerialize=!!j.getElementsByTagName("link").length,h.html5Clone="<:nav></:nav>"!==n.createElement("nav").cloneNode(!0).outerHTML,K.type="checkbox",K.checked=!0,X.appendChild(K),h.appendChecked=K.checked,j.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!j.cloneNode(!0).lastChild.defaultValue,X.appendChild(j),(K=n.createElement("input")).setAttribute("type","radio"),K.setAttribute("checked","checked"),K.setAttribute("name","t"),j.appendChild(K),h.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,h.noCloneEvent=!!j.addEventListener,j[u.expando]=1,h.attributes=!j.getAttribute(u.expando);var ie={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:h.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};function re(e,t){var n,i,r=0,o=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):void 0;if(!o)for(o=[],n=e.childNodes||e;null!=(i=n[r]);r++)!t||u.nodeName(i,t)?o.push(i):u.merge(o,re(i,t));return void 0===t||t&&u.nodeName(e,t)?u.merge([e],o):o}function oe(e,t){for(var n,i=0;null!=(n=e[i]);i++)u._data(n,"globalEval",!t||u._data(t[i],"globalEval"))}ie.optgroup=ie.option,ie.tbody=ie.tfoot=ie.colgroup=ie.caption=ie.thead,ie.th=ie.td;var ae=/<|&#?\w+;/,se=/<tbody/i;function le(e){Z.test(e.type)&&(e.defaultChecked=e.checked)}function ce(e,t,n,i,r){for(var o,a,s,l,c,f,p,d=e.length,g=ne(t),m=[],v=0;v<d;v++)if((a=e[v])||0===a)if("object"===u.type(a))u.merge(m,a.nodeType?[a]:a);else if(ae.test(a)){for(l=l||g.appendChild(t.createElement("div")),c=(Q.exec(a)||["",""])[1].toLowerCase(),p=ie[c]||ie._default,l.innerHTML=p[1]+u.htmlPrefilter(a)+p[2],o=p[0];o--;)l=l.lastChild;if(!h.leadingWhitespace&&ee.test(a)&&m.push(t.createTextNode(ee.exec(a)[0])),!h.tbody)for(a="table"!==c||se.test(a)?"<table>"!==p[1]||se.test(a)?0:l:l.firstChild,o=a&&a.childNodes.length;o--;)u.nodeName(f=a.childNodes[o],"tbody")&&!f.childNodes.length&&a.removeChild(f);for(u.merge(m,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=g.lastChild}else m.push(t.createTextNode(a));for(l&&g.removeChild(l),h.appendChecked||u.grep(re(m,"input"),le),v=0;a=m[v++];)if(i&&u.inArray(a,i)>-1)r&&r.push(a);else if(s=u.contains(a.ownerDocument,a),l=re(g.appendChild(a),"script"),s&&oe(l),n)for(o=0;a=l[o++];)J.test(a.type||"")&&n.push(a);return l=null,g}!function(){var t,i,r=n.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})i="on"+t,(h[t]=i in e)||(r.setAttribute(i,"t"),h[t]=!1===r.attributes[i].expando);r=null}();var he=/^(?:input|select|textarea)$/i,ue=/^key/,fe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,pe=/^(?:focusinfocus|focusoutblur)$/,de=/^([^.]*)(?:\.(.+)|)/;function ge(){return!0}function me(){return!1}function ve(){try{return n.activeElement}catch(e){}}function ye(e,t,n,i,r,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(i=i||n,n=void 0),t)ye(e,s,n,i,t[s],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=me;else if(!r)return e;return 1===o&&(a=r,(r=function(e){return u().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=u.guid++)),e.each(function(){u.event.add(this,t,r,i,n)})}u.event={global:{},add:function(e,t,n,i,r){var o,a,s,l,c,h,f,p,d,g,m,v=u._data(e);if(v){for(n.handler&&(n=(l=n).handler,r=l.selector),n.guid||(n.guid=u.guid++),(a=v.events)||(a=v.events={}),(h=v.handle)||((h=v.handle=function(e){return void 0===u||e&&u.event.triggered===e.type?void 0:u.event.dispatch.apply(h.elem,arguments)}).elem=e),s=(t=(t||"").match(E)||[""]).length;s--;)d=m=(o=de.exec(t[s])||[])[1],g=(o[2]||"").split(".").sort(),d&&(c=u.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,c=u.event.special[d]||{},f=u.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&u.expr.match.needsContext.test(r),namespace:g.join(".")},l),(p=a[d])||((p=a[d]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,i,g,h)||(e.addEventListener?e.addEventListener(d,h,!1):e.attachEvent&&e.attachEvent("on"+d,h))),c.add&&(c.add.call(e,f),f.handler.guid||(f.handler.guid=n.guid)),r?p.splice(p.delegateCount++,0,f):p.push(f),u.event.global[d]=!0);e=null}},remove:function(e,t,n,i,r){var o,a,s,l,c,h,f,p,d,g,m,v=u.hasData(e)&&u._data(e);if(v&&(h=v.events)){for(c=(t=(t||"").match(E)||[""]).length;c--;)if(d=m=(s=de.exec(t[c])||[])[1],g=(s[2]||"").split(".").sort(),d){for(f=u.event.special[d]||{},p=h[d=(i?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=p.length;o--;)a=p[o],!r&&m!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(p.splice(o,1),a.selector&&p.delegateCount--,f.remove&&f.remove.call(e,a));l&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,g,v.handle)||u.removeEvent(e,d,v.handle),delete h[d])}else for(d in h)u.event.remove(e,d+t[c],n,i,!0);u.isEmptyObject(h)&&(delete v.handle,u._removeData(e,"events"))}},trigger:function(t,i,r,o){var a,s,l,h,f,p,d,g=[r||n],m=c.call(t,"type")?t.type:t,v=c.call(t,"namespace")?t.namespace.split("."):[];if(l=p=r=r||n,3!==r.nodeType&&8!==r.nodeType&&!pe.test(m+u.event.triggered)&&(m.indexOf(".")>-1&&(m=(v=m.split(".")).shift(),v.sort()),s=m.indexOf(":")<0&&"on"+m,(t=t[u.expando]?t:new u.Event(m,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),i=null==i?[t]:u.makeArray(i,[t]),f=u.event.special[m]||{},o||!f.trigger||!1!==f.trigger.apply(r,i))){if(!o&&!f.noBubble&&!u.isWindow(r)){for(h=f.delegateType||m,pe.test(h+m)||(l=l.parentNode);l;l=l.parentNode)g.push(l),p=l;p===(r.ownerDocument||n)&&g.push(p.defaultView||p.parentWindow||e)}for(d=0;(l=g[d++])&&!t.isPropagationStopped();)t.type=d>1?h:f.bindType||m,(a=(u._data(l,"events")||{})[t.type]&&u._data(l,"handle"))&&a.apply(l,i),(a=s&&l[s])&&a.apply&&F(l)&&(t.result=a.apply(l,i),!1===t.result&&t.preventDefault());if(t.type=m,!o&&!t.isDefaultPrevented()&&(!f._default||!1===f._default.apply(g.pop(),i))&&F(r)&&s&&r[m]&&!u.isWindow(r)){(p=r[s])&&(r[s]=null),u.event.triggered=m;try{r[m]()}catch(e){}u.event.triggered=void 0,p&&(r[s]=p)}return t.result}},dispatch:function(e){e=u.event.fix(e);var t,n,r,o,a,s,l=i.call(arguments),c=(u._data(this,"events")||{})[e.type]||[],h=u.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,e)){for(s=u.event.handlers.call(this,e,c),t=0;(o=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(a=o.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(a.namespace)||(e.handleObj=a,e.data=a.data,void 0!==(r=((u.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l))&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(i=[],n=0;n<s;n++)void 0===i[r=(o=t[n]).selector+" "]&&(i[r]=o.needsContext?u(r,this).index(l)>-1:u.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[u.expando])return e;var t,i,r,o=e.type,a=e,s=this.fixHooks[o];for(s||(this.fixHooks[o]=s=fe.test(o)?this.mouseHooks:ue.test(o)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new u.Event(a),t=r.length;t--;)e[i=r[t]]=a[i];return e.target||(e.target=a.srcElement||n),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,r,o,a=t.button,s=t.fromElement;return null==e.pageX&&null!=t.clientX&&(o=(r=e.target.ownerDocument||n).documentElement,i=r.body,e.pageX=t.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?t.toElement:s),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ve()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===ve()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(u.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return u.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n){var i=u.extend(new u.Event,n,{type:e,isSimulated:!0});u.event.trigger(i,null,t),i.isDefaultPrevented()&&n.preventDefault()}},u.removeEvent=n.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)}:function(e,t,n){var i="on"+t;e.detachEvent&&(void 0===e[i]&&(e[i]=null),e.detachEvent(i,n))},u.Event=function(e,t){if(!(this instanceof u.Event))return new u.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?ge:me):this.type=e,t&&u.extend(this,t),this.timeStamp=e&&e.timeStamp||u.now(),this[u.expando]=!0},u.Event.prototype={constructor:u.Event,isDefaultPrevented:me,isPropagationStopped:me,isImmediatePropagationStopped:me,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ge,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ge,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=ge,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},u.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){u.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,r=e.handleObj;return i&&(i===this||u.contains(this,i))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),h.submit||(u.event.special.submit={setup:function(){if(u.nodeName(this,"form"))return!1;u.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=u.nodeName(t,"input")||u.nodeName(t,"button")?u.prop(t,"form"):void 0;n&&!u._data(n,"submit")&&(u.event.add(n,"submit._submit",function(e){e._submitBubble=!0}),u._data(n,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&u.event.simulate("submit",this.parentNode,e))},teardown:function(){if(u.nodeName(this,"form"))return!1;u.event.remove(this,"._submit")}}),h.change||(u.event.special.change={setup:function(){if(he.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(u.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),u.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),u.event.simulate("change",this,e)})),!1;u.event.add(this,"beforeactivate._change",function(e){var t=e.target;he.test(t.nodeName)&&!u._data(t,"change")&&(u.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||u.event.simulate("change",this.parentNode,e)}),u._data(t,"change",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return u.event.remove(this,"._change"),!he.test(this.nodeName)}}),h.focusin||u.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){u.event.simulate(t,e.target,u.event.fix(e))};u.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=u._data(i,t);r||i.addEventListener(e,n,!0),u._data(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=u._data(i,t)-1;r?u._data(i,t,r):(i.removeEventListener(e,n,!0),u._removeData(i,t))}}}),u.fn.extend({on:function(e,t,n,i){return ye(this,e,t,n,i)},one:function(e,t,n,i){return ye(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,u(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=me),this.each(function(){u.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){u.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return u.event.trigger(e,t,n,!0)}});var we=/ jQuery\d+="(?:null|\d+)"/g,be=new RegExp("<(?:"+te+")[\\s/>]","i"),xe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ke=/<script|<style|<link/i,Se=/checked\s*(?:[^=]|=\s*.checked.)/i,Ce=/^true\/(.*)/,Te=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,_e=ne(n).appendChild(n.createElement("div"));function Ae(e,t){return u.nodeName(e,"table")&&u.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ie(e){return e.type=(null!==u.find.attr(e,"type"))+"/"+e.type,e}function Re(e){var t=Ce.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pe(e,t){if(1===t.nodeType&&u.hasData(e)){var n,i,r,o=u._data(e),a=u._data(t,o),s=o.events;if(s)for(n in delete a.handle,a.events={},s)for(i=0,r=s[n].length;i<r;i++)u.event.add(t,n,s[n][i]);a.data&&(a.data=u.extend({},a.data))}}function Ee(e,t){var n,i,r;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!h.noCloneEvent&&t[u.expando]){for(i in(r=u._data(t)).events)u.removeEvent(t,i,r.handle);t.removeAttribute(u.expando)}"script"===n&&t.text!==e.text?(Ie(t).text=e.text,Re(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),h.html5Clone&&e.innerHTML&&!u.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Z.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}}function Le(e,t,n,i){t=r.apply([],t);var o,a,s,l,c,f,p=0,d=e.length,g=d-1,m=t[0],v=u.isFunction(m);if(v||d>1&&"string"==typeof m&&!h.checkClone&&Se.test(m))return e.each(function(r){var o=e.eq(r);v&&(t[0]=m.call(this,r,o.html())),Le(o,t,n,i)});if(d&&(f=ce(t,e[0].ownerDocument,!1,e,i),o=f.firstChild,1===f.childNodes.length&&(f=o),o||i)){for(l=u.map(re(f,"script"),Ie),s=l.length;p<d;p++)a=f,p!==g&&(a=u.clone(a,!0,!0),s&&u.merge(l,re(a,"script"))),n.call(e[p],a,p);if(s)for(c=l[l.length-1].ownerDocument,u.map(l,Re),p=0;p<s;p++)a=l[p],J.test(a.type||"")&&!u._data(a,"globalEval")&&u.contains(c,a)&&(a.src?u._evalUrl&&u._evalUrl(a.src):u.globalEval((a.text||a.textContent||a.innerHTML||"").replace(Te,"")));f=o=null}return e}function Me(e,t,n){for(var i,r=t?u.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||u.cleanData(re(i)),i.parentNode&&(n&&u.contains(i.ownerDocument,i)&&oe(re(i,"script")),i.parentNode.removeChild(i));return e}u.extend({htmlPrefilter:function(e){return e.replace(xe,"<$1></$2>")},clone:function(e,t,n){var i,r,o,a,s,l=u.contains(e.ownerDocument,e);if(h.html5Clone||u.isXMLDoc(e)||!be.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(_e.innerHTML=e.outerHTML,_e.removeChild(o=_e.firstChild)),!(h.noCloneEvent&&h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||u.isXMLDoc(e)))for(i=re(o),s=re(e),a=0;null!=(r=s[a]);++a)i[a]&&Ee(r,i[a]);if(t)if(n)for(s=s||re(e),i=i||re(o),a=0;null!=(r=s[a]);a++)Pe(r,i[a]);else Pe(e,o);return(i=re(o,"script")).length>0&&oe(i,!l&&re(e,"script")),i=s=r=null,o},cleanData:function(e,n){for(var i,r,o,a,s=0,l=u.expando,c=u.cache,f=h.attributes,p=u.event.special;null!=(i=e[s]);s++)if((n||F(i))&&(o=i[l],a=o&&c[o])){if(a.events)for(r in a.events)p[r]?u.event.remove(i,r):u.removeEvent(i,r,a.handle);c[o]&&(delete c[o],f||void 0===i.removeAttribute?i[l]=void 0:i.removeAttribute(l),t.push(o))}}}),u.fn.extend({domManip:Le,detach:function(e){return Me(this,e,!0)},remove:function(e){return Me(this,e)},text:function(e){return Y(this,function(e){return void 0===e?u.text(this):this.empty().append((this[0]&&this[0].ownerDocument||n).createTextNode(e))},null,e,arguments.length)},append:function(){return Le(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ae(this,e);t.appendChild(e)}})},prepend:function(){return Le(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ae(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Le(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Le(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&u.cleanData(re(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&u.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return u.clone(this,e,t)})},html:function(e){return Y(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(we,""):void 0;if("string"==typeof e&&!ke.test(e)&&(h.htmlSerialize||!be.test(e))&&(h.leadingWhitespace||!ee.test(e))&&!ie[(Q.exec(e)||["",""])[1].toLowerCase()]){e=u.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(u.cleanData(re(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Le(this,arguments,function(t){var n=this.parentNode;u.inArray(this,e)<0&&(u.cleanData(re(this)),n&&n.replaceChild(t,this))},e)}}),u.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){u.fn[e]=function(e){for(var n,i=0,r=[],a=u(e),s=a.length-1;i<=s;i++)n=i===s?this:this.clone(!0),u(a[i])[t](n),o.apply(r,n.get());return this.pushStack(r)}});var De,Fe={HTML:"block",BODY:"block"};function Be(e,t){var n=u(t.createElement(e)).appendTo(t.body),i=u.css(n[0],"display");return n.detach(),i}function Ne(e){var t=n,i=Fe[e];return i||("none"!==(i=Be(e,t))&&i||(De=(De||u("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),(t=(De[0].contentWindow||De[0].contentDocument).document).write(),t.close(),i=Be(e,t),De.detach()),Fe[e]=i),i}var Oe=/^margin/,He=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),ze=function(e,t,n,i){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in r=n.apply(e,i||[]),t)e.style[o]=a[o];return r},$e=n.documentElement;!function(){var t,i,r,o,a,s,l=n.createElement("div"),c=n.createElement("div");function f(){var h,u,f=n.documentElement;f.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",t=r=s=!1,i=a=!0,e.getComputedStyle&&(u=e.getComputedStyle(c),t="1%"!==(u||{}).top,s="2px"===(u||{}).marginLeft,r="4px"===(u||{width:"4px"}).width,c.style.marginRight="50%",i="4px"===(u||{marginRight:"4px"}).marginRight,(h=c.appendChild(n.createElement("div"))).style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",h.style.marginRight=h.style.width="0",c.style.width="1px",a=!parseFloat((e.getComputedStyle(h)||{}).marginRight),c.removeChild(h)),c.style.display="none",(o=0===c.getClientRects().length)&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",(h=c.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(o=0===h[0].offsetHeight)&&(h[0].style.display="",h[1].style.display="none",o=0===h[0].offsetHeight)),f.removeChild(l)}c.style&&(c.style.cssText="float:left;opacity:.5",h.opacity="0.5"===c.style.opacity,h.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===c.style.backgroundClip,(l=n.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),h.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,u.extend(h,{reliableHiddenOffsets:function(){return null==t&&f(),o},boxSizingReliable:function(){return null==t&&f(),r},pixelMarginRight:function(){return null==t&&f(),i},pixelPosition:function(){return null==t&&f(),t},reliableMarginRight:function(){return null==t&&f(),a},reliableMarginLeft:function(){return null==t&&f(),s}}))}();var Ge,Ue,We=/^(top|right|bottom|left)$/;function Ve(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}e.getComputedStyle?(Ge=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Ue=function(e,t,n){var i,r,o,a,s=e.style;return n=n||Ge(e),""!==(a=n?n.getPropertyValue(t)||n[t]:void 0)&&void 0!==a||u.contains(e.ownerDocument,e)||(a=u.style(e,t)),n&&!h.pixelMarginRight()&&He.test(a)&&Oe.test(t)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o),void 0===a?a:a+""}):$e.currentStyle&&(Ge=function(e){return e.currentStyle},Ue=function(e,t,n){var i,r,o,a,s=e.style;return n=n||Ge(e),null==(a=n?n[t]:void 0)&&s&&s[t]&&(a=s[t]),He.test(a)&&!We.test(t)&&(i=s.left,r=e.runtimeStyle,(o=r&&r.left)&&(r.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=i,o&&(r.left=o)),void 0===a?a:a+""||"auto"});var qe=/alpha\([^)]*\)/i,je=/opacity\s*=\s*([^)]*)/i,Xe=/^(none|table(?!-c[ea]).+)/,Ke=new RegExp("^("+G+")(.*)$","i"),Ye={position:"absolute",visibility:"hidden",display:"block"},Ze={letterSpacing:"0",fontWeight:"400"},Qe=["Webkit","O","Moz","ms"],Je=n.createElement("div").style;function et(e){if(e in Je)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=Qe.length;n--;)if((e=Qe[n]+t)in Je)return e}function tt(e,t){for(var n,i,r,o=[],a=0,s=e.length;a<s;a++)(i=e[a]).style&&(o[a]=u._data(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&V(i)&&(o[a]=u._data(i,"olddisplay",Ne(i.nodeName)))):(r=V(i),(n&&"none"!==n||!r)&&u._data(i,"olddisplay",r?n:u.css(i,"display"))));for(a=0;a<s;a++)(i=e[a]).style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function nt(e,t,n){var i=Ke.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function it(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=u.css(e,n+W[o],!0,r)),i?("content"===n&&(a-=u.css(e,"padding"+W[o],!0,r)),"margin"!==n&&(a-=u.css(e,"border"+W[o]+"Width",!0,r))):(a+=u.css(e,"padding"+W[o],!0,r),"padding"!==n&&(a+=u.css(e,"border"+W[o]+"Width",!0,r)));return a}function rt(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Ge(e),a=h.boxSizing&&"border-box"===u.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=Ue(e,t,o))<0||null==r)&&(r=e.style[t]),He.test(r))return r;i=a&&(h.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+it(e,t,n||(a?"border":"content"),i,o)+"px"}function ot(e,t,n,i,r){return new ot.prototype.init(e,t,n,i,r)}u.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ue(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:h.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=u.camelCase(t),l=e.style;if(t=u.cssProps[s]||(u.cssProps[s]=et(s)||s),a=u.cssHooks[t]||u.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:l[t];if("string"==(o=typeof n)&&(r=U.exec(n))&&r[1]&&(n=q(e,t,r),o="number"),null!=n&&n==n&&("number"===o&&(n+=r&&r[3]||(u.cssNumber[s]?"":"px")),h.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(n=a.set(e,n,i)))))try{l[t]=n}catch(e){}}},css:function(e,t,n,i){var r,o,a,s=u.camelCase(t);return t=u.cssProps[s]||(u.cssProps[s]=et(s)||s),(a=u.cssHooks[t]||u.cssHooks[s])&&"get"in a&&(o=a.get(e,!0,n)),void 0===o&&(o=Ue(e,t,i)),"normal"===o&&t in Ze&&(o=Ze[t]),""===n||n?(r=parseFloat(o),!0===n||isFinite(r)?r||0:o):o}}),u.each(["height","width"],function(e,t){u.cssHooks[t]={get:function(e,n,i){if(n)return Xe.test(u.css(e,"display"))&&0===e.offsetWidth?ze(e,Ye,function(){return rt(e,t,i)}):rt(e,t,i)},set:function(e,n,i){var r=i&&Ge(e);return nt(0,n,i?it(e,t,i,h.boxSizing&&"border-box"===u.css(e,"boxSizing",!1,r),r):0)}}}),h.opacity||(u.cssHooks.opacity={get:function(e,t){return je.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,r=u.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===u.trim(o.replace(qe,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=qe.test(o)?o.replace(qe,r):o+" "+r)}}),u.cssHooks.marginRight=Ve(h.reliableMarginRight,function(e,t){if(t)return ze(e,{display:"inline-block"},Ue,[e,"marginRight"])}),u.cssHooks.marginLeft=Ve(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ue(e,"marginLeft"))||(u.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-ze(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px"}),u.each({margin:"",padding:"",border:"Width"},function(e,t){u.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+W[i]+t]=o[i]||o[i-2]||o[0];return r}},Oe.test(e)||(u.cssHooks[e+t].set=nt)}),u.fn.extend({css:function(e,t){return Y(this,function(e,t,n){var i,r,o={},a=0;if(u.isArray(t)){for(i=Ge(e),r=t.length;a<r;a++)o[t[a]]=u.css(e,t[a],!1,i);return o}return void 0!==n?u.style(e,t,n):u.css(e,t)},e,t,arguments.length>1)},show:function(){return tt(this,!0)},hide:function(){return tt(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){V(this)?u(this).show():u(this).hide()})}}),u.Tween=ot,ot.prototype={constructor:ot,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||u.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(u.cssNumber[n]?"":"px")},cur:function(){var e=ot.propHooks[this.prop];return e&&e.get?e.get(this):ot.propHooks._default.get(this)},run:function(e){var t,n=ot.propHooks[this.prop];return this.options.duration?this.pos=t=u.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ot.propHooks._default.set(this),this}},ot.prototype.init.prototype=ot.prototype,ot.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=u.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){u.fx.step[e.prop]?u.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[u.cssProps[e.prop]]&&!u.cssHooks[e.prop]?e.elem[e.prop]=e.now:u.style(e.elem,e.prop,e.now+e.unit)}}},ot.propHooks.scrollTop=ot.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},u.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},u.fx=ot.prototype.init,u.fx.step={};var at,st,lt,ct,ht,ut,ft,pt=/^(?:toggle|show|hide)$/,dt=/queueHooks$/;function gt(){return e.setTimeout(function(){at=void 0}),at=u.now()}function mt(e,t){var n,i={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)n=W[r],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var i,r=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function yt(e,t,n){var i,r,o=0,a=yt.prefilters.length,s=u.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=at||gt(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,o=1-i,a=0,l=c.tweens.length;a<l;a++)c.tweens[a].run(o);return s.notifyWith(e,[c,o,n]),o<1&&l?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:u.extend({},t),opts:u.extend(!0,{specialEasing:{},easing:u.easing._default},n),originalProperties:t,originalOptions:n,startTime:at||gt(),duration:n.duration,tweens:[],createTween:function(t,n){var i=u.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return t?(s.notifyWith(e,[c,1,0]),s.resolveWith(e,[c,t])):s.rejectWith(e,[c,t]),this}}),h=c.props;for(function(e,t){var n,i,r,o,a;for(n in e)if(i=u.camelCase(n),r=t[i],o=e[n],u.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(a=u.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(h,c.opts.specialEasing);o<a;o++)if(i=yt.prefilters[o].call(c,e,h,c.opts))return u.isFunction(i.stop)&&(u._queueHooks(c.elem,c.opts.queue).stop=u.proxy(i.stop,i)),i;return u.map(h,vt,c),u.isFunction(c.opts.start)&&c.opts.start.call(e,c),u.fx.timer(u.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}u.Animation=u.extend(yt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return q(n.elem,e,U.exec(t),n),n}]},tweener:function(e,t){u.isFunction(e)?(t=e,e=["*"]):e=e.match(E);for(var n,i=0,r=e.length;i<r;i++)n=e[i],yt.tweeners[n]=yt.tweeners[n]||[],yt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,r,o,a,s,l,c,f=this,p={},d=e.style,g=e.nodeType&&V(e),m=u._data(e,"fxshow");for(i in n.queue||(null==(s=u._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,f.always(function(){f.always(function(){s.unqueued--,u.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(c=u.css(e,"display"))?u._data(e,"olddisplay")||Ne(e.nodeName):c)&&"none"===u.css(e,"float")&&(h.inlineBlockNeedsLayout&&"inline"!==Ne(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",h.shrinkWrapBlocks()||f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),t)if(r=t[i],pt.exec(r)){if(delete t[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;g=!0}p[i]=m&&m[i]||u.style(e,i)}else c=void 0;if(u.isEmptyObject(p))"inline"===("none"===c?Ne(e.nodeName):c)&&(d.display=c);else for(i in m?"hidden"in m&&(g=m.hidden):m=u._data(e,"fxshow",{}),o&&(m.hidden=!g),g?u(e).show():f.done(function(){u(e).hide()}),f.done(function(){var t;for(t in u._removeData(e,"fxshow"),p)u.style(e,t,p[t])}),p)a=vt(g?m[i]:0,i,f),i in m||(m[i]=a.start,g&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),u.speed=function(e,t,n){var i=e&&"object"==typeof e?u.extend({},e):{complete:n||!n&&t||u.isFunction(e)&&e,duration:e,easing:n&&t||t&&!u.isFunction(t)&&t};return i.duration=u.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in u.fx.speeds?u.fx.speeds[i.duration]:u.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){u.isFunction(i.old)&&i.old.call(this),i.queue&&u.dequeue(this,i.queue)},i},u.fn.extend({fadeTo:function(e,t,n,i){return this.filter(V).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=u.isEmptyObject(e),o=u.speed(t,n,i),a=function(){var t=yt(this,u.extend({},e),o);(r||u._data(this,"finish"))&&t.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=u.timers,a=u._data(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&dt.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));!t&&n||u.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=u._data(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=u.timers,a=i?i.length:0;for(n.finish=!0,u.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),u.each(["toggle","show","hide"],function(e,t){var n=u.fn[t];u.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(mt(t,!0),e,i,r)}}),u.each({slideDown:mt("show"),slideUp:mt("hide"),slideToggle:mt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){u.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),u.timers=[],u.fx.tick=function(){var e,t=u.timers,n=0;for(at=u.now();n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||u.fx.stop(),at=void 0},u.fx.timer=function(e){u.timers.push(e),e()?u.fx.start():u.timers.pop()},u.fx.interval=13,u.fx.start=function(){st||(st=e.setInterval(u.fx.tick,u.fx.interval))},u.fx.stop=function(){e.clearInterval(st),st=null},u.fx.speeds={slow:600,fast:200,_default:400},u.fn.delay=function(t,n){return t=u.fx&&u.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(n,i){var r=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(r)}})},ct=n.createElement("input"),ht=n.createElement("div"),ut=n.createElement("select"),ft=ut.appendChild(n.createElement("option")),(ht=n.createElement("div")).setAttribute("className","t"),ht.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",lt=ht.getElementsByTagName("a")[0],ct.setAttribute("type","checkbox"),ht.appendChild(ct),(lt=ht.getElementsByTagName("a")[0]).style.cssText="top:1px",h.getSetAttribute="t"!==ht.className,h.style=/top/.test(lt.getAttribute("style")),h.hrefNormalized="/a"===lt.getAttribute("href"),h.checkOn=!!ct.value,h.optSelected=ft.selected,h.enctype=!!n.createElement("form").enctype,ut.disabled=!0,h.optDisabled=!ft.disabled,(ct=n.createElement("input")).setAttribute("value",""),h.input=""===ct.getAttribute("value"),ct.value="t",ct.setAttribute("type","radio"),h.radioValue="t"===ct.value;var wt=/\r/g,bt=/[\x20\t\r\n\f]+/g;u.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=u.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,u(this).val()):e)?r="":"number"==typeof r?r+="":u.isArray(r)&&(r=u.map(r,function(e){return null==e?"":e+""})),(t=u.valHooks[this.type]||u.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))})):r?(t=u.valHooks[r.type]||u.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(wt,""):null==n?"":n:void 0}}),u.extend({valHooks:{option:{get:function(e){var t=u.find.attr(e,"value");return null!=t?t:u.trim(u.text(e)).replace(bt," ")}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,a=o?null:[],s=o?r+1:i.length,l=r<0?s:o?r:0;l<s;l++)if(((n=i[l]).selected||l===r)&&(h.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!u.nodeName(n.parentNode,"optgroup"))){if(t=u(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=u.makeArray(t),a=r.length;a--;)if(i=r[a],u.inArray(u.valHooks.option.get(i),o)>-1)try{i.selected=n=!0}catch(e){i.scrollHeight}else i.selected=!1;return n||(e.selectedIndex=-1),r}}}}),u.each(["radio","checkbox"],function(){u.valHooks[this]={set:function(e,t){if(u.isArray(t))return e.checked=u.inArray(u(e).val(),t)>-1}},h.checkOn||(u.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var xt,kt,St=u.expr.attrHandle,Ct=/^(?:checked|selected)$/i,Tt=h.getSetAttribute,_t=h.input;u.fn.extend({attr:function(e,t){return Y(this,u.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){u.removeAttr(this,e)})}}),u.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?u.prop(e,t,n):(1===o&&u.isXMLDoc(e)||(t=t.toLowerCase(),r=u.attrHooks[t]||(u.expr.match.bool.test(t)?kt:xt)),void 0!==n?null===n?void u.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=u.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&u.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(E);if(o&&1===e.nodeType)for(;n=o[r++];)i=u.propFix[n]||n,u.expr.match.bool.test(n)?_t&&Tt||!Ct.test(n)?e[i]=!1:e[u.camelCase("default-"+n)]=e[i]=!1:u.attr(e,n,""),e.removeAttribute(Tt?n:i)}}),kt={set:function(e,t,n){return!1===t?u.removeAttr(e,n):_t&&Tt||!Ct.test(n)?e.setAttribute(!Tt&&u.propFix[n]||n,n):e[u.camelCase("default-"+n)]=e[n]=!0,n}},u.each(u.expr.match.bool.source.match(/\w+/g),function(e,t){var n=St[t]||u.find.attr;_t&&Tt||!Ct.test(t)?St[t]=function(e,t,i){var r,o;return i||(o=St[t],St[t]=r,r=null!=n(e,t,i)?t.toLowerCase():null,St[t]=o),r}:St[t]=function(e,t,n){if(!n)return e[u.camelCase("default-"+t)]?t.toLowerCase():null}}),_t&&Tt||(u.attrHooks.value={set:function(e,t,n){if(!u.nodeName(e,"input"))return xt&&xt.set(e,t,n);e.defaultValue=t}}),Tt||(xt={set:function(e,t,n){var i=e.getAttributeNode(n);if(i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n))return t}},St.id=St.name=St.coords=function(e,t,n){var i;if(!n)return(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},u.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);if(n&&n.specified)return n.value},set:xt.set},u.attrHooks.contenteditable={set:function(e,t,n){xt.set(e,""!==t&&t,n)}},u.each(["width","height"],function(e,t){u.attrHooks[t]={set:function(e,n){if(""===n)return e.setAttribute(t,"auto"),n}}})),h.style||(u.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var At=/^(?:input|select|textarea|button|object)$/i,It=/^(?:a|area)$/i;u.fn.extend({prop:function(e,t){return Y(this,u.prop,e,t,arguments.length>1)},removeProp:function(e){return e=u.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),u.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&u.isXMLDoc(e)||(t=u.propFix[t]||t,r=u.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=u.find.attr(e,"tabindex");return t?parseInt(t,10):At.test(e.nodeName)||It.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),h.hrefNormalized||u.each(["href","src"],function(e,t){u.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),h.optSelected||(u.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),u.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){u.propFix[this.toLowerCase()]=this}),h.enctype||(u.propFix.enctype="encoding");var Rt=/[\t\r\n\f]/g;function Pt(e){return u.attr(e,"class")||""}u.fn.extend({addClass:function(e){var t,n,i,r,o,a,s,l=0;if(u.isFunction(e))return this.each(function(t){u(this).addClass(e.call(this,t,Pt(this)))});if("string"==typeof e&&e)for(t=e.match(E)||[];n=this[l++];)if(r=Pt(n),i=1===n.nodeType&&(" "+r+" ").replace(Rt," ")){for(a=0;o=t[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");s=u.trim(i),r!==s&&u.attr(n,"class",s)}return this},removeClass:function(e){var t,n,i,r,o,a,s,l=0;if(u.isFunction(e))return this.each(function(t){u(this).removeClass(e.call(this,t,Pt(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(E)||[];n=this[l++];)if(r=Pt(n),i=1===n.nodeType&&(" "+r+" ").replace(Rt," ")){for(a=0;o=t[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");s=u.trim(i),r!==s&&u.attr(n,"class",s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):u.isFunction(e)?this.each(function(n){u(this).toggleClass(e.call(this,n,Pt(this),t),t)}):this.each(function(){var t,i,r,o;if("string"===n)for(i=0,r=u(this),o=e.match(E)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else void 0!==e&&"boolean"!==n||((t=Pt(this))&&u._data(this,"__className__",t),u.attr(this,"class",t||!1===e?"":u._data(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+Pt(n)+" ").replace(Rt," ").indexOf(t)>-1)return!0;return!1}}),u.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){u.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),u.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var Et=e.location,Lt=u.now(),Mt=/\?/,Dt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;u.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,i=null,r=u.trim(t+"");return r&&!u.trim(r.replace(Dt,function(e,t,r,o){return n&&t&&(i=0),0===i?e:(n=r||t,i+=!o-!r,"")}))?Function("return "+r)():u.error("Invalid JSON: "+t)},u.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new e.DOMParser,n=i.parseFromString(t,"text/xml")):((n=new e.ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(t))}catch(e){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||u.error("Invalid XML: "+t),n};var Ft=/#.*$/,Bt=/([?&])_=[^&]*/,Nt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ot=/^(?:GET|HEAD)$/,Ht=/^\/\//,zt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,$t={},Gt={},Ut="*/".concat("*"),Wt=Et.href,Vt=zt.exec(Wt.toLowerCase())||[];function qt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(E)||[];if(u.isFunction(n))for(;i=o[r++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function jt(e,t,n,i){var r={},o=e===Gt;function a(s){var l;return r[s]=!0,u.each(e[s]||[],function(e,s){var c=s(t,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}return a(t.dataTypes[0])||!r["*"]&&a("*")}function Xt(e,t){var n,i,r=u.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n||(n={}))[i]=t[i]);return n&&u.extend(!0,e,n),e}u.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Wt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Vt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":u.parseJSON,"text xml":u.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Xt(Xt(e,u.ajaxSettings),t):Xt(u.ajaxSettings,e)},ajaxPrefilter:qt($t),ajaxTransport:qt(Gt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,r,o,a,s,l,c,h,f=u.ajaxSetup({},n),p=f.context||f,d=f.context&&(p.nodeType||p.jquery)?u(p):u.event,g=u.Deferred(),m=u.Callbacks("once memory"),v=f.statusCode||{},y={},w={},b=0,x="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!h)for(h={};t=Nt.exec(a);)h[t[1].toLowerCase()]=t[2];t=h[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=w[n]=w[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)v[t]=[v[t],e[t]];else k.always(e[k.status]);return this},abort:function(e){var t=e||x;return c&&c.abort(t),S(0,t),this}};if(g.promise(k).complete=m.add,k.success=k.done,k.error=k.fail,f.url=((t||f.url||Wt)+"").replace(Ft,"").replace(Ht,Vt[1]+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=u.trim(f.dataType||"*").toLowerCase().match(E)||[""],null==f.crossDomain&&(i=zt.exec(f.url.toLowerCase()),f.crossDomain=!(!i||i[1]===Vt[1]&&i[2]===Vt[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Vt[3]||("http:"===Vt[1]?"80":"443")))),f.data&&f.processData&&"string"!=typeof f.data&&(f.data=u.param(f.data,f.traditional)),jt($t,f,n,k),2===b)return k;for(r in(l=u.event&&f.global)&&0==u.active++&&u.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ot.test(f.type),o=f.url,f.hasContent||(f.data&&(o=f.url+=(Mt.test(o)?"&":"?")+f.data,delete f.data),!1===f.cache&&(f.url=Bt.test(o)?o.replace(Bt,"$1_="+Lt++):o+(Mt.test(o)?"&":"?")+"_="+Lt++)),f.ifModified&&(u.lastModified[o]&&k.setRequestHeader("If-Modified-Since",u.lastModified[o]),u.etag[o]&&k.setRequestHeader("If-None-Match",u.etag[o])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&k.setRequestHeader("Content-Type",f.contentType),k.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ut+"; q=0.01":""):f.accepts["*"]),f.headers)k.setRequestHeader(r,f.headers[r]);if(f.beforeSend&&(!1===f.beforeSend.call(p,k,f)||2===b))return k.abort();for(r in x="abort",{success:1,error:1,complete:1})k[r](f[r]);if(c=jt(Gt,f,n,k)){if(k.readyState=1,l&&d.trigger("ajaxSend",[k,f]),2===b)return k;f.async&&f.timeout>0&&(s=e.setTimeout(function(){k.abort("timeout")},f.timeout));try{b=1,c.send(y,S)}catch(e){if(!(b<2))throw e;S(-1,e)}}else S(-1,"No Transport");function S(t,n,i,r){var h,y,w,x,S,C=n;2!==b&&(b=2,s&&e.clearTimeout(s),c=void 0,a=r||"",k.readyState=t>0?4:0,h=t>=200&&t<300||304===t,i&&(x=function(e,t,n){for(var i,r,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){l.unshift(a);break}if(l[0]in n)o=l[0];else{for(a in n){if(!l[0]||e.converters[a+" "+l[0]]){o=a;break}i||(i=a)}o=o||i}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,k,i)),x=function(e,t,n,i){var r,o,a,s,l,c={},h=e.dataTypes.slice();if(h[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=h.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=h.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(r in c)if((s=r.split(" "))[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(o=s[0],h.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(f,x,k,h),h?(f.ifModified&&((S=k.getResponseHeader("Last-Modified"))&&(u.lastModified[o]=S),(S=k.getResponseHeader("etag"))&&(u.etag[o]=S)),204===t||"HEAD"===f.type?C="nocontent":304===t?C="notmodified":(C=x.state,y=x.data,w=x.error,h=!w)):(w=C,!t&&C||(C="error",t<0&&(t=0))),k.status=t,k.statusText=(n||C)+"",h?g.resolveWith(p,[y,C,k]):g.rejectWith(p,[k,C,w]),k.statusCode(v),v=void 0,l&&d.trigger(h?"ajaxSuccess":"ajaxError",[k,f,h?y:w]),m.fireWith(p,[k,C]),l&&(d.trigger("ajaxComplete",[k,f]),--u.active||u.event.trigger("ajaxStop")))}return k},getJSON:function(e,t,n){return u.get(e,t,n,"json")},getScript:function(e,t){return u.get(e,void 0,t,"script")}}),u.each(["get","post"],function(e,t){u[t]=function(e,n,i,r){return u.isFunction(n)&&(r=r||i,i=n,n=void 0),u.ajax(u.extend({url:e,type:t,dataType:r,data:n,success:i},u.isPlainObject(e)&&e))}}),u._evalUrl=function(e){return u.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},u.fn.extend({wrapAll:function(e){if(u.isFunction(e))return this.each(function(t){u(this).wrapAll(e.call(this,t))});if(this[0]){var t=u(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return u.isFunction(e)?this.each(function(t){u(this).wrapInner(e.call(this,t))}):this.each(function(){var t=u(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=u.isFunction(e);return this.each(function(n){u(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){u.nodeName(this,"body")||u(this).replaceWith(this.childNodes)}).end()}}),u.expr.filters.hidden=function(e){return h.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:function(e){if(!u.contains(e.ownerDocument||n,e))return!0;for(;e&&1===e.nodeType;){if("none"===((t=e).style&&t.style.display||u.css(t,"display"))||"hidden"===e.type)return!0;e=e.parentNode}var t;return!1}(e)},u.expr.filters.visible=function(e){return!u.expr.filters.hidden(e)};var Kt=/%20/g,Yt=/\[\]$/,Zt=/\r?\n/g,Qt=/^(?:submit|button|image|reset|file)$/i,Jt=/^(?:input|select|textarea|keygen)/i;function en(e,t,n,i){var r;if(u.isArray(t))u.each(t,function(t,r){n||Yt.test(e)?i(e,r):en(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,i)});else if(n||"object"!==u.type(t))i(e,t);else for(r in t)en(e+"["+r+"]",t[r],n,i)}u.param=function(e,t){var n,i=[],r=function(e,t){t=u.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=u.ajaxSettings&&u.ajaxSettings.traditional),u.isArray(e)||e.jquery&&!u.isPlainObject(e))u.each(e,function(){r(this.name,this.value)});else for(n in e)en(n,e[n],t,r);return i.join("&").replace(Kt,"+")},u.fn.extend({serialize:function(){return u.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=u.prop(this,"elements");return e?u.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!u(this).is(":disabled")&&Jt.test(this.nodeName)&&!Qt.test(e)&&(this.checked||!Z.test(e))}).map(function(e,t){var n=u(this).val();return null==n?null:u.isArray(n)?u.map(n,function(e){return{name:t.name,value:e.replace(Zt,"\r\n")}}):{name:t.name,value:n.replace(Zt,"\r\n")}}).get()}}),u.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return this.isLocal?an():n.documentMode>8?on():/^(get|post|head|put|delete|options)$/i.test(this.type)&&on()||an()}:on;var tn=0,nn={},rn=u.ajaxSettings.xhr();function on(){try{return new e.XMLHttpRequest}catch(e){}}function an(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}e.attachEvent&&e.attachEvent("onunload",function(){for(var e in nn)nn[e](void 0,!0)}),h.cors=!!rn&&"withCredentials"in rn,(rn=h.ajax=!!rn)&&u.ajaxTransport(function(t){var n;if(!t.crossDomain||h.cors)return{send:function(i,r){var o,a=t.xhr(),s=++tn;if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)a[o]=t.xhrFields[o];for(o in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)void 0!==i[o]&&a.setRequestHeader(o,i[o]+"");a.send(t.hasContent&&t.data||null),n=function(e,i){var o,l,c;if(n&&(i||4===a.readyState))if(delete nn[s],n=void 0,a.onreadystatechange=u.noop,i)4!==a.readyState&&a.abort();else{c={},o=a.status,"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(e){l=""}o||!t.isLocal||t.crossDomain?1223===o&&(o=204):o=c.text?200:404}c&&r(o,l,c,a.getAllResponseHeaders())},t.async?4===a.readyState?e.setTimeout(n):a.onreadystatechange=nn[s]=n:n()},abort:function(){n&&n(void 0,!0)}}}),u.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return u.globalEval(e),e}}}),u.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),u.ajaxTransport("script",function(e){if(e.crossDomain){var t,i=n.head||u("head")[0]||n.documentElement;return{send:function(r,o){(t=n.createElement("script")).async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||o(200,"success"))},i.insertBefore(t,i.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var sn=[],ln=/(=)\?(?=&|$)|\?\?/;u.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=sn.pop()||u.expando+"_"+Lt++;return this[e]=!0,e}}),u.ajaxPrefilter("json jsonp",function(t,n,i){var r,o,a,s=!1!==t.jsonp&&(ln.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ln.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=u.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(ln,"$1"+r):!1!==t.jsonp&&(t.url+=(Mt.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||u.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){a=arguments},i.always(function(){void 0===o?u(e).removeProp(r):e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,sn.push(r)),a&&u.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),u.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||n;var r=x.exec(e),o=!i&&[];return r?[t.createElement(r[1])]:(r=ce([e],t,o),o&&o.length&&u(o).remove(),u.merge([],r.childNodes))};var cn=u.fn.load;function hn(e){return u.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}return u.fn.load=function(e,t,n){if("string"!=typeof e&&cn)return cn.apply(this,arguments);var i,r,o,a=this,s=e.indexOf(" ");return s>-1&&(i=u.trim(e.slice(s,e.length)),e=e.slice(0,s)),u.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),a.length>0&&u.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(i?u("<div>").append(u.parseHTML(e)).find(i):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},u.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){u.fn[t]=function(e){return this.on(t,e)}}),u.expr.filters.animated=function(e){return u.grep(u.timers,function(t){return e===t.elem}).length},u.offset={setOffset:function(e,t,n){var i,r,o,a,s,l,c=u.css(e,"position"),h=u(e),f={};"static"===c&&(e.style.position="relative"),s=h.offset(),o=u.css(e,"top"),l=u.css(e,"left"),("absolute"===c||"fixed"===c)&&u.inArray("auto",[o,l])>-1?(a=(i=h.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(l)||0),u.isFunction(t)&&(t=t.call(e,n,u.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+r),"using"in t?t.using.call(e,f):h.css(f)}},u.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){u.offset.setOffset(this,e,t)});var t,n,i={top:0,left:0},r=this[0],o=r&&r.ownerDocument;return o?(t=o.documentElement,u.contains(t,r)?(void 0!==r.getBoundingClientRect&&(i=r.getBoundingClientRect()),n=hn(o),{top:i.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i):void 0},position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===u.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),u.nodeName(e[0],"html")||(n=e.offset()),n.top+=u.css(e[0],"borderTopWidth",!0),n.left+=u.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-u.css(i,"marginTop",!0),left:t.left-n.left-u.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!u.nodeName(e,"html")&&"static"===u.css(e,"position");)e=e.offsetParent;return e||$e})}}),u.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);u.fn[e]=function(i){return Y(this,function(e,i,r){var o=hn(e);if(void 0===r)return o?t in o?o[t]:o.document.documentElement[i]:e[i];o?o.scrollTo(n?u(o).scrollLeft():r,n?r:u(o).scrollTop()):e[i]=r},e,i,arguments.length,null)}}),u.each(["top","left"],function(e,t){u.cssHooks[t]=Ve(h.pixelPosition,function(e,n){if(n)return n=Ue(e,t),He.test(n)?u(e).position()[t]+"px":n})}),u.each({Height:"height",Width:"width"},function(e,t){u.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){u.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===r?"margin":"border");return Y(this,function(t,n,i){var r;return u.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===i?u.css(t,n,a):u.style(t,n,i,a)},t,o?i:void 0,o,null)}})}),u.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),u.fn.size=function(){return this.length},u.fn.andSelf=u.fn.addBack,u}(n),function(e){e.ui=e.ui||{},e.ui.version="1.12.1";var t,n=0,i=Array.prototype.slice;e.cleanData=(t=e.cleanData,function(n){var i,r,o;for(o=0;null!=(r=n[o]);o++)try{(i=e._data(r,"events"))&&i.remove&&e(r).triggerHandler("remove")}catch(e){}t(n)}),e.widget=function(t,n,i){var r,o,a,s={},l=t.split(".")[0];t=t.split(".")[1];var c=l+"-"+t;return i||(i=n,n=e.Widget),e.isArray(i)&&(i=e.extend.apply(null,[{}].concat(i))),e.expr[":"][c.toLowerCase()]=function(t){return!!e.data(t,c)},e[l]=e[l]||{},r=e[l][t],o=e[l][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),(a=new n).options=e.widget.extend({},a.options),e.each(i,function(t,i){e.isFunction(i)?s[t]=function(){function e(){return n.prototype[t].apply(this,arguments)}function r(e){return n.prototype[t].apply(this,e)}return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}():s[t]=i}),o.prototype=e.widget.extend(a,{widgetEventPrefix:r&&a.widgetEventPrefix||t},s,{constructor:o,namespace:l,widgetName:t,widgetFullName:c}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete r._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var n,r,o=i.call(arguments,1),a=0,s=o.length;a<s;a++)for(n in o[a])r=o[a][n],o[a].hasOwnProperty(n)&&void 0!==r&&(e.isPlainObject(r)?t[n]=e.isPlainObject(t[n])?e.widget.extend({},t[n],r):e.widget.extend({},r):t[n]=r);return t},e.widget.bridge=function(t,n){var r=n.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,s=i.call(arguments,1),l=this;return a?this.length||"instance"!==o?this.each(function(){var n,i=e.data(this,r);return"instance"===o?(l=i,!1):i?e.isFunction(i[o])&&"_"!==o.charAt(0)?(n=i[o].apply(i,s))!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0:e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):l=void 0:(s.length&&(o=e.widget.extend.apply(null,[o].concat(s))),this.each(function(){var t=e.data(this,r);t?(t.option(o||{}),t._init&&t._init()):e.data(this,r,new n(o,this))})),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var t=this;this._destroy(),e.each(this.classesElementLookup,function(e,n){t._removeClass(n,e)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i,r,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(r=a[t]=e.widget.extend({},this.options[t]),o=0;o<i.length-1;o++)r[i[o]]=r[i[o]]||{},r=r[i[o]];if(t=i.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var n,i,r;for(n in t)r=this.classesElementLookup[n],t[n]!==this.options.classes[n]&&r&&r.length&&(i=e(r.get()),this._removeClass(r,n),i.addClass(this._classes({element:i,keys:n,classes:t,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){var n=[],i=this;function r(r,o){var a,s;for(s=0;s<r.length;s++)a=i.classesElementLookup[r[s]]||e(),a=t.add?e(e.unique(a.get().concat(t.element.get()))):e(a.not(t.element).get()),i.classesElementLookup[r[s]]=a,n.push(r[s]),o&&t.classes[r[s]]&&n.push(t.classes[r[s]])}return t=e.extend({element:this.element,classes:this.options.classes||{}},t),this._on(t.element,{remove:"_untrackClassesElement"}),t.keys&&r(t.keys.match(/\S+/g)||[],!0),t.extra&&r(t.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(t){var n=this;e.each(n.classesElementLookup,function(i,r){-1!==e.inArray(t.target,r)&&(n.classesElementLookup[i]=e(r.not(t.target).get()))})},_removeClass:function(e,t,n){return this._toggleClass(e,t,n,!1)},_addClass:function(e,t,n){return this._toggleClass(e,t,n,!0)},_toggleClass:function(e,t,n,i){i="boolean"==typeof i?i:n;var r="string"==typeof e||null===e,o={extra:r?t:n,keys:r?e:t,element:r?this.element:e,add:i};return o.element.toggleClass(this._classes(o),i),this},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,a){function s(){if(t||!0!==o.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?o[a]:a).apply(o,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+o.eventNamespace,h=l[2];h?r.on(c,h,s):n.on(c,s)})},_off:function(t,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(n).off(n),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){var n=this;return setTimeout(function(){return("string"==typeof e?n[e]:e).apply(n,arguments)},t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(e(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(e(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,n,i){var r,o,a=this.options[t];if(i=i||{},(n=e.Event(n)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(a)&&!1===a.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){var a;"string"==typeof r&&(r={effect:r});var s=r?!0===r||"number"==typeof r?n:r.effect||n:t;"number"==typeof(r=r||{})&&(r={duration:r}),a=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),a&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}}),e.widget,e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])}}),e.fn.scrollParent=function(t){var n=this.css("position"),i="absolute"===n,r=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return(!i||"static"!==t.css("position"))&&r.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==n&&o.length?o:e(this[0].ownerDocument||document)},e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var r=!1;e(document).on("mouseup",function(){r=!1}),e.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).on("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!r){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var n=this,i=1===t.which,o=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(i&&!o&&this._mouseCapture(t)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),r=!0,0)))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,r=!1,t.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.ui.plugin={add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n,i){var r,o=e.plugins[t];if(o&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<o.length;r++)e.options[o[r][0]]&&o[r][1].apply(e.element,n)}},e.ui.safeActiveElement=function(e){var t;try{t=e.activeElement}catch(n){t=e.body}return t||(t=e.body),t.nodeName||(t=e.body),t},e.ui.safeBlur=function(t){t&&"body"!==t.nodeName.toLowerCase()&&e(t).trigger("blur")},e.widget("ui.draggable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var n=this.options;return!(this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0||(this.handle=this._getHandle(t),!this.handle||(this._blurActiveElement(t),this._blockFrames(!0===n.iframeFix?"iframe":n.iframeFix),0)))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var n=e.ui.safeActiveElement(this.document[0]),i=e(t.target);i.closest(n).length||e.ui.safeBlur(n)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp(new e.Event("mouseup",t)),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==n._trigger("stop",t)&&n._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new e.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper),r=i?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options,o=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),(i=n[0])&&(t=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n)):this.containment=r.containment:this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,i,r,o,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(r=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-a.grid[1]:r+a.grid[1]:r,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,i){var r=e.extend({},n,{item:i.element});i.sortables=[],e(i.options.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n,i){var r=e.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,e.each(i.sortables,function(){var e=this;e.isOver?(e.isOver=0,i.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,r))})},drag:function(t,n,i){e.each(i.sortables,function(){var r=!1,o=this;o.positionAbs=i.positionAbs,o.helperProportions=i.helperProportions,o.offset.click=i.offset.click,o._intersectsWith(o.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&e.contains(o.element[0],this.element[0])&&(r=!1),r})),r?(o.isOver||(o.isOver=1,i._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=i.offset.click.top,o.offset.click.left=i.offset.click.left,o.offset.parent.left-=i.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=i.offset.parent.top-o.offset.parent.top,i._trigger("toSortable",t),i.dropped=o.element,e.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,o.fromOutside=i),o.currentItem&&(o._mouseDrag(t),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(i._parent),i._refreshOffsets(t),n.position=i._generatePosition(t,!0),i._trigger("fromSortable",t),i.dropped=!1,e.each(i.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,i){var r=e("body"),o=i.options;r.css("cursor")&&(o._cursor=r.css("cursor")),r.css("cursor",o.cursor)},stop:function(t,n,i){var r=i.options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("opacity")&&(o._opacity=r.css("opacity")),r.css("opacity",o.opacity)},stop:function(t,n,i){var r=i.options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(t,n,i){var r=i.options,o=!1,a=i.scrollParentNotHidden[0],s=i.document[0];a!==s&&"HTML"!==a.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+a.offsetHeight-t.pageY<r.scrollSensitivity?a.scrollTop=o=a.scrollTop+r.scrollSpeed:t.pageY-i.overflowOffset.top<r.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+a.offsetWidth-t.pageX<r.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+r.scrollSpeed:t.pageX-i.overflowOffset.left<r.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(s).scrollTop()<r.scrollSensitivity?o=e(s).scrollTop(e(s).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<r.scrollSensitivity&&(o=e(s).scrollTop(e(s).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(s).scrollLeft()<r.scrollSensitivity?o=e(s).scrollLeft(e(s).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<r.scrollSensitivity&&(o=e(s).scrollLeft(e(s).scrollLeft()+r.scrollSpeed)))),!1!==o&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,i){var r=i.options;i.snapElements=[],e(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var t=e(this),n=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,i){var r,o,a,s,l,c,h,u,f,p,d=i.options,g=d.snapTolerance,m=n.offset.left,v=m+i.helperProportions.width,y=n.offset.top,w=y+i.helperProportions.height;for(f=i.snapElements.length-1;f>=0;f--)l=i.snapElements[f].left-i.margins.left,c=l+i.snapElements[f].width,h=i.snapElements[f].top-i.margins.top,u=h+i.snapElements[f].height,v<l-g||m>c+g||w<h-g||y>u+g||!e.contains(i.snapElements[f].item.ownerDocument,i.snapElements[f].item)?(i.snapElements[f].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[f].item})),i.snapElements[f].snapping=!1):("inner"!==d.snapMode&&(r=Math.abs(h-w)<=g,o=Math.abs(u-y)<=g,a=Math.abs(l-v)<=g,s=Math.abs(c-m)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left)),p=r||o||a||s,"outer"!==d.snapMode&&(r=Math.abs(h-y)<=g,o=Math.abs(u-w)<=g,a=Math.abs(l-m)<=g,s=Math.abs(c-v)<=g,r&&(n.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),o&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left)),!i.snapElements[f].snapping&&(r||o||a||s||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[f].item})),i.snapElements[f].snapping=r||o||a||s||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,i){var r,o=i.options,a=e.makeArray(e(o.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});a.length&&(r=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",r+t)}),this.css("zIndex",r+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,i){var r=e(n.helper),o=i.options;r.css("zIndex")&&(o._zIndex=r.css("zIndex")),r.css("zIndex",o.zIndex)},stop:function(t,n,i){var r=i.options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}}),e.ui.draggable}(t=e);var i=function(e){return e instanceof i?e:this instanceof i?void(this._wrapped=e):new i(e)};!function(){var e=Array.prototype,t=Object.prototype,n=Function.prototype,r=e.push,o=e.slice,a=t.toString,s=t.hasOwnProperty,l=Array.isArray,c=Object.keys,h=n.bind,u=Object.create,f=function(){};i.VERSION="1.8.3";var p=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return function(){return e.apply(t,arguments)}},d=function(e,t,n){return null==e?i.identity:i.isFunction(e)?p(e,t,n):i.isObject(e)?i.matcher(e):i.property(e)};i.iteratee=function(e,t){return d(e,t,1/0)};var g=function(e,t){return function(n){var i=arguments.length;if(i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],a=e(o),s=a.length,l=0;l<s;l++){var c=a[l];t&&void 0!==n[c]||(n[c]=o[c])}return n}},m=function(e){if(!i.isObject(e))return{};if(u)return u(e);f.prototype=e;var t=new f;return f.prototype=null,t},v=function(e){return function(t){return null==t?void 0:t[e]}},y=Math.pow(2,53)-1,w=v("length"),b=function(e){var t=w(e);return"number"==typeof t&&t>=0&&t<=y};function x(e){return function(t,n,r,o){n=p(n,o,4);var a=!b(t)&&i.keys(t),s=(a||t).length,l=e>0?0:s-1;return arguments.length<3&&(r=t[a?a[l]:l],l+=e),function(t,n,i,r,o,a){for(;o>=0&&o<a;o+=e){var s=r?r[o]:o;i=n(i,t[s],s,t)}return i}(t,n,r,a,l,s)}}i.each=i.forEach=function(e,t,n){var r,o;if(t=p(t,n),b(e))for(r=0,o=e.length;r<o;r++)t(e[r],r,e);else{var a=i.keys(e);for(r=0,o=a.length;r<o;r++)t(e[a[r]],a[r],e)}return e},i.map=i.collect=function(e,t,n){t=d(t,n);for(var r=!b(e)&&i.keys(e),o=(r||e).length,a=Array(o),s=0;s<o;s++){var l=r?r[s]:s;a[s]=t(e[l],l,e)}return a},i.reduce=i.foldl=i.inject=x(1),i.reduceRight=i.foldr=x(-1),i.find=i.detect=function(e,t,n){var r;if(void 0!==(r=b(e)?i.findIndex(e,t,n):i.findKey(e,t,n))&&-1!==r)return e[r]},i.filter=i.select=function(e,t,n){var r=[];return t=d(t,n),i.each(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},i.reject=function(e,t,n){return i.filter(e,i.negate(d(t)),n)},i.every=i.all=function(e,t,n){t=d(t,n);for(var r=!b(e)&&i.keys(e),o=(r||e).length,a=0;a<o;a++){var s=r?r[a]:a;if(!t(e[s],s,e))return!1}return!0},i.some=i.any=function(e,t,n){t=d(t,n);for(var r=!b(e)&&i.keys(e),o=(r||e).length,a=0;a<o;a++){var s=r?r[a]:a;if(t(e[s],s,e))return!0}return!1},i.contains=i.includes=i.include=function(e,t,n,r){return b(e)||(e=i.values(e)),("number"!=typeof n||r)&&(n=0),i.indexOf(e,t,n)>=0},i.invoke=function(e,t){var n=o.call(arguments,2),r=i.isFunction(t);return i.map(e,function(e){var i=r?t:e[t];return null==i?i:i.apply(e,n)})},i.pluck=function(e,t){return i.map(e,i.property(t))},i.where=function(e,t){return i.filter(e,i.matcher(t))},i.findWhere=function(e,t){return i.find(e,i.matcher(t))},i.max=function(e,t,n){var r,o,a=-1/0,s=-1/0;if(null==t&&null!=e)for(var l=0,c=(e=b(e)?e:i.values(e)).length;l<c;l++)(r=e[l])>a&&(a=r);else t=d(t,n),i.each(e,function(e,n,i){((o=t(e,n,i))>s||o===-1/0&&a===-1/0)&&(a=e,s=o)});return a},i.min=function(e,t,n){var r,o,a=1/0,s=1/0;if(null==t&&null!=e)for(var l=0,c=(e=b(e)?e:i.values(e)).length;l<c;l++)(r=e[l])<a&&(a=r);else t=d(t,n),i.each(e,function(e,n,i){((o=t(e,n,i))<s||o===1/0&&a===1/0)&&(a=e,s=o)});return a},i.shuffle=function(e){for(var t,n=b(e)?e:i.values(e),r=n.length,o=Array(r),a=0;a<r;a++)(t=i.random(0,a))!==a&&(o[a]=o[t]),o[t]=n[a];return o},i.sample=function(e,t,n){return null==t||n?(b(e)||(e=i.values(e)),e[i.random(e.length-1)]):i.shuffle(e).slice(0,Math.max(0,t))},i.sortBy=function(e,t,n){return t=d(t,n),i.pluck(i.map(e,function(e,n,i){return{value:e,index:n,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index-t.index}),"value")};var k=function(e){return function(t,n,r){var o={};return n=d(n,r),i.each(t,function(i,r){var a=n(i,r,t);e(o,i,a)}),o}};i.groupBy=k(function(e,t,n){i.has(e,n)?e[n].push(t):e[n]=[t]}),i.indexBy=k(function(e,t,n){e[n]=t}),i.countBy=k(function(e,t,n){i.has(e,n)?e[n]++:e[n]=1}),i.toArray=function(e){return e?i.isArray(e)?o.call(e):b(e)?i.map(e,i.identity):i.values(e):[]},i.size=function(e){return null==e?0:b(e)?e.length:i.keys(e).length},i.partition=function(e,t,n){t=d(t,n);var r=[],o=[];return i.each(e,function(e,n,i){(t(e,n,i)?r:o).push(e)}),[r,o]},i.first=i.head=i.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:i.initial(e,e.length-t)},i.initial=function(e,t,n){return o.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},i.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:i.rest(e,Math.max(0,e.length-t))},i.rest=i.tail=i.drop=function(e,t,n){return o.call(e,null==t||n?1:t)},i.compact=function(e){return i.filter(e,i.identity)};var S=function(e,t,n,r){for(var o=[],a=0,s=r||0,l=w(e);s<l;s++){var c=e[s];if(b(c)&&(i.isArray(c)||i.isArguments(c))){t||(c=S(c,t,n));var h=0,u=c.length;for(o.length+=u;h<u;)o[a++]=c[h++]}else n||(o[a++]=c)}return o};function C(e){return function(t,n,i){n=d(n,i);for(var r=w(t),o=e>0?0:r-1;o>=0&&o<r;o+=e)if(n(t[o],o,t))return o;return-1}}function T(e,t,n){return function(r,a,s){var l=0,c=w(r);if("number"==typeof s)e>0?l=s>=0?s:Math.max(s+c,l):c=s>=0?Math.min(s+1,c):s+c+1;else if(n&&s&&c)return r[s=n(r,a)]===a?s:-1;if(a!=a)return(s=t(o.call(r,l,c),i.isNaN))>=0?s+l:-1;for(s=e>0?l:c-1;s>=0&&s<c;s+=e)if(r[s]===a)return s;return-1}}i.flatten=function(e,t){return S(e,t,!1)},i.without=function(e){return i.difference(e,o.call(arguments,1))},i.uniq=i.unique=function(e,t,n,r){i.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=d(n,r));for(var o=[],a=[],s=0,l=w(e);s<l;s++){var c=e[s],h=n?n(c,s,e):c;t?(s&&a===h||o.push(c),a=h):n?i.contains(a,h)||(a.push(h),o.push(c)):i.contains(o,c)||o.push(c)}return o},i.union=function(){return i.uniq(S(arguments,!0,!0))},i.intersection=function(e){for(var t=[],n=arguments.length,r=0,o=w(e);r<o;r++){var a=e[r];if(!i.contains(t,a)){for(var s=1;s<n&&i.contains(arguments[s],a);s++);s===n&&t.push(a)}}return t},i.difference=function(e){var t=S(arguments,!0,!0,1);return i.filter(e,function(e){return!i.contains(t,e)})},i.zip=function(){return i.unzip(arguments)},i.unzip=function(e){for(var t=e&&i.max(e,w).length||0,n=Array(t),r=0;r<t;r++)n[r]=i.pluck(e,r);return n},i.object=function(e,t){for(var n={},i=0,r=w(e);i<r;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},i.findIndex=C(1),i.findLastIndex=C(-1),i.sortedIndex=function(e,t,n,i){for(var r=(n=d(n,i,1))(t),o=0,a=w(e);o<a;){var s=Math.floor((o+a)/2);n(e[s])<r?o=s+1:a=s}return o},i.indexOf=T(1,i.findIndex,i.sortedIndex),i.lastIndexOf=T(-1,i.findLastIndex),i.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=Array(i),o=0;o<i;o++,e+=n)r[o]=e;return r};var _=function(e,t,n,r,o){if(!(r instanceof t))return e.apply(n,o);var a=m(e.prototype),s=e.apply(a,o);return i.isObject(s)?s:a};i.bind=function(e,t){if(h&&e.bind===h)return h.apply(e,o.call(arguments,1));if(!i.isFunction(e))throw new TypeError("Bind must be called on a function");var n=o.call(arguments,2),r=function(){return _(e,r,t,this,n.concat(o.call(arguments)))};return r},i.partial=function(e){var t=o.call(arguments,1),n=function(){for(var r=0,o=t.length,a=Array(o),s=0;s<o;s++)a[s]=t[s]===i?arguments[r++]:t[s];for(;r<arguments.length;)a.push(arguments[r++]);return _(e,n,this,this,a)};return n},i.bindAll=function(e){var t,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(t=1;t<r;t++)e[n=arguments[t]]=i.bind(e[n],e);return e},i.memoize=function(e,t){var n=function(r){var o=n.cache,a=""+(t?t.apply(this,arguments):r);return i.has(o,a)||(o[a]=e.apply(this,arguments)),o[a]};return n.cache={},n},i.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},i.defer=i.partial(i.delay,i,1),i.throttle=function(e,t,n){var r,o,a,s=null,l=0;n||(n={});var c=function(){l=!1===n.leading?0:i.now(),s=null,a=e.apply(r,o),s||(r=o=null)};return function(){var h=i.now();l||!1!==n.leading||(l=h);var u=t-(h-l);return r=this,o=arguments,u<=0||u>t?(s&&(clearTimeout(s),s=null),l=h,a=e.apply(r,o),s||(r=o=null)):s||!1===n.trailing||(s=setTimeout(c,u)),a}},i.debounce=function(e,t,n){var r,o,a,s,l,c=function(){var h=i.now()-s;h<t&&h>=0?r=setTimeout(c,t-h):(r=null,n||(l=e.apply(a,o),r||(a=o=null)))};return function(){a=this,o=arguments,s=i.now();var h=n&&!r;return r||(r=setTimeout(c,t)),h&&(l=e.apply(a,o),a=o=null),l}},i.wrap=function(e,t){return i.partial(t,e)},i.negate=function(e){return function(){return!e.apply(this,arguments)}},i.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},i.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},i.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},i.once=i.partial(i.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function R(e,n){var r=I.length,o=e.constructor,a=i.isFunction(o)&&o.prototype||t,s="constructor";for(i.has(e,s)&&!i.contains(n,s)&&n.push(s);r--;)(s=I[r])in e&&e[s]!==a[s]&&!i.contains(n,s)&&n.push(s)}i.keys=function(e){if(!i.isObject(e))return[];if(c)return c(e);var t=[];for(var n in e)i.has(e,n)&&t.push(n);return A&&R(e,t),t},i.allKeys=function(e){if(!i.isObject(e))return[];var t=[];for(var n in e)t.push(n);return A&&R(e,t),t},i.values=function(e){for(var t=i.keys(e),n=t.length,r=Array(n),o=0;o<n;o++)r[o]=e[t[o]];return r},i.mapObject=function(e,t,n){t=d(t,n);for(var r,o=i.keys(e),a=o.length,s={},l=0;l<a;l++)s[r=o[l]]=t(e[r],r,e);return s},i.pairs=function(e){for(var t=i.keys(e),n=t.length,r=Array(n),o=0;o<n;o++)r[o]=[t[o],e[t[o]]];return r},i.invert=function(e){for(var t={},n=i.keys(e),r=0,o=n.length;r<o;r++)t[e[n[r]]]=n[r];return t},i.functions=i.methods=function(e){var t=[];for(var n in e)i.isFunction(e[n])&&t.push(n);return t.sort()},i.extend=g(i.allKeys),i.extendOwn=i.assign=g(i.keys),i.findKey=function(e,t,n){t=d(t,n);for(var r,o=i.keys(e),a=0,s=o.length;a<s;a++)if(t(e[r=o[a]],r,e))return r},i.pick=function(e,t,n){var r,o,a={},s=e;if(null==s)return a;i.isFunction(t)?(o=i.allKeys(s),r=p(t,n)):(o=S(arguments,!1,!1,1),r=function(e,t,n){return t in n},s=Object(s));for(var l=0,c=o.length;l<c;l++){var h=o[l],u=s[h];r(u,h,s)&&(a[h]=u)}return a},i.omit=function(e,t,n){if(i.isFunction(t))t=i.negate(t);else{var r=i.map(S(arguments,!1,!1,1),String);t=function(e,t){return!i.contains(r,t)}}return i.pick(e,t,n)},i.defaults=g(i.allKeys,!0),i.create=function(e,t){var n=m(e);return t&&i.extendOwn(n,t),n},i.clone=function(e){return i.isObject(e)?i.isArray(e)?e.slice():i.extend({},e):e},i.tap=function(e,t){return t(e),e},i.isMatch=function(e,t){var n=i.keys(t),r=n.length;if(null==e)return!r;for(var o=Object(e),a=0;a<r;a++){var s=n[a];if(t[s]!==o[s]||!(s in o))return!1}return!0};var P=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof i&&(e=e._wrapped),t instanceof i&&(t=t._wrapped);var o=a.call(e);if(o!==a.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var s="[object Array]"===o;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(i.isFunction(l)&&l instanceof l&&i.isFunction(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var h=(n=n||[]).length;h--;)if(n[h]===e)return r[h]===t;if(n.push(e),r.push(t),s){if((h=e.length)!==t.length)return!1;for(;h--;)if(!P(e[h],t[h],n,r))return!1}else{var u,f=i.keys(e);if(h=f.length,i.keys(t).length!==h)return!1;for(;h--;)if(u=f[h],!i.has(t,u)||!P(e[u],t[u],n,r))return!1}return n.pop(),r.pop(),!0};i.isEqual=function(e,t){return P(e,t)},i.isEmpty=function(e){return null==e||(b(e)&&(i.isArray(e)||i.isString(e)||i.isArguments(e))?0===e.length:0===i.keys(e).length)},i.isElement=function(e){return!(!e||1!==e.nodeType)},i.isArray=l||function(e){return"[object Array]"===a.call(e)},i.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},i.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){i["is"+e]=function(t){return a.call(t)==="[object "+e+"]"}}),i.isArguments(arguments)||(i.isArguments=function(e){return i.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(i.isFunction=function(e){return"function"==typeof e||!1}),i.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},i.isNaN=function(e){return i.isNumber(e)&&e!==+e},i.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===a.call(e)},i.isNull=function(e){return null===e},i.isUndefined=function(e){return void 0===e},i.has=function(e,t){return null!=e&&s.call(e,t)},i.identity=function(e){return e},i.constant=function(e){return function(){return e}},i.noop=function(){},i.property=v,i.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},i.matcher=i.matches=function(e){return e=i.extendOwn({},e),function(t){return i.isMatch(t,e)}},i.times=function(e,t,n){var i=Array(Math.max(0,e));t=p(t,n,1);for(var r=0;r<e;r++)i[r]=t(r);return i},i.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},i.now=Date.now||function(){return(new Date).getTime()};var E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},L=i.invert(E),M=function(e){var t=function(t){return e[t]},n="(?:"+i.keys(e).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(o,t):e}};i.escape=M(E),i.unescape=M(L),i.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),i.isFunction(r)?r.call(e):r};var D=0;i.uniqueId=function(e){var t=++D+"";return e?e+t:t},i.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,O=function(e){return"\\"+B[e]};i.template=function(e,t,n){!t&&n&&(t=n),t=i.defaults({},t,i.templateSettings);var r=RegExp([(t.escape||F).source,(t.interpolate||F).source,(t.evaluate||F).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(r,function(t,n,i,r,s){return a+=e.slice(o,s).replace(N,O),o=s+t.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var s=new Function(t.variable||"obj","_",a)}catch(e){throw e.source=a,e}var l=function(e){return s.call(this,e,i)},c=t.variable||"obj";return l.source="function("+c+"){\n"+a+"}",l},i.chain=function(e){var t=i(e);return t._chain=!0,t};var H=function(e,t){return e._chain?i(t).chain():t};i.mixin=function(e){i.each(i.functions(e),function(t){var n=i[t]=e[t];i.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),H(this,n.apply(i,e))}})},i.mixin(i),i.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=e[t];i.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],H(this,e)}}),i.each(["concat","join","slice"],function(t){var n=e[t];i.prototype[t]=function(){return H(this,n.apply(this._wrapped,arguments))}}),i.prototype.value=function(){return this._wrapped},i.prototype.valueOf=i.prototype.toJSON=i.prototype.value,i.prototype.toString=function(){return""+this._wrapped}}();var r=!0,o={Huffman:{},Util:{},CRC32:{},CompressionMethod:{DEFLATE:8,RESERVED:15},Zip:function(e){e=e||{},this.files=[],this.comment=e.comment,this.password}};o.Zip.CompressionMethod={STORE:0,DEFLATE:8},o.Zip.OperatingSystem={MSDOS:0,UNIX:3,MACINTOSH:7},o.Zip.Flags={ENCRYPT:1,DESCRIPTOR:8,UTF8:2048},o.Zip.FileHeaderSignature=[80,75,1,2],o.Zip.LocalFileHeaderSignature=[80,75,3,4],o.Zip.CentralDirectorySignature=[80,75,5,6],o.Zip.prototype.addFile=function(e,t){(t=t||{}).filename;var n,i=e.length,a=0;if(r&&e instanceof Array&&(e=new Uint8Array(e)),"number"!=typeof t.compressionMethod&&(t.compressionMethod=o.Zip.CompressionMethod.DEFLATE),t.compress)switch(t.compressionMethod){case o.Zip.CompressionMethod.STORE:break;case o.Zip.CompressionMethod.DEFLATE:a=o.CRC32.calc(e),e=this.deflateWithOption(e,t),n=!0;break;default:throw new Error("unknown compression method:"+t.compressionMethod)}this.files.push({buffer:e,option:t,compressed:n,encrypted:!1,size:i,crc32:a})},o.Zip.prototype.setPassword=function(e){this.password=e},o.Zip.prototype.compress=function(){var e,t,n,i,a,s,l,c,h,u,f,p,d,g,m,v,y,w,b,x,k,S,C,T,_,A,I=this.files,R=0,P=0;for(C=0,T=I.length;C<T;++C){if(g=(e=I[C]).option.filename?e.option.filename.length:0,m=e.option.extraField?e.option.extraField.length:0,v=e.option.comment?e.option.comment.length:0,!e.compressed)switch(e.crc32=o.CRC32.calc(e.buffer),e.option.compressionMethod){case o.Zip.CompressionMethod.STORE:break;case o.Zip.CompressionMethod.DEFLATE:e.buffer=this.deflateWithOption(e.buffer,e.option),e.compressed=!0;break;default:throw new Error("unknown compression method:"+e.option.compressionMethod)}if(void 0!==e.option.password||void 0!==this.password){for(S=this.createEncryptionKey(e.option.password||this.password),x=e.buffer,r?((k=new Uint8Array(x.length+12)).set(x,12),x=k):x.unshift(0,0,0,0,0,0,0,0,0,0,0,0),_=0;_<12;++_)x[_]=this.encode(S,11===C?255&e.crc32:256*Math.random()|0);for(A=x.length;_<A;++_)x[_]=this.encode(S,x[_]);e.buffer=x}R+=30+g+e.buffer.length,P+=46+g+v}for(s=22+(this.comment?this.comment.length:0),t=new(r?Uint8Array:Array)(R+P+s),n=0,a=(i=R)+P,C=0,T=I.length;C<T;++C){if(g=(e=I[C]).option.filename?e.option.filename.length:0,m=0,v=e.option.comment?e.option.comment.length:0,l=n,t[n++]=o.Zip.LocalFileHeaderSignature[0],t[n++]=o.Zip.LocalFileHeaderSignature[1],t[n++]=o.Zip.LocalFileHeaderSignature[2],t[n++]=o.Zip.LocalFileHeaderSignature[3],t[i++]=o.Zip.FileHeaderSignature[0],t[i++]=o.Zip.FileHeaderSignature[1],t[i++]=o.Zip.FileHeaderSignature[2],t[i++]=o.Zip.FileHeaderSignature[3],20,t[i++]=20,t[i++]=e.option.os||o.Zip.OperatingSystem.MSDOS,t[n++]=t[i++]=20,t[n++]=t[i++]=0,c=0,(e.option.password||this.password)&&(c|=o.Zip.Flags.ENCRYPT),t[n++]=t[i++]=255&c,t[n++]=t[i++]=c>>8&255,h=e.option.compressionMethod,t[n++]=t[i++]=255&h,t[n++]=t[i++]=h>>8&255,u=e.option.date||new Date,t[n++]=t[i++]=(7&u.getMinutes())<<5|u.getSeconds()/2|0,t[n++]=t[i++]=u.getHours()<<3|u.getMinutes()>>3,t[n++]=t[i++]=(u.getMonth()+1&7)<<5|u.getDate(),t[n++]=t[i++]=(u.getFullYear()-1980&127)<<1|u.getMonth()+1>>3,f=e.crc32,t[n++]=t[i++]=255&f,t[n++]=t[i++]=f>>8&255,t[n++]=t[i++]=f>>16&255,t[n++]=t[i++]=f>>24&255,p=e.buffer.length,t[n++]=t[i++]=255&p,t[n++]=t[i++]=p>>8&255,t[n++]=t[i++]=p>>16&255,t[n++]=t[i++]=p>>24&255,d=e.size,t[n++]=t[i++]=255&d,t[n++]=t[i++]=d>>8&255,t[n++]=t[i++]=d>>16&255,t[n++]=t[i++]=d>>24&255,t[n++]=t[i++]=255&g,t[n++]=t[i++]=g>>8&255,t[n++]=t[i++]=255&m,t[n++]=t[i++]=m>>8&255,t[i++]=255&v,t[i++]=v>>8&255,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=0,t[i++]=255&l,t[i++]=l>>8&255,t[i++]=l>>16&255,t[i++]=l>>24&255,y=e.option.filename)if(r)t.set(y,n),t.set(y,i),n+=g,i+=g;else for(_=0;_<g;++_)t[n++]=t[i++]=y[_];if(w=e.option.extraField)if(r)t.set(w,n),t.set(w,i),n+=m,i+=m;else for(_=0;_<v;++_)t[n++]=t[i++]=w[_];if(b=e.option.comment)if(r)t.set(b,i),i+=v;else for(_=0;_<v;++_)t[i++]=b[_];if(r)t.set(e.buffer,n),n+=e.buffer.length;else for(_=0,A=e.buffer.length;_<A;++_)t[n++]=e.buffer[_]}if(t[a++]=o.Zip.CentralDirectorySignature[0],t[a++]=o.Zip.CentralDirectorySignature[1],t[a++]=o.Zip.CentralDirectorySignature[2],t[a++]=o.Zip.CentralDirectorySignature[3],t[a++]=0,t[a++]=0,t[a++]=0,t[a++]=0,t[a++]=255&T,t[a++]=T>>8&255,t[a++]=255&T,t[a++]=T>>8&255,t[a++]=255&P,t[a++]=P>>8&255,t[a++]=P>>16&255,t[a++]=P>>24&255,t[a++]=255&R,t[a++]=R>>8&255,t[a++]=R>>16&255,t[a++]=R>>24&255,v=this.comment?this.comment.length:0,t[a++]=255&v,t[a++]=v>>8&255,this.comment)if(r)t.set(this.comment,a),a+=v;else for(_=0,A=v;_<A;++_)t[a++]=this.comment[_];return t},o.Zip.prototype.deflateWithOption=function(e,t){return new o.RawDeflate(e,t.deflateOption).compress()},o.Zip.prototype.getByte=function(e){var t=65535&e[2]|2;return t*(1^t)>>8&255},o.Zip.prototype.encode=function(e,t){var n=this.getByte(e);return this.updateKeys(e,t),n^t},o.Zip.prototype.updateKeys=function(e,t){e[0]=o.CRC32.single(e[0],t),e[1]=1+(6681*(20173*(e[1]+(255&e[0]))>>>0)>>>0)>>>0,e[2]=o.CRC32.single(e[2],e[1]>>>24)},o.Zip.prototype.createEncryptionKey=function(e){var t,n,i=[305419896,591751049,878082192];for(r&&(i=new Uint32Array(i)),t=0,n=e.length;t<n;++t)this.updateKeys(i,255&e[t]);return i},o.Huffman.buildHuffmanTable=function(e){var t,n,i,o,a,s,l,c,h,u,f,p=e.length,d=0,g=Number.POSITIVE_INFINITY;for(c=0,h=p;c<h;++c)e[c]>d&&(d=e[c]),e[c]<g&&(g=e[c]);for(t=1<<d,n=new(r?Uint32Array:Array)(t),i=1,o=0,a=2;i<=d;){for(c=0;c<p;++c)if(e[c]===i){for(s=0,l=o,u=0;u<i;++u)s=s<<1|1&l,l>>=1;for(f=i<<16|c,u=s;u<t;u+=a)n[u]=f;++o}++i,o<<=1,a<<=1}return[n,d,g]};var a,s,l,c,h,u=o.Huffman.buildHuffmanTable;o.RawInflate=function(e,t){switch(this.buffer,this.blocks=[],this.bufferSize=32768,this.totalpos=0,this.ip=0,this.bitsbuf=0,this.bitsbuflen=0,this.input=r?new Uint8Array(e):e,this.output,this.op,this.bfinal=!1,this.bufferType=o.RawInflate.BufferType.ADAPTIVE,this.resize=!1,!t&&(t={})||(t.index&&(this.ip=t.index),t.bufferSize&&(this.bufferSize=t.bufferSize),t.bufferType&&(this.bufferType=t.bufferType),t.resize&&(this.resize=t.resize)),this.bufferType){case o.RawInflate.BufferType.BLOCK:this.op=o.RawInflate.MaxBackwardLength,this.output=new(r?Uint8Array:Array)(o.RawInflate.MaxBackwardLength+this.bufferSize+o.RawInflate.MaxCopyLength);break;case o.RawInflate.BufferType.ADAPTIVE:this.op=0,this.output=new(r?Uint8Array:Array)(this.bufferSize);break;default:throw new Error("invalid inflate mode")}},o.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1},o.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();switch(this.bufferType){case o.RawInflate.BufferType.BLOCK:return this.concatBufferBlock();case o.RawInflate.BufferType.ADAPTIVE:return this.concatBufferDynamic();default:throw new Error("invalid inflate mode")}},o.RawInflate.MaxBackwardLength=32768,o.RawInflate.MaxCopyLength=258,o.RawInflate.Order=(a=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],r?new Uint16Array(a):a),o.RawInflate.LengthCodeTable=(s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],r?new Uint16Array(s):s),o.RawInflate.LengthExtraTable=(l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],r?new Uint8Array(l):l),o.RawInflate.DistCodeTable=(c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],r?new Uint16Array(c):c),o.RawInflate.DistExtraTable=(h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],r?new Uint8Array(h):h),o.RawInflate.FixedLiteralLengthTable=function(){var e,t,n=new(r?Uint8Array:Array)(288);for(e=0,t=n.length;e<t;++e)n[e]=e<=143?8:e<=255?9:e<=279?7:8;return u(n)}(),o.RawInflate.FixedDistanceTable=function(){var e,t,n=new(r?Uint8Array:Array)(30);for(e=0,t=n.length;e<t;++e)n[e]=5;return u(n)}(),o.RawInflate.prototype.parseBlock=function(){var e=this.readBits(3);switch(1&e&&(this.bfinal=!0),e>>>=1){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw new Error("unknown BTYPE: "+e)}},o.RawInflate.prototype.readBits=function(e){var t,n=this.bitsbuf,i=this.bitsbuflen,r=this.input,o=this.ip;if(o+(e-i+7>>3)>=r.length)throw new Error("input buffer is broken");for(;i<e;)n|=r[o++]<<i,i+=8;return t=n&(1<<e)-1,n>>>=e,i-=e,this.bitsbuf=n,this.bitsbuflen=i,this.ip=o,t},o.RawInflate.prototype.readCodeByTable=function(e){for(var t,n,i=this.bitsbuf,r=this.bitsbuflen,o=this.input,a=this.ip,s=o.length,l=e[0],c=e[1];r<c&&!(a>=s);)i|=o[a++]<<r,r+=8;if((n=(t=l[i&(1<<c)-1])>>>16)>r)throw new Error("invalid code length: "+n);return this.bitsbuf=i>>n,this.bitsbuflen=r-n,this.ip=a,65535&t},o.RawInflate.prototype.parseUncompressedBlock=function(){var e,t,n=this.input,i=this.ip,a=this.output,s=this.op,l=n.length,c=a.length;if(this.bitsbuf=0,this.bitsbuflen=0,i+1>=l)throw new Error("invalid uncompressed block header: LEN");if(e=n[i++]|n[i++]<<8,i+1>=l)throw new Error("invalid uncompressed block header: NLEN");if(e===~(n[i++]|n[i++]<<8))throw new Error("invalid uncompressed block header: length verify");if(i+e>n.length)throw new Error("input buffer is broken");switch(this.bufferType){case o.RawInflate.BufferType.BLOCK:for(;s+e>a.length;){if(e-=t=c-s,r)a.set(n.subarray(i,i+t),s),s+=t,i+=t;else for(;t--;)a[s++]=n[i++];this.op=s,a=this.expandBufferBlock(),s=this.op}break;case o.RawInflate.BufferType.ADAPTIVE:for(;s+e>a.length;)a=this.expandBufferAdaptive({fixRatio:2});break;default:throw new Error("invalid inflate mode")}if(r)a.set(n.subarray(i,i+e),s),s+=e,i+=e;else for(;e--;)a[s++]=n[i++];this.ip=i,this.op=s,this.output=a},o.RawInflate.prototype.parseFixedHuffmanBlock=function(){switch(this.bufferType){case o.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(o.RawInflate.FixedLiteralLengthTable,o.RawInflate.FixedDistanceTable);break;case o.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(o.RawInflate.FixedLiteralLengthTable,o.RawInflate.FixedDistanceTable);break;default:throw new Error("invalid inflate mode")}},o.RawInflate.prototype.parseDynamicHuffmanBlock=function(){var e,t,n,i,a,s,l,c,h,f=this.readBits(5)+257,p=this.readBits(5)+1,d=this.readBits(4)+4,g=new(r?Uint8Array:Array)(o.RawInflate.Order.length);for(c=0;c<d;++c)g[o.RawInflate.Order[c]]=this.readBits(3);if(!r)for(c=d,d=g.length;c<d;++c)g[o.RawInflate.Order[c]]=0;for(e=u(g),i=new(r?Uint8Array:Array)(f+p),c=0,h=f+p;c<h;)switch(a=this.readCodeByTable(e)){case 16:for(l=3+this.readBits(2);l--;)i[c++]=s;break;case 17:for(l=3+this.readBits(3);l--;)i[c++]=0;s=0;break;case 18:for(l=11+this.readBits(7);l--;)i[c++]=0;s=0;break;default:i[c++]=a,s=a}switch(t=u(r?i.subarray(0,f):i.slice(0,f)),n=u(r?i.subarray(f):i.slice(f)),this.bufferType){case o.RawInflate.BufferType.ADAPTIVE:this.decodeHuffmanAdaptive(t,n);break;case o.RawInflate.BufferType.BLOCK:this.decodeHuffmanBlock(t,n);break;default:throw new Error("invalid inflate mode")}},o.RawInflate.prototype.decodeHuffmanBlock=function(e,t){var n=this.output,i=this.op;this.currentLitlenTable=e;for(var r,a,s,l,c=n.length-o.RawInflate.MaxCopyLength,h=o.RawInflate.LengthCodeTable,u=o.RawInflate.LengthExtraTable,f=o.RawInflate.DistCodeTable,p=o.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(e));)if(r<256)i>=c&&(this.op=i,n=this.expandBufferBlock(),i=this.op),n[i++]=r;else for(l=h[a=r-257],u[a]>0&&(l+=this.readBits(u[a])),s=f[r=this.readCodeByTable(t)],p[r]>0&&(s+=this.readBits(p[r])),i>=c&&(this.op=i,n=this.expandBufferBlock(),i=this.op);l--;)n[i]=n[i++-s];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=i},o.RawInflate.prototype.decodeHuffmanAdaptive=function(e,t){var n=this.output,i=this.op;this.currentLitlenTable=e;for(var r,a,s,l,c=n.length,h=o.RawInflate.LengthCodeTable,u=o.RawInflate.LengthExtraTable,f=o.RawInflate.DistCodeTable,p=o.RawInflate.DistExtraTable;256!==(r=this.readCodeByTable(e));)if(r<256)i>=c&&(c=(n=this.expandBufferAdaptive()).length),n[i++]=r;else for(l=h[a=r-257],u[a]>0&&(l+=this.readBits(u[a])),s=f[r=this.readCodeByTable(t)],p[r]>0&&(s+=this.readBits(p[r])),i+l>c&&(c=(n=this.expandBufferAdaptive()).length);l--;)n[i]=n[i++-s];for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=i},o.RawInflate.prototype.expandBufferBlock=function(e){var t,n,i=new(r?Uint8Array:Array)(this.op-o.RawInflate.MaxBackwardLength),a=this.op-o.RawInflate.MaxBackwardLength,s=this.output;if(r)i.set(s.subarray(o.RawInflate.MaxBackwardLength,i.length));else for(t=0,n=i.length;t<n;++t)i[t]=s[t+o.RawInflate.MaxBackwardLength];if(this.blocks.push(i),this.totalpos+=i.length,r)s.set(s.subarray(a,a+o.RawInflate.MaxBackwardLength));else for(t=0;t<o.RawInflate.MaxBackwardLength;++t)s[t]=s[a+t];return this.op=o.RawInflate.MaxBackwardLength,s},o.RawInflate.prototype.expandBufferAdaptive=function(e){var t,n,i,o=this.input.length/this.ip+1|0,a=this.input,s=this.output;return e&&("number"==typeof e.fixRatio&&(o=e.fixRatio),"number"==typeof e.addRatio&&(o+=e.addRatio)),n=o<2?(i=(a.length-this.ip)/this.currentLitlenTable[2]/2*258|0)<s.length?s.length+i:s.length<<1:s.length*o,r?(t=new Uint8Array(n)).set(s):t=s,this.output=t,this.output},o.RawInflate.prototype.concatBufferBlock=function(){var e,t,n,i,a,s=0,l=this.totalpos+(this.op-o.RawInflate.MaxBackwardLength),c=this.output,h=this.blocks,u=new(r?Uint8Array:Array)(l);if(0===h.length)return r?this.output.subarray(o.RawInflate.MaxBackwardLength,this.op):this.output.slice(o.RawInflate.MaxBackwardLength,this.op);for(t=0,n=h.length;t<n;++t)for(i=0,a=(e=h[t]).length;i<a;++i)u[s++]=e[i];for(t=o.RawInflate.MaxBackwardLength,n=this.op;t<n;++t)u[s++]=c[t];return this.blocks=[],this.buffer=u,this.buffer},o.RawInflate.prototype.concatBufferDynamic=function(){var e,t=this.op;return r?this.resize?(e=new Uint8Array(t)).set(this.output.subarray(0,t)):e=this.output.subarray(0,t):(this.output.length>t&&(this.output.length=t),e=this.output),this.buffer=e,this.buffer};var f,p,d,g,m,v;u=o.Huffman.buildHuffmanTable;o.RawInflateStream=function(e,t,n){this.blocks=[],this.bufferSize=n||ZLIB_STREAM_RAW_INFLATE_BUFFER_SIZE,this.totalpos=0,this.ip=void 0===t?0:t,this.bitsbuf=0,this.bitsbuflen=0,this.input=r?new Uint8Array(e):e,this.output=new(r?Uint8Array:Array)(this.bufferSize),this.op=0,this.bfinal=!1,this.blockLength,this.resize=!1,this.litlenTable,this.distTable,this.sp=0,this.status=o.RawInflateStream.Status.INITIALIZED,this.ip_,this.bitsbuflen_,this.bitsbuf_},o.RawInflateStream.BlockType={UNCOMPRESSED:0,FIXED:1,DYNAMIC:2},o.RawInflateStream.Status={INITIALIZED:0,BLOCK_HEADER_START:1,BLOCK_HEADER_END:2,BLOCK_BODY_START:3,BLOCK_BODY_END:4,DECODE_BLOCK_START:5,DECODE_BLOCK_END:6},o.RawInflateStream.prototype.decompress=function(e,t){var n=!1;for(void 0!==e&&(this.input=e),void 0!==t&&(this.ip=t);!n;)switch(this.status){case o.RawInflateStream.Status.INITIALIZED:case o.RawInflateStream.Status.BLOCK_HEADER_START:this.readBlockHeader()<0&&(n=!0);break;case o.RawInflateStream.Status.BLOCK_HEADER_END:case o.RawInflateStream.Status.BLOCK_BODY_START:switch(this.currentBlockType){case o.RawInflateStream.BlockType.UNCOMPRESSED:this.readUncompressedBlockHeader()<0&&(n=!0);break;case o.RawInflateStream.BlockType.FIXED:this.parseFixedHuffmanBlock()<0&&(n=!0);break;case o.RawInflateStream.BlockType.DYNAMIC:this.parseDynamicHuffmanBlock()<0&&(n=!0)}break;case o.RawInflateStream.Status.BLOCK_BODY_END:case o.RawInflateStream.Status.DECODE_BLOCK_START:switch(this.currentBlockType){case o.RawInflateStream.BlockType.UNCOMPRESSED:this.parseUncompressedBlock()<0&&(n=!0);break;case o.RawInflateStream.BlockType.FIXED:case o.RawInflateStream.BlockType.DYNAMIC:this.decodeHuffman()<0&&(n=!0)}break;case o.RawInflateStream.Status.DECODE_BLOCK_END:this.bfinal?n=!0:this.status=o.RawInflateStream.Status.INITIALIZED}return this.concatBuffer()},o.RawInflateStream.MaxBackwardLength=32768,o.RawInflateStream.MaxCopyLength=258,o.RawInflateStream.Order=(f=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],r?new Uint16Array(f):f),o.RawInflateStream.LengthCodeTable=(p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],r?new Uint16Array(p):p),o.RawInflateStream.LengthExtraTable=(d=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],r?new Uint8Array(d):d),o.RawInflateStream.DistCodeTable=(g=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],r?new Uint16Array(g):g),o.RawInflateStream.DistExtraTable=(m=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],r?new Uint8Array(m):m),o.RawInflateStream.FixedLiteralLengthTable=function(){var e,t,n=new(r?Uint8Array:Array)(288);for(e=0,t=n.length;e<t;++e)n[e]=e<=143?8:e<=255?9:e<=279?7:8;return u(n)}(),o.RawInflateStream.FixedDistanceTable=function(){var e,t,n=new(r?Uint8Array:Array)(30);for(e=0,t=n.length;e<t;++e)n[e]=5;return u(n)}(),o.RawInflateStream.prototype.readBlockHeader=function(){var e;if(this.status=o.RawInflateStream.Status.BLOCK_HEADER_START,this.save_(),(e=this.readBits(3))<0)return this.restore_(),-1;switch(1&e&&(this.bfinal=!0),e>>>=1){case 0:this.currentBlockType=o.RawInflateStream.BlockType.UNCOMPRESSED;break;case 1:this.currentBlockType=o.RawInflateStream.BlockType.FIXED;break;case 2:this.currentBlockType=o.RawInflateStream.BlockType.DYNAMIC;break;default:throw new Error("unknown BTYPE: "+e)}this.status=o.RawInflateStream.Status.BLOCK_HEADER_END},o.RawInflateStream.prototype.readBits=function(e){for(var t,n=this.bitsbuf,i=this.bitsbuflen,r=this.input,o=this.ip;i<e;){if(r.length<=o)return-1;n|=(t=r[o++])<<i,i+=8}return t=n&(1<<e)-1,n>>>=e,i-=e,this.bitsbuf=n,this.bitsbuflen=i,this.ip=o,t},o.RawInflateStream.prototype.readCodeByTable=function(e){for(var t,n,i=this.bitsbuf,r=this.bitsbuflen,o=this.input,a=this.ip,s=e[0],l=e[1];r<l;){if(o.length<=a)return-1;i|=o[a++]<<r,r+=8}if((n=(t=s[i&(1<<l)-1])>>>16)>r)throw new Error("invalid code length: "+n);return this.bitsbuf=i>>n,this.bitsbuflen=r-n,this.ip=a,65535&t},o.RawInflateStream.prototype.readUncompressedBlockHeader=function(){var e,t=this.input,n=this.ip;if(this.status=o.RawInflateStream.Status.BLOCK_BODY_START,n+4>=t.length)return-1;if((e=t[n++]|t[n++]<<8)===~(t[n++]|t[n++]<<8))throw new Error("invalid uncompressed block header: length verify");this.bitsbuf=0,this.bitsbuflen=0,this.ip=n,this.blockLength=e,this.status=o.RawInflateStream.Status.BLOCK_BODY_END},o.RawInflateStream.prototype.parseUncompressedBlock=function(){var e=this.input,t=this.ip,n=this.output,i=this.op,r=this.blockLength;for(this.status=o.RawInflateStream.Status.DECODE_BLOCK_START;r--;){if(i===n.length&&(n=this.expandBuffer({fixRatio:2})),t>=e.length)return this.ip=t,this.op=i,this.blockLength=r+1,-1;n[i++]=e[t++]}return r<0&&(this.status=o.RawInflateStream.Status.DECODE_BLOCK_END),this.ip=t,this.op=i,0},o.RawInflateStream.prototype.parseFixedHuffmanBlock=function(){return this.status=o.RawInflateStream.Status.BLOCK_BODY_START,this.litlenTable=o.RawInflateStream.FixedLiteralLengthTable,this.distTable=o.RawInflateStream.FixedDistanceTable,this.status=o.RawInflateStream.Status.BLOCK_BODY_END,0},o.RawInflateStream.prototype.save_=function(){this.ip_=this.ip,this.bitsbuflen_=this.bitsbuflen,this.bitsbuf_=this.bitsbuf},o.RawInflateStream.prototype.restore_=function(){this.ip=this.ip_,this.bitsbuflen=this.bitsbuflen_,this.bitsbuf=this.bitsbuf_},o.RawInflateStream.prototype.parseDynamicHuffmanBlock=function(){var e,t,n,i,a=new(r?Uint8Array:Array)(o.RawInflateStream.Order.length);if(this.status=o.RawInflateStream.Status.BLOCK_BODY_START,this.save_(),e=this.readBits(5)+257,t=this.readBits(5)+1,n=this.readBits(4)+4,e<0||t<0||n<0)return this.restore_(),-1;try{(function(){var s,l,c,h,f,p,d=0;for(f=0;f<n;++f){if((s=this.readBits(3))<0)throw new Error("not enough input");a[o.RawInflateStream.Order[f]]=s}for(i=u(a),h=new(r?Uint8Array:Array)(e+t),f=0,p=e+t;f<p;){if((l=this.readCodeByTable(i))<0)throw new Error("not enough input");switch(l){case 16:if((s=this.readBits(2))<0)throw new Error("not enough input");for(c=3+s;c--;)h[f++]=d;break;case 17:if((s=this.readBits(3))<0)throw new Error("not enough input");for(c=3+s;c--;)h[f++]=0;d=0;break;case 18:if((s=this.readBits(7))<0)throw new Error("not enough input");for(c=11+s;c--;)h[f++]=0;d=0;break;default:h[f++]=l,d=l}}new(r?Uint8Array:Array)(e),new(r?Uint8Array:Array)(t),this.litlenTable=u(r?h.subarray(0,e):h.slice(0,e)),this.distTable=u(r?h.subarray(e):h.slice(e))}).call(this)}catch(e){return this.restore_(),-1}return this.status=o.RawInflateStream.Status.BLOCK_BODY_END,0},o.RawInflateStream.prototype.decodeHuffman=function(){var e,t,n,i,r,a=this.output,s=this.op,l=this.litlenTable,c=this.distTable,h=a.length;for(this.status=o.RawInflateStream.Status.DECODE_BLOCK_START;;){if(this.save_(),(e=this.readCodeByTable(l))<0)return this.op=s,this.restore_(),-1;if(256===e)break;if(e<256)s===h&&(h=(a=this.expandBuffer()).length),a[s++]=e;else{if(t=e-257,i=o.RawInflateStream.LengthCodeTable[t],o.RawInflateStream.LengthExtraTable[t]>0){if((r=this.readBits(o.RawInflateStream.LengthExtraTable[t]))<0)return this.op=s,this.restore_(),-1;i+=r}if((e=this.readCodeByTable(c))<0)return this.op=s,this.restore_(),-1;if(n=o.RawInflateStream.DistCodeTable[e],o.RawInflateStream.DistExtraTable[e]>0){if((r=this.readBits(o.RawInflateStream.DistExtraTable[e]))<0)return this.op=s,this.restore_(),-1;n+=r}for(s+i>=h&&(h=(a=this.expandBuffer()).length);i--;)a[s]=a[s++-n];if(this.ip===this.input.length)return this.op=s,-1}}for(;this.bitsbuflen>=8;)this.bitsbuflen-=8,this.ip--;this.op=s,this.status=o.RawInflateStream.Status.DECODE_BLOCK_END},o.RawInflateStream.prototype.expandBuffer=function(e){var t,n,i,o=this.input.length/this.ip+1|0,a=this.input,s=this.output;return e&&("number"==typeof e.fixRatio&&(o=e.fixRatio),"number"==typeof e.addRatio&&(o+=e.addRatio)),n=o<2?(i=(a.length-this.ip)/this.litlenTable[2]/2*258|0)<s.length?s.length+i:s.length<<1:s.length*o,r?(t=new Uint8Array(n)).set(s):t=s,this.output=t,this.output},o.RawInflateStream.prototype.concatBuffer=function(){var e,t,n=this.op;return e=this.resize?r?new Uint8Array(this.output.subarray(this.sp,n)):this.output.slice(this.sp,n):r?this.output.subarray(this.sp,n):this.output.slice(this.sp,n),this.sp=n,n>o.RawInflateStream.MaxBackwardLength+this.bufferSize&&(this.op=this.sp=o.RawInflateStream.MaxBackwardLength,r?(t=this.output,this.output=new Uint8Array(this.bufferSize+o.RawInflateStream.MaxBackwardLength),this.output.set(t.subarray(n-o.RawInflateStream.MaxBackwardLength,n))):this.output=this.output.slice(n-o.RawInflateStream.MaxBackwardLength)),e},o.Inflate=function(e,t){var n,i;switch(this.input=e,this.ip=0,this.rawinflate,this.verify,!t&&(t={})||(t.index&&(this.ip=t.index),t.verify&&(this.verify=t.verify)),n=e[this.ip++],i=e[this.ip++],15&n){case o.CompressionMethod.DEFLATE:this.method=o.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((n<<8)+i)%31!=0)throw new Error("invalid fcheck flag:"+((n<<8)+i)%31);if(32&i)throw new Error("fdict flag is not supported");this.rawinflate=new o.RawInflate(e,{index:this.ip,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})},o.Inflate.BufferType=o.RawInflate.BufferType,o.Inflate.prototype.decompress=function(){var e,t=this.input;if(e=this.rawinflate.decompress(),this.ip=this.rawinflate.ip,this.verify&&(t[this.ip++]<<24|t[this.ip++]<<16|t[this.ip++]<<8|t[this.ip++])>>>0!==o.Adler32(e))throw new Error("invalid adler-32 checksum");return e},o.InflateStream=function(e){this.input=void 0===e?new(r?Uint8Array:Array):e,this.ip=0,this.rawinflate=new o.RawInflateStream(this.input,this.ip),this.method,this.output=this.rawinflate.output},o.InflateStream.prototype.decompress=function(e){var t;if(void 0!==e)if(r){var n=new Uint8Array(this.input.length+e.length);n.set(this.input,0),n.set(e,this.input.length),this.input=n}else this.input=this.input.concat(e);return void 0===this.method&&this.readHeader()<0?new(r?Uint8Array:Array):(t=this.rawinflate.decompress(this.input,this.ip),0!==this.rawinflate.ip&&(this.input=r?this.input.subarray(this.rawinflate.ip):this.input.slice(this.rawinflate.ip),this.ip=0),t)},o.InflateStream.prototype.readHeader=function(){var e=this.ip,t=this.input,n=t[e++],i=t[e++];if(void 0===n||void 0===i)return-1;switch(15&n){case o.CompressionMethod.DEFLATE:this.method=o.CompressionMethod.DEFLATE;break;default:throw new Error("unsupported compression method")}if(((n<<8)+i)%31!=0)throw new Error("invalid fcheck flag:"+((n<<8)+i)%31);if(32&i)throw new Error("fdict flag is not supported");this.ip=e},o.Gunzip=function(e,t){this.input=e,this.ip=0,this.member=[],this.decompressed=!1},o.Gunzip.prototype.getMembers=function(){return this.decompressed||this.decompress(),this.member.slice()},o.Gunzip.prototype.decompress=function(){for(var e=this.input.length;this.ip<e;)this.decodeMember();return this.decompressed=!0,this.concatMember()},o.Gunzip.prototype.decodeMember=function(){var e,t,n,i,r,a,s,l,c,h=new o.GunzipMember,u=this.input,f=this.ip;if(h.id1=u[f++],h.id2=u[f++],31!==h.id1||139!==h.id2)throw new Error("invalid file signature:"+h.id1+","+h.id2);switch(h.cm=u[f++],h.cm){case 8:break;default:throw new Error("unknown compression method: "+h.cm)}if(h.flg=u[f++],l=u[f++]|u[f++]<<8|u[f++]<<16|u[f++]<<24,h.mtime=new Date(1e3*l),h.xfl=u[f++],h.os=u[f++],(h.flg&o.Gzip.FlagsMask.FEXTRA)>0&&(h.xlen=u[f++]|u[f++]<<8,f=this.decodeSubField(f,h.xlen)),(h.flg&o.Gzip.FlagsMask.FNAME)>0){for(s=[],a=0;(r=u[f++])>0;)s[a++]=String.fromCharCode(r);h.name=s.join("")}if((h.flg&o.Gzip.FlagsMask.FCOMMENT)>0){for(s=[],a=0;(r=u[f++])>0;)s[a++]=String.fromCharCode(r);h.comment=s.join("")}if((h.flg&o.Gzip.FlagsMask.FHCRC)>0&&(h.crc16=65535&o.CRC32.calc(u,0,f),h.crc16!==(u[f++]|u[f++]<<8)))throw new Error("invalid header crc16");if(e=u[u.length-4]|u[u.length-3]<<8|u[u.length-2]<<16|u[u.length-1]<<24,u.length-f-4-4<512*e&&(i=e),t=new o.RawInflate(u,{index:f,bufferSize:i}),h.data=n=t.decompress(),f=t.ip,h.crc32=c=(u[f++]|u[f++]<<8|u[f++]<<16|u[f++]<<24)>>>0,o.CRC32.calc(n)!==c)throw new Error("invalid CRC-32 checksum: 0x"+o.CRC32.calc(n).toString(16)+" / 0x"+c.toString(16));if(h.isize=e=(u[f++]|u[f++]<<8|u[f++]<<16|u[f++]<<24)>>>0,(4294967295&n.length)!==e)throw new Error("invalid input size: "+(4294967295&n.length)+" / "+e);this.member.push(h),this.ip=f},o.Gunzip.prototype.decodeSubField=function(e,t){return e+t},o.Gunzip.prototype.concatMember=function(){var e,t,n,i=this.member,o=0,a=0;for(e=0,t=i.length;e<t;++e)a+=i[e].data.length;if(r)for(n=new Uint8Array(a),e=0;e<t;++e)n.set(i[e].data,o),o+=i[e].data.length;else{for(n=[],e=0;e<t;++e)n[e]=i[e].data;n=Array.prototype.concat.apply([],n)}return n},o.GunzipMember=function(){this.id1,this.id2,this.cm,this.flg,this.mtime,this.xfl,this.os,this.crc16,this.xlen,this.crc32,this.isize,this.name,this.comment,this.data},o.GunzipMember.prototype.getName=function(){return this.name},o.GunzipMember.prototype.getData=function(){return this.data},o.GunzipMember.prototype.getMtime=function(){return this.mtime},o.Gzip=function(e,t){this.input=e,this.ip=0,this.output,this.op=0,this.flags={},this.filename,this.comment,this.deflateOptions,t&&(t.flags&&(this.flags=t.flags),"string"==typeof t.filename&&(this.filename=t.filename),"string"==typeof t.comment&&(this.comment=t.comment),t.deflateOptions&&(this.deflateOptions=t.deflateOptions)),this.deflateOptions||(this.deflateOptions={})},o.Gzip.DefaultBufferSize=32768,o.Gzip.prototype.compress=function(){var e,t,n,i,a,s,l,c,h=new(r?Uint8Array:Array)(o.Gzip.DefaultBufferSize),u=0,f=this.input,p=this.ip,d=this.filename,g=this.comment;if(h[u++]=31,h[u++]=139,h[u++]=8,e=0,this.flags.fname&&(e|=o.Gzip.FlagsMask.FNAME),this.flags.fcomment&&(e|=o.Gzip.FlagsMask.FCOMMENT),this.flags.fhcrc&&(e|=o.Gzip.FlagsMask.FHCRC),h[u++]=e,t=(Date.now?Date.now():+new Date)/1e3|0,h[u++]=255&t,h[u++]=t>>>8&255,h[u++]=t>>>16&255,h[u++]=t>>>24&255,h[u++]=0,h[u++]=o.Gzip.OperatingSystem.UNKNOWN,void 0!==this.flags.fname){for(l=0,c=d.length;l<c;++l)(s=d.charCodeAt(l))>255&&(h[u++]=s>>>8&255),h[u++]=255&s;h[u++]=0}if(this.flags.comment){for(l=0,c=g.length;l<c;++l)(s=g.charCodeAt(l))>255&&(h[u++]=s>>>8&255),h[u++]=255&s;h[u++]=0}return this.flags.fhcrc&&(n=65535&o.CRC32.calc(h,0,u),h[u++]=255&n,h[u++]=n>>>8&255),this.deflateOptions.outputBuffer=h,this.deflateOptions.outputIndex=u,h=(a=new o.RawDeflate(f,this.deflateOptions)).compress(),u=a.op,r&&(u+8>h.buffer.byteLength?(this.output=new Uint8Array(u+8),this.output.set(new Uint8Array(h.buffer)),h=this.output):h=new Uint8Array(h.buffer)),i=o.CRC32.calc(f),h[u++]=255&i,h[u++]=i>>>8&255,h[u++]=i>>>16&255,h[u++]=i>>>24&255,c=f.length,h[u++]=255&c,h[u++]=c>>>8&255,h[u++]=c>>>16&255,h[u++]=c>>>24&255,this.ip=p,r&&u<h.length&&(this.output=h=h.subarray(0,u)),h},o.Gzip.OperatingSystem={FAT:0,AMIGA:1,VMS:2,UNIX:3,VM_CMS:4,ATARI_TOS:5,HPFS:6,MACINTOSH:7,Z_SYSTEM:8,CP_M:9,TOPS_20:10,NTFS:11,QDOS:12,ACORN_RISCOS:13,UNKNOWN:255},o.Gzip.FlagsMask={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},o.Heap=function(e){this.buffer=new(r?Uint16Array:Array)(2*e),this.length=0},o.Heap.prototype.getParent=function(e){return 2*((e-2)/4|0)},o.Heap.prototype.getChild=function(e){return 2*e+2},o.Heap.prototype.push=function(e,t){var n,i,r,o=this.buffer;for(n=this.length,o[this.length++]=t,o[this.length++]=e;n>0&&(i=this.getParent(n),o[n]>o[i]);)r=o[n],o[n]=o[i],o[i]=r,r=o[n+1],o[n+1]=o[i+1],o[i+1]=r,n=i;return this.length},o.Heap.prototype.pop=function(){var e,t,n,i,r,o=this.buffer;for(t=o[0],e=o[1],this.length-=2,o[0]=o[this.length],o[1]=o[this.length+1],r=0;!((i=this.getChild(r))>=this.length)&&(i+2<this.length&&o[i+2]>o[i]&&(i+=2),o[i]>o[r]);)n=o[r],o[r]=o[i],o[i]=n,n=o[r+1],o[r+1]=o[i+1],o[i+1]=n,r=i;return{index:e,value:t,length:this.length}},o.RawDeflate=function(e,t){this.compressionType=o.RawDeflate.CompressionType.DYNAMIC,this.lazy=0,this.freqsLitLen,this.freqsDist,this.input=r&&e instanceof Array?new Uint8Array(e):e,this.output,this.op=0,t&&(t.lazy&&(this.lazy=t.lazy),"number"==typeof t.compressionType&&(this.compressionType=t.compressionType),t.outputBuffer&&(this.output=r&&t.outputBuffer instanceof Array?new Uint8Array(t.outputBuffer):t.outputBuffer),"number"==typeof t.outputIndex&&(this.op=t.outputIndex)),this.output||(this.output=new(r?Uint8Array:Array)(32768))},o.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3},o.RawDeflate.Lz77MinLength=3,o.RawDeflate.Lz77MaxLength=258,o.RawDeflate.WindowSize=32768,o.RawDeflate.MaxCodeLength=16,o.RawDeflate.HUFMAX=286,o.RawDeflate.FixedHuffmanTable=function(){var e,t=[];for(e=0;e<288;e++)switch(!0){case e<=143:t.push([e+48,8]);break;case e<=255:t.push([e-144+400,9]);break;case e<=279:t.push([e-256+0,7]);break;case e<=287:t.push([e-280+192,8]);break;default:throw"invalid literal: "+e}return t}(),o.RawDeflate.prototype.compress=function(){var e,t,n,i=this.input;switch(this.compressionType){case o.RawDeflate.CompressionType.NONE:for(t=0,n=i.length;t<n;)t+=(e=r?i.subarray(t,t+65535):i.slice(t,t+65535)).length,this.makeNocompressBlock(e,t===n);break;case o.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(i,!0),this.op=this.output.length;break;case o.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(i,!0),this.op=this.output.length;break;default:throw"invalid compression type"}return this.output},o.RawDeflate.prototype.makeNocompressBlock=function(e,t){var n,i,a,s,l,c,h=this.output,u=this.op;if(r){for(h=new Uint8Array(this.output.buffer);h.length<=u+e.length+5;)h=new Uint8Array(h.length<<1);h.set(this.output)}if(n=t?1:0,i=o.RawDeflate.CompressionType.NONE,h[u++]=n|i<<1,s=65536+~(a=e.length)&65535,h[u++]=255&a,h[u++]=a>>>8&255,h[u++]=255&s,h[u++]=s>>>8&255,r)h.set(e,u),u+=e.length,h=h.subarray(0,u);else{for(l=0,c=e.length;l<c;++l)h[u++]=e[l];h.length=u}return this.op=u,this.output=h,h},o.RawDeflate.prototype.makeFixedHuffmanBlock=function(e,t){var n,i,a,s=new o.BitStream(r?new Uint8Array(this.output.buffer):this.output,this.op);return n=t?1:0,i=o.RawDeflate.CompressionType.FIXED,s.writeBits(n,1,!0),s.writeBits(i,2,!0),a=this.lz77(e),this.fixedHuffman(a,s),s.finish()},o.RawDeflate.prototype.makeDynamicHuffmanBlock=function(e,t){var n,i,a,s,l,c,h,u,f,p,d,g,m,v,y,w,b,x=new o.BitStream(r?new Uint8Array(this.output.buffer):this.output,this.op),k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(19);for(n=t?1:0,i=o.RawDeflate.CompressionType.DYNAMIC,x.writeBits(n,1,!0),x.writeBits(i,2,!0),a=this.lz77(e),h=this.getLengths_(this.freqsLitLen,15),u=this.getCodesFromLengths_(h),f=this.getLengths_(this.freqsDist,7),p=this.getCodesFromLengths_(f),s=286;s>257&&0===h[s-1];s--);for(l=30;l>1&&0===f[l-1];l--);for(d=this.getTreeSymbols_(s,h,l,f),g=this.getLengths_(d.freqs,7),w=0;w<19;w++)S[w]=g[k[w]];for(c=19;c>4&&0===S[c-1];c--);for(m=this.getCodesFromLengths_(g),x.writeBits(s-257,5,!0),x.writeBits(l-1,5,!0),x.writeBits(c-4,4,!0),w=0;w<c;w++)x.writeBits(S[w],3,!0);for(w=0,b=d.codes.length;w<b;w++)if(v=d.codes[w],x.writeBits(m[v],g[v],!0),v>=16){switch(w++,v){case 16:y=2;break;case 17:y=3;break;case 18:y=7;break;default:throw"invalid code: "+v}x.writeBits(d.codes[w],y,!0)}return this.dynamicHuffman(a,[u,h],[p,f],x),x.finish()},o.RawDeflate.prototype.dynamicHuffman=function(e,t,n,i){var r,o,a,s,l,c,h,u;for(l=t[0],c=t[1],h=n[0],u=n[1],r=0,o=e.length;r<o;++r)if(a=e[r],i.writeBits(l[a],c[a],!0),a>256)i.writeBits(e[++r],e[++r],!0),s=e[++r],i.writeBits(h[s],u[s],!0),i.writeBits(e[++r],e[++r],!0);else if(256===a)break;return i},o.RawDeflate.prototype.fixedHuffman=function(e,t){var n,i,r;for(n=0,i=e.length;n<i;n++)if(r=e[n],o.BitStream.prototype.writeBits.apply(t,o.RawDeflate.FixedHuffmanTable[r]),r>256)t.writeBits(e[++n],e[++n],!0),t.writeBits(e[++n],5),t.writeBits(e[++n],e[++n],!0);else if(256===r)break;return t},o.RawDeflate.Lz77Match=function(e,t){this.length=e,this.backwardDistance=t},o.RawDeflate.Lz77Match.LengthCodeTable=(v=function(){var e,t,n=[];for(e=3;e<=258;e++)t=i(e),n[e]=t[2]<<24|t[1]<<16|t[0];function i(e){switch(!0){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case e<=12:return[265,e-11,1];case e<=14:return[266,e-13,1];case e<=16:return[267,e-15,1];case e<=18:return[268,e-17,1];case e<=22:return[269,e-19,2];case e<=26:return[270,e-23,2];case e<=30:return[271,e-27,2];case e<=34:return[272,e-31,2];case e<=42:return[273,e-35,3];case e<=50:return[274,e-43,3];case e<=58:return[275,e-51,3];case e<=66:return[276,e-59,3];case e<=82:return[277,e-67,4];case e<=98:return[278,e-83,4];case e<=114:return[279,e-99,4];case e<=130:return[280,e-115,4];case e<=162:return[281,e-131,5];case e<=194:return[282,e-163,5];case e<=226:return[283,e-195,5];case e<=257:return[284,e-227,5];case 258===e:return[285,e-258,0];default:throw"invalid length: "+e}}return n}(),r?new Uint32Array(v):v),o.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(e){var t;switch(!0){case 1===e:t=[0,e-1,0];break;case 2===e:t=[1,e-2,0];break;case 3===e:t=[2,e-3,0];break;case 4===e:t=[3,e-4,0];break;case e<=6:t=[4,e-5,1];break;case e<=8:t=[5,e-7,1];break;case e<=12:t=[6,e-9,2];break;case e<=16:t=[7,e-13,2];break;case e<=24:t=[8,e-17,3];break;case e<=32:t=[9,e-25,3];break;case e<=48:t=[10,e-33,4];break;case e<=64:t=[11,e-49,4];break;case e<=96:t=[12,e-65,5];break;case e<=128:t=[13,e-97,5];break;case e<=192:t=[14,e-129,6];break;case e<=256:t=[15,e-193,6];break;case e<=384:t=[16,e-257,7];break;case e<=512:t=[17,e-385,7];break;case e<=768:t=[18,e-513,8];break;case e<=1024:t=[19,e-769,8];break;case e<=1536:t=[20,e-1025,9];break;case e<=2048:t=[21,e-1537,9];break;case e<=3072:t=[22,e-2049,10];break;case e<=4096:t=[23,e-3073,10];break;case e<=6144:t=[24,e-4097,11];break;case e<=8192:t=[25,e-6145,11];break;case e<=12288:t=[26,e-8193,12];break;case e<=16384:t=[27,e-12289,12];break;case e<=24576:t=[28,e-16385,13];break;case e<=32768:t=[29,e-24577,13];break;default:throw"invalid distance"}return t},o.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var e,t=this.length,n=this.backwardDistance,i=[],r=0;return e=o.RawDeflate.Lz77Match.LengthCodeTable[t],i[r++]=65535&e,i[r++]=e>>16&255,i[r++]=e>>24,e=this.getDistanceCode_(n),i[r++]=e[0],i[r++]=e[1],i[r++]=e[2],i},o.RawDeflate.prototype.lz77=function(e){var t,n,i,a,s,l,c,h,u,f={},p=o.RawDeflate.WindowSize,d=r?new Uint16Array(2*e.length):[],g=0,m=0,v=new(r?Uint32Array:Array)(286),y=new(r?Uint32Array:Array)(30),w=this.lazy;if(!r){for(i=0;i<=285;)v[i++]=0;for(i=0;i<=29;)y[i++]=0}function b(e,t){var n,i,r=e.toLz77Array();for(n=0,i=r.length;n<i;++n)d[g++]=r[n];v[r[0]]++,y[r[3]]++,m=e.length+t-1,h=null}for(v[256]=1,t=0,n=e.length;t<n;++t){for(s=0,i=0,a=o.RawDeflate.Lz77MinLength;i<a&&t+i!==n;++i)s=s<<8|e[t+i];if(void 0===f[s]&&(f[s]=[]),l=f[s],m-- >0)l.push(t);else{for(;l.length>0&&t-l[0]>p;)l.shift();if(t+o.RawDeflate.Lz77MinLength>=n){for(h&&b(h,-1),i=0,a=n-t;i<a;++i)u=e[t+i],d[g++]=u,++v[u];break}l.length>0?(c=this.searchLongestMatch_(e,t,l),h?h.length<c.length?(u=e[t-1],d[g++]=u,++v[u],b(c,0)):b(h,-1):c.length<w?h=c:b(c,0)):h?b(h,-1):(u=e[t],d[g++]=u,++v[u]),l.push(t)}}return d[g++]=256,v[256]++,this.freqsLitLen=v,this.freqsDist=y,r?d.subarray(0,g):d},o.RawDeflate.prototype.searchLongestMatch_=function(e,t,n){var i,r,a,s,l,c,h=0,u=e.length;e:for(s=0,c=n.length;s<c;s++){if(i=n[c-s-1],a=o.RawDeflate.Lz77MinLength,h>o.RawDeflate.Lz77MinLength){for(l=h;l>o.RawDeflate.Lz77MinLength;l--)if(e[i+l-1]!==e[t+l-1])continue e;a=h}for(;a<o.RawDeflate.Lz77MaxLength&&t+a<u&&e[i+a]===e[t+a];)++a;if(a>h&&(r=i,h=a),a===o.RawDeflate.Lz77MaxLength)break}return new o.RawDeflate.Lz77Match(h,t-r)},o.RawDeflate.prototype.getTreeSymbols_=function(e,t,n,i){var o,a,s,l,c,h,u=new(r?Uint32Array:Array)(e+n),f=new(r?Uint32Array:Array)(316),p=new(r?Uint8Array:Array)(19);for(a=0,o=0;o<e;o++)u[a++]=t[o];for(o=0;o<n;o++)u[a++]=i[o];if(!r)for(o=0,l=p.length;o<l;++o)p[o]=0;for(c=0,o=0,l=u.length;o<l;o+=a){for(a=1;o+a<l&&u[o+a]===u[o];++a);if(s=a,0===u[o])if(s<3)for(;s-- >0;)f[c++]=0,p[0]++;else for(;s>0;)(h=s<138?s:138)>s-3&&h<s&&(h=s-3),h<=10?(f[c++]=17,f[c++]=h-3,p[17]++):(f[c++]=18,f[c++]=h-11,p[18]++),s-=h;else if(f[c++]=u[o],p[u[o]]++,--s<3)for(;s-- >0;)f[c++]=u[o],p[u[o]]++;else for(;s>0;)(h=s<6?s:6)>s-3&&h<s&&(h=s-3),f[c++]=16,f[c++]=h-3,p[16]++,s-=h}return{codes:r?f.subarray(0,c):f.slice(0,c),freqs:p}},o.RawDeflate.prototype.getLengths_=function(e,t){var n,i,a,s,l,c=e.length,h=new o.Heap(2*o.RawDeflate.HUFMAX),u=new(r?Uint8Array:Array)(c);if(!r)for(s=0;s<c;s++)u[s]=0;for(s=0;s<c;++s)e[s]>0&&h.push(s,e[s]);if(n=new Array(h.length/2),i=new(r?Uint32Array:Array)(h.length/2),1===n.length)return u[h.pop().index]=1,u;for(s=0,l=h.length/2;s<l;++s)n[s]=h.pop(),i[s]=n[s].value;for(a=this.reversePackageMerge_(i,i.length,t),s=0,l=n.length;s<l;++s)u[n[s].index]=a[s];return u},o.RawDeflate.prototype.reversePackageMerge_=function(e,t,n){var i,o,a,s,l,c=new(r?Uint16Array:Array)(n),h=new(r?Uint8Array:Array)(n),u=new(r?Uint8Array:Array)(t),f=new Array(n),p=new Array(n),d=new Array(n),g=(1<<n)-t,m=1<<n-1;function v(e){var n=p[e][d[e]];n===t?(v(e+1),v(e+1)):--u[n],++d[e]}for(c[n-1]=t,o=0;o<n;++o)g<m?h[o]=0:(h[o]=1,g-=m),g<<=1,c[n-2-o]=(c[n-1-o]/2|0)+t;for(c[0]=h[0],f[0]=new Array(c[0]),p[0]=new Array(c[0]),o=1;o<n;++o)c[o]>2*c[o-1]+h[o]&&(c[o]=2*c[o-1]+h[o]),f[o]=new Array(c[o]),p[o]=new Array(c[o]);for(i=0;i<t;++i)u[i]=n;for(a=0;a<c[n-1];++a)f[n-1][a]=e[a],p[n-1][a]=a;for(i=0;i<n;++i)d[i]=0;for(1===h[n-1]&&(--u[0],++d[n-1]),o=n-2;o>=0;--o){for(i=0,s=0,l=d[o+1],a=0;a<c[o];a++)(s=f[o+1][l]+f[o+1][l+1])>e[i]?(f[o][a]=s,p[o][a]=t,l+=2):(f[o][a]=e[i],p[o][a]=i,++i);d[o]=0,1===h[o]&&v(o)}return u},o.RawDeflate.prototype.getCodesFromLengths_=function(e){var t,n,i,a,s=new(r?Uint16Array:Array)(e.length),l=[],c=[],h=0;for(t=0,n=e.length;t<n;t++)l[e[t]]=1+(0|l[e[t]]);for(t=1,n=o.RawDeflate.MaxCodeLength;t<=n;t++)c[t]=h,h+=0|l[t],h<<=1;for(t=0,n=e.length;t<n;t++)for(h=c[e[t]],c[e[t]]+=1,s[t]=0,i=0,a=e[t];i<a;i++)s[t]=s[t]<<1|1&h,h>>>=1;return s},o.Unzip=function(e,t){t=t||{},this.input=r&&e instanceof Array?new Uint8Array(e):e,this.ip=0,this.eocdrOffset,this.numberOfThisDisk,this.startDisk,this.totalEntriesThisDisk,this.totalEntries,this.centralDirectorySize,this.centralDirectoryOffset,this.commentLength,this.comment,this.fileHeaderList,this.filenameToIndex,this.verify=t.verify||!1,this.password=t.password},o.Unzip.CompressionMethod=o.Zip.CompressionMethod,o.Unzip.FileHeaderSignature=o.Zip.FileHeaderSignature,o.Unzip.LocalFileHeaderSignature=o.Zip.LocalFileHeaderSignature,o.Unzip.CentralDirectorySignature=o.Zip.CentralDirectorySignature,o.Unzip.FileHeader=function(e,t){this.input=e,this.offset=t,this.length,this.version,this.os,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.fileCommentLength,this.diskNumberStart,this.internalFileAttributes,this.externalFileAttributes,this.relativeOffset,this.filename,this.extraField,this.comment},o.Unzip.FileHeader.prototype.parse=function(){var e=this.input,t=this.offset;if(e[t++]!==o.Unzip.FileHeaderSignature[0]||e[t++]!==o.Unzip.FileHeaderSignature[1]||e[t++]!==o.Unzip.FileHeaderSignature[2]||e[t++]!==o.Unzip.FileHeaderSignature[3])throw new Error("invalid file header signature");this.version=e[t++],this.os=e[t++],this.needVersion=e[t++]|e[t++]<<8,this.flags=e[t++]|e[t++]<<8,this.compression=e[t++]|e[t++]<<8,this.time=e[t++]|e[t++]<<8,this.date=e[t++]|e[t++]<<8,this.crc32=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.compressedSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.plainSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.fileNameLength=e[t++]|e[t++]<<8,this.extraFieldLength=e[t++]|e[t++]<<8,this.fileCommentLength=e[t++]|e[t++]<<8,this.diskNumberStart=e[t++]|e[t++]<<8,this.internalFileAttributes=e[t++]|e[t++]<<8,this.externalFileAttributes=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,this.relativeOffset=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.filename=String.fromCharCode.apply(null,r?e.subarray(t,t+=this.fileNameLength):e.slice(t,t+=this.fileNameLength)),this.extraField=r?e.subarray(t,t+=this.extraFieldLength):e.slice(t,t+=this.extraFieldLength),this.comment=r?e.subarray(t,t+this.fileCommentLength):e.slice(t,t+this.fileCommentLength),this.length=t-this.offset},o.Unzip.LocalFileHeader=function(e,t){this.input=e,this.offset=t,this.length,this.needVersion,this.flags,this.compression,this.time,this.date,this.crc32,this.compressedSize,this.plainSize,this.fileNameLength,this.extraFieldLength,this.filename,this.extraField},o.Unzip.LocalFileHeader.Flags=o.Zip.Flags,o.Unzip.LocalFileHeader.prototype.parse=function(){var e=this.input,t=this.offset;if(e[t++]!==o.Unzip.LocalFileHeaderSignature[0]||e[t++]!==o.Unzip.LocalFileHeaderSignature[1]||e[t++]!==o.Unzip.LocalFileHeaderSignature[2]||e[t++]!==o.Unzip.LocalFileHeaderSignature[3])throw new Error("invalid local file header signature");this.needVersion=e[t++]|e[t++]<<8,this.flags=e[t++]|e[t++]<<8,this.compression=e[t++]|e[t++]<<8,this.time=e[t++]|e[t++]<<8,this.date=e[t++]|e[t++]<<8,this.crc32=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.compressedSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.plainSize=(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)>>>0,this.fileNameLength=e[t++]|e[t++]<<8,this.extraFieldLength=e[t++]|e[t++]<<8,this.filename=String.fromCharCode.apply(null,r?e.subarray(t,t+=this.fileNameLength):e.slice(t,t+=this.fileNameLength)),this.extraField=r?e.subarray(t,t+=this.extraFieldLength):e.slice(t,t+=this.extraFieldLength),this.length=t-this.offset},o.Unzip.prototype.searchEndOfCentralDirectoryRecord=function(){var e,t=this.input;for(e=t.length-12;e>0;--e)if(t[e]===o.Unzip.CentralDirectorySignature[0]&&t[e+1]===o.Unzip.CentralDirectorySignature[1]&&t[e+2]===o.Unzip.CentralDirectorySignature[2]&&t[e+3]===o.Unzip.CentralDirectorySignature[3])return void(this.eocdrOffset=e);throw new Error("End of Central Directory Record not found")},o.Unzip.prototype.parseEndOfCentralDirectoryRecord=function(){var e,t=this.input;if(this.eocdrOffset||this.searchEndOfCentralDirectoryRecord(),e=this.eocdrOffset,t[e++]!==o.Unzip.CentralDirectorySignature[0]||t[e++]!==o.Unzip.CentralDirectorySignature[1]||t[e++]!==o.Unzip.CentralDirectorySignature[2]||t[e++]!==o.Unzip.CentralDirectorySignature[3])throw new Error("invalid signature");this.numberOfThisDisk=t[e++]|t[e++]<<8,this.startDisk=t[e++]|t[e++]<<8,this.totalEntriesThisDisk=t[e++]|t[e++]<<8,this.totalEntries=t[e++]|t[e++]<<8,this.centralDirectorySize=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.centralDirectoryOffset=(t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24)>>>0,this.commentLength=t[e++]|t[e++]<<8,this.comment=r?t.subarray(e,e+this.commentLength):t.slice(e,e+this.commentLength)},o.Unzip.prototype.parseFileHeader=function(){var e,t,n,i,r=[],a={};if(!this.fileHeaderList){for(void 0===this.centralDirectoryOffset&&this.parseEndOfCentralDirectoryRecord(),e=this.centralDirectoryOffset,n=0,i=this.totalEntries;n<i;++n)(t=new o.Unzip.FileHeader(this.input,e)).parse(),e+=t.length,r[n]=t,a[t.filename]=n;if(this.centralDirectorySize<e-this.centralDirectoryOffset)throw new Error("invalid file header size");this.fileHeaderList=r,this.filenameToIndex=a}},o.Unzip.prototype.getFileData=function(e,t){t=t||{};var n,i,a,s,l,c,h,u,f=this.input,p=this.fileHeaderList;if(p||this.parseFileHeader(),void 0===p[e])throw new Error("wrong index");if(i=p[e].relativeOffset,(n=new o.Unzip.LocalFileHeader(this.input,i)).parse(),i+=n.length,a=n.compressedSize,0!=(n.flags&o.Unzip.LocalFileHeader.Flags.ENCRYPT)){if(!t.password&&!this.password)throw new Error("please set password");for(c=this.createDecryptionKey(t.password||this.password),h=i,u=i+12;h<u;++h)this.decode(c,f[h]);for(h=i+=12,u=i+(a-=12);h<u;++h)f[h]=this.decode(c,f[h])}switch(n.compression){case o.Unzip.CompressionMethod.STORE:s=r?this.input.subarray(i,i+a):this.input.slice(i,i+a);break;case o.Unzip.CompressionMethod.DEFLATE:s=new o.RawInflate(this.input,{index:i,bufferSize:n.plainSize}).decompress();break;default:throw new Error("unknown compression type")}if(this.verify&&(l=o.CRC32.calc(s),n.crc32!==l))throw new Error("wrong crc: file=0x"+n.crc32.toString(16)+", data=0x"+l.toString(16));return s},o.Unzip.prototype.getFilenames=function(){var e,t,n,i=[];for(this.fileHeaderList||this.parseFileHeader(),e=0,t=(n=this.fileHeaderList).length;e<t;++e)i[e]=n[e].filename;return i},o.Unzip.prototype.decompress=function(e,t){var n;if(this.filenameToIndex||this.parseFileHeader(),void 0===(n=this.filenameToIndex[e]))throw new Error(e+" not found");return this.getFileData(n,t)},o.Unzip.prototype.setPassword=function(e){this.password=e},o.Unzip.prototype.decode=function(e,t){return t^=this.getByte(e),this.updateKeys(e,t),t},o.Unzip.prototype.updateKeys=o.Zip.prototype.updateKeys,o.Unzip.prototype.createDecryptionKey=o.Zip.prototype.createEncryptionKey,o.Unzip.prototype.getByte=o.Zip.prototype.getByte,o.Util.stringToByteArray=function(e){var t,n,i=e.split("");for(t=0,n=i.length;t<n;t++)i[t]=(255&i[t].charCodeAt(0))>>>0;return i},o.Adler32=function(e){return"string"==typeof e&&(e=o.Util.stringToByteArray(e)),o.Adler32.update(1,e)},o.Adler32.update=function(e,t){for(var n,i=65535&e,r=e>>>16&65535,a=t.length,s=0;a>0;){a-=n=a>o.Adler32.OptimizationParameter?o.Adler32.OptimizationParameter:a;do{r+=i+=t[s++]}while(--n);i%=65521,r%=65521}return(r<<16|i)>>>0},o.Adler32.OptimizationParameter=1024,o.BitStream=function(e,t){if(this.index="number"==typeof t?t:0,this.bitindex=0,this.buffer=e instanceof(r?Uint8Array:Array)?e:new(r?Uint8Array:Array)(o.BitStream.DefaultBlockSize),2*this.buffer.length<=this.index)throw new Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()},o.BitStream.DefaultBlockSize=32768,o.BitStream.prototype.expandBuffer=function(){var e,t=this.buffer,n=t.length,i=new(r?Uint8Array:Array)(n<<1);if(r)i.set(t);else for(e=0;e<n;++e)i[e]=t[e];return this.buffer=i},o.BitStream.prototype.writeBits=function(e,t,n){var i,r,a=this.buffer,s=this.index,l=this.bitindex,c=a[s];if(n&&t>1&&(e=t>8?(r=e,(o.BitStream.ReverseTable[255&r]<<24|o.BitStream.ReverseTable[r>>>8&255]<<16|o.BitStream.ReverseTable[r>>>16&255]<<8|o.BitStream.ReverseTable[r>>>24&255])>>32-t):o.BitStream.ReverseTable[e]>>8-t),t+l<8)c=c<<t|e,l+=t;else for(i=0;i<t;++i)c=c<<1|e>>t-i-1&1,8==++l&&(l=0,a[s++]=o.BitStream.ReverseTable[c],c=0,s===a.length&&(a=this.expandBuffer()));a[s]=c,this.buffer=a,this.bitindex=l,this.index=s},o.BitStream.prototype.finish=function(){var e,t=this.buffer,n=this.index;return this.bitindex>0&&(t[n]<<=8-this.bitindex,t[n]=o.BitStream.ReverseTable[t[n]],n++),r?e=t.subarray(0,n):(t.length=n,e=t),e},o.BitStream.ReverseTable=function(){var e,t=new(r?Uint8Array:Array)(256);for(e=0;e<256;++e)t[e]=function(e){var t=e,n=7;for(e>>>=1;e;e>>>=1)t<<=1,t|=1&e,--n;return(t<<n&255)>>>0}(e);return t}();o.CRC32.calc=function(e,t,n){return o.CRC32.update(e,0,t,n)},o.CRC32.update=function(e,t,n,i){var r=o.CRC32.Table,a="number"==typeof n?n:n=0,s="number"==typeof i?i:e.length;for(t^=4294967295,a=7&s;a--;++n)t=t>>>8^r[255&(t^e[n])];for(a=s>>3;a--;n+=8)t=(t=(t=(t=(t=(t=(t=(t=t>>>8^r[255&(t^e[n])])>>>8^r[255&(t^e[n+1])])>>>8^r[255&(t^e[n+2])])>>>8^r[255&(t^e[n+3])])>>>8^r[255&(t^e[n+4])])>>>8^r[255&(t^e[n+5])])>>>8^r[255&(t^e[n+6])])>>>8^r[255&(t^e[n+7])];return(4294967295^t)>>>0},o.CRC32.single=function(e,t){return(o.CRC32.Table[255&(e^t)]^e>>>8)>>>0},o.CRC32.Table_=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o.CRC32.Table=r?new Uint32Array(o.CRC32.Table_):o.CRC32.Table_,o.Deflate=function(e,t){this.input=e,this.output=new(r?Uint8Array:Array)(o.Deflate.DefaultBufferSize),this.compressionType=o.Deflate.CompressionType.DYNAMIC,this.rawDeflate;var n,i={};for(n in!t&&(t={})||"number"==typeof t.compressionType&&(this.compressionType=t.compressionType),t)i[n]=t[n];i.outputBuffer=this.output,this.rawDeflate=new o.RawDeflate(this.input,i)},o.Deflate.DefaultBufferSize=32768,o.Deflate.CompressionType=o.RawDeflate.CompressionType,o.Deflate.compress=function(e,t){return new o.Deflate(e,t).compress()},o.Deflate.prototype.compress=function(){var e,t,n,i,a,s,l,c=0;switch(l=this.output,e=o.CompressionMethod.DEFLATE){case o.CompressionMethod.DEFLATE:t=Math.LOG2E*Math.log(o.RawDeflate.WindowSize)-8;break;default:throw new Error("invalid compression method")}switch(n=t<<4|e,l[c++]=n,0,e){case o.CompressionMethod.DEFLATE:switch(this.compressionType){case o.Deflate.CompressionType.NONE:a=0;break;case o.Deflate.CompressionType.FIXED:a=1;break;case o.Deflate.CompressionType.DYNAMIC:a=2;break;default:throw new Error("unsupported compression type")}break;default:throw new Error("invalid compression method")}return i=a<<6|0,i|=31-(256*n+i)%31,l[c++]=i,s=o.Adler32(this.input),this.rawDeflate.op=c,c=(l=this.rawDeflate.compress()).length,r&&((l=new Uint8Array(l.buffer)).length<=c+4&&(this.output=new Uint8Array(l.length+4),this.output.set(l),l=this.output),l=l.subarray(0,c+4)),l[c++]=s>>24&255,l[c++]=s>>16&255,l[c++]=s>>8&255,l[c++]=255&s,l};var y=15,w=1440,b=15,x=0,k=0,S=1,C=-2,T=-3,_=-5,A=13,I=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],R=0,P=9,E=5,L=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],M=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],F=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function O(){}function H(){this.was=[0]}O.prototype.inflateInit=function(e,t){return e||(e=y),t&&(t=!1),this.istate=new H,this.istate.inflateInit(this,t?-e:e)},O.prototype.inflate=function(e){return null==this.istate?C:this.istate.inflate(this,e)},O.prototype.inflateEnd=function(){if(null==this.istate)return C;var e=istate.inflateEnd(this);return this.istate=null,e},O.prototype.inflateSync=function(){return istate.inflateSync(this)},O.prototype.inflateSetDictionary=function(e,t){return istate.inflateSetDictionary(this,e,t)},H.prototype.inflateReset=function(e){return null==e||null==e.istate?C:(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=0!=e.istate.nowrap?7:0,e.istate.blocks.reset(e,null),k)},H.prototype.inflateEnd=function(e){return null!=this.blocks&&this.blocks.free(e),this.blocks=null,k},H.prototype.inflateInit=function(e,t){return e.msg=null,this.blocks=null,nowrap=0,t<0&&(t=-t,nowrap=1),t<8||t>15?(this.inflateEnd(e),C):(this.wbits=t,e.istate.blocks=new G(e,0!=e.istate.nowrap?null:this,1<<t),this.inflateReset(e),k)},H.prototype.inflate=function(e,t){var n,i;if(null==e||null==e.istate||null==e.next_in)return C;for(t=4==t?_:k,n=_;;)switch(e.istate.mode){case 0:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,8!=(15&(e.istate.method=e.next_in[e.next_in_index++]))){e.istate.mode=A,e.msg="unknown compression method",e.istate.marker=5;break}if(8+(e.istate.method>>4)>e.istate.wbits){e.istate.mode=A,e.msg="invalid window size",e.istate.marker=5;break}e.istate.mode=1;case 1:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,i=255&e.next_in[e.next_in_index++],((e.istate.method<<8)+i)%31!=0){e.istate.mode=A,e.msg="incorrect header check",e.istate.marker=5;break}if(0==(32&i)){e.istate.mode=7;break}e.istate.mode=2;case 2:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=3;case 3:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=4;case 4:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=5;case 5:return 0==e.avail_in?n:(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.adler=e.istate.need,e.istate.mode=6,2);case 6:return e.istate.mode=A,e.msg="need dictionary",e.istate.marker=0,C;case 7:if((n=e.istate.blocks.proc(e,n))==T){e.istate.mode=A,e.istate.marker=0;break}if(n==k&&(n=t),n!=S)return n;if(n=t,e.istate.blocks.reset(e,e.istate.was),0!=e.istate.nowrap){e.istate.mode=12;break}e.istate.mode=8;case 8:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=9;case 9:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=10;case 10:if(0==e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=11;case 11:if(0==e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.istate.was[0]!=e.istate.need){e.istate.mode=A,e.msg="incorrect data check",e.istate.marker=5;break}e.istate.mode=12;case 12:return S;case A:return T;default:return C}},H.prototype.inflateSetDictionary=function(e,t,n){var i=0,r=n;return null==e||null==e.istate||6!=e.istate.mode?C:e._adler.adler32(1,t,0,n)!=e.adler?T:(e.adler=e._adler.adler32(0,null,0,0),r>=1<<e.istate.wbits&&(i=n-(r=(1<<e.istate.wbits)-1)),e.istate.blocks.set_dictionary(t,i,r),e.istate.mode=7,k)};var z=[0,0,255,255];H.prototype.inflateSync=function(e){var t,n,i,r,o;if(null==e||null==e.istate)return C;if(e.istate.mode!=A&&(e.istate.mode=A,e.istate.marker=0),0==(t=e.avail_in))return _;for(n=e.next_in_index,i=e.istate.marker;0!=t&&i<4;)e.next_in[n]==z[i]?i++:i=0!=e.next_in[n]?0:4-i,n++,t--;return e.total_in+=n-e.next_in_index,e.next_in_index=n,e.avail_in=t,e.istate.marker=i,4!=i?T:(r=e.total_in,o=e.total_out,this.inflateReset(e),e.total_in=r,e.total_out=o,e.istate.mode=7,k)},H.prototype.inflateSyncPoint=function(e){return null==e||null==e.istate||null==e.istate.blocks?C:e.istate.blocks.sync_point()};var $=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function G(e,t,n){this.hufts=new Int32Array(3*w),this.window=new Uint8Array(n),this.end=n,this.checkfn=t,this.mode=R,this.reset(e,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new U,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new W}G.prototype.reset=function(e,t){t&&(t[0]=this.check),6==this.mode&&this.codes.free(e),this.mode=R,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(e.adler=this.check=e._adler.adler32(0,null,0,0))},G.prototype.proc=function(e,t){var n,i,r,o,a,s,l;for(o=e.next_in_index,a=e.avail_in,i=this.bitb,r=this.bitk,l=(s=this.write)<this.read?this.read-s-1:this.end-s;;)switch(this.mode){case R:for(;r<3;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=k,a--,i|=(255&e.next_in[o++])<<r,r+=8}switch(n=7&i,this.last=1&n,n>>>1){case 0:i>>>=3,i>>>=n=7&(r-=3),r-=n,this.mode=1;break;case 1:V(f=new Int32Array(1),p=new Int32Array(1),d=[],g=[],e),this.codes.init(f[0],p[0],d[0],0,g[0],0,e),i>>>=3,r-=3,this.mode=6;break;case 2:i>>>=3,r-=3,this.mode=3;break;case 3:return i>>>=3,r-=3,this.mode=A,e.msg="invalid block type",t=T,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t)}break;case 1:for(;r<32;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=k,a--,i|=(255&e.next_in[o++])<<r,r+=8}if((~i>>>16&65535)!=(65535&i))return this.mode=A,e.msg="invalid stored block lengths",t=T,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.left=65535&i,i=r=0,this.mode=0!=this.left?2:0!=this.last?7:R;break;case 2:if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,write=s,this.inflate_flush(e,t);if(0==l&&(s==end&&0!=read&&(l=(s=0)<this.read?this.read-s-1:this.end-s),0==l&&(this.write=s,t=this.inflate_flush(e,t),l=(s=this.write)<this.read?this.read-s-1:this.end-s,s==this.end&&0!=this.read&&(l=(s=0)<this.read?this.read-s-1:this.end-s),0==l)))return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);if(t=k,(n=this.left)>a&&(n=a),n>l&&(n=l),j(e.next_in,o,window,s,n),o+=n,a-=n,s+=n,l-=n,0!=(this.left-=n))break;this.mode=0!=this.last?7:R;break;case 3:for(;r<14;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=k,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(this.table=n=16383&i,(31&n)>29||(n>>5&31)>29)return this.mode=9,e.msg="too many length or distance symbols",t=T,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);if(n=258+(31&n)+(n>>5&31),null==this.blens||this.blens.length<n)this.blens=new Int32Array(n);else for(var c=0;c<n;c++)this.blens[c]=0;i>>>=14,r-=14,this.index=0,mode=4;case 4:for(;this.index<4+(this.table>>>10);){for(;r<3;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=k,a--,i|=(255&e.next_in[o++])<<r,r+=8}this.blens[$[this.index++]]=7&i,i>>>=3,r-=3}for(;this.index<19;)this.blens[$[this.index++]]=0;if(this.bb[0]=7,(n=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,e))!=k)return(t=n)==T&&(this.blens=null,this.mode=9),this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,write=s,this.inflate_flush(e,t);this.index=0,this.mode=5;case 5:for(;n=this.table,this.index<258+(31&n)+(n>>5&31);){var h,u;for(n=this.bb[0];r<n;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=k,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(n=this.hufts[3*(this.tb[0]+(i&I[n]))+1],(u=this.hufts[3*(this.tb[0]+(i&I[n]))+2])<16)i>>>=n,r-=n,this.blens[this.index++]=u;else{for(c=18==u?7:u-14,h=18==u?11:3;r<n+c;){if(0==a)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);t=k,a--,i|=(255&e.next_in[o++])<<r,r+=8}if(r-=n,h+=(i>>>=n)&I[c],i>>>=c,r-=c,(c=this.index)+h>258+(31&(n=this.table))+(n>>5&31)||16==u&&c<1)return this.blens=null,this.mode=9,e.msg="invalid bit length repeat",t=T,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);u=16==u?this.blens[c-1]:0;do{this.blens[c++]=u}while(0!=--h);this.index=c}}this.tb[0]=-1;var f=new Int32Array(1),p=new Int32Array(1),d=new Int32Array(1),g=new Int32Array(1);if(f[0]=9,p[0]=6,n=this.table,(n=this.inftree.inflate_trees_dynamic(257+(31&n),1+(n>>5&31),this.blens,f,p,d,g,this.hufts,e))!=k)return n==T&&(this.blens=null,this.mode=A),t=n,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);this.codes.init(f[0],p[0],this.hufts,d[0],this.hufts,g[0],e),this.mode=6;case 6:if(this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,(t=this.codes.proc(this,e,t))!=S)return this.inflate_flush(e,t);if(t=k,this.codes.free(e),o=e.next_in_index,a=e.avail_in,i=this.bitb,r=this.bitk,l=(s=this.write)<this.read?this.read-s-1:this.end-s,0==this.last){this.mode=R;break}this.mode=7;case 7:if(this.write=s,t=this.inflate_flush(e,t),l=(s=this.write)<this.read?this.read-s-1:this.end-s,this.read!=this.write)return this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);mode=12;case 8:return t=S,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);case 9:return t=T,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t);default:return t=C,this.bitb=i,this.bitk=r,e.avail_in=a,e.total_in+=o-e.next_in_index,e.next_in_index=o,this.write=s,this.inflate_flush(e,t)}},G.prototype.free=function(e){this.reset(e,null),this.window=null,this.hufts=null},G.prototype.set_dictionary=function(e,t,n){j(e,t,window,0,n),this.read=this.write=n},G.prototype.sync_point=function(){return 1==this.mode},G.prototype.inflate_flush=function(e,t){var n,i,r;return i=e.next_out_index,(n=((r=this.read)<=this.write?this.write:this.end)-r)>e.avail_out&&(n=e.avail_out),0!=n&&t==_&&(t=k),e.avail_out-=n,e.total_out+=n,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,n)),j(this.window,r,e.next_out,i,n),i+=n,(r+=n)==this.end&&(r=0,this.write==this.end&&(this.write=0),(n=this.write-r)>e.avail_out&&(n=e.avail_out),0!=n&&t==_&&(t=k),e.avail_out-=n,e.total_out+=n,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,r,n)),j(this.window,r,e.next_out,i,n),i+=n,r+=n),e.next_out_index=i,this.read=r,t};function U(){}function W(){}function V(e,t,n,i,r){return e[0]=P,t[0]=E,n[0]=L,i[0]=M,k}U.prototype.init=function(e,t,n,i,r,o,a){this.mode=0,this.lbits=e,this.dbits=t,this.ltree=n,this.ltree_index=i,this.dtree=r,this.dtree_index=o,this.tree=null},U.prototype.proc=function(e,t,n){var i,r,o,a,s,l,c,h=0,u=0,f=0;for(f=t.next_in_index,a=t.avail_in,h=e.bitb,u=e.bitk,l=(s=e.write)<e.read?e.read-s-1:e.end-s;;)switch(this.mode){case 0:if(l>=258&&a>=10&&(e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,n=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,e,t),f=t.next_in_index,a=t.avail_in,h=e.bitb,u=e.bitk,l=(s=e.write)<e.read?e.read-s-1:e.end-s,n!=k)){this.mode=n==S?7:9;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=1;case 1:for(i=this.need;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=k,a--,h|=(255&t.next_in[f++])<<u,u+=8}if(r=3*(this.tree_index+(h&I[i])),h>>>=this.tree[r+1],u-=this.tree[r+1],0==(o=this.tree[r])){this.lit=this.tree[r+2],this.mode=6;break}if(0!=(16&o)){this.get=15&o,this.len=this.tree[r+2],this.mode=2;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}if(0!=(32&o)){this.mode=7;break}return this.mode=9,t.msg="invalid literal/length code",n=T,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);case 2:for(i=this.get;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=k,a--,h|=(255&t.next_in[f++])<<u,u+=8}this.len+=h&I[i],h>>=i,u-=i,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=3;case 3:for(i=this.need;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=k,a--,h|=(255&t.next_in[f++])<<u,u+=8}if(r=3*(this.tree_index+(h&I[i])),h>>=this.tree[r+1],u-=this.tree[r+1],0!=(16&(o=this.tree[r]))){this.get=15&o,this.dist=this.tree[r+2],this.mode=4;break}if(0==(64&o)){this.need=o,this.tree_index=r/3+this.tree[r+2];break}return this.mode=9,t.msg="invalid distance code",n=T,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);case 4:for(i=this.get;u<i;){if(0==a)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=k,a--,h|=(255&t.next_in[f++])<<u,u+=8}this.dist+=h&I[i],h>>=i,u-=i,this.mode=5;case 5:for(c=s-this.dist;c<0;)c+=e.end;for(;0!=this.len;){if(0==l&&(s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l&&(e.write=s,n=e.inflate_flush(t,n),l=(s=e.write)<e.read?e.read-s-1:e.end-s,s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l)))return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);e.window[s++]=e.window[c++],l--,c==e.end&&(c=0),this.len--}this.mode=0;break;case 6:if(0==l&&(s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l&&(e.write=s,n=e.inflate_flush(t,n),l=(s=e.write)<e.read?e.read-s-1:e.end-s,s==e.end&&0!=e.read&&(l=(s=0)<e.read?e.read-s-1:e.end-s),0==l)))return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);n=k,e.window[s++]=this.lit,l--,this.mode=0;break;case 7:if(u>7&&(u-=8,a++,f--),e.write=s,n=e.inflate_flush(t,n),l=(s=e.write)<e.read?e.read-s-1:e.end-s,e.read!=e.write)return e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);this.mode=8;case 8:return n=S,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);case 9:return n=T,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n);default:return n=C,e.bitb=h,e.bitk=u,t.avail_in=a,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=s,e.inflate_flush(t,n)}},U.prototype.free=function(e){},U.prototype.inflate_fast=function(e,t,n,i,r,o,a,s){var l,c,h,u,f,p,d,g,m,v,y,w,b,x,C,_;d=s.next_in_index,g=s.avail_in,f=a.bitb,p=a.bitk,v=(m=a.write)<a.read?a.read-m-1:a.end-m,y=I[e],w=I[t];do{for(;p<20;)g--,f|=(255&s.next_in[d++])<<p,p+=8;if(0!=(u=(c=n)[_=3*((h=i)+(l=f&y))]))for(;;){if(f>>=c[_+1],p-=c[_+1],0!=(16&u)){for(u&=15,b=c[_+2]+(f&I[u]),f>>=u,p-=u;p<15;)g--,f|=(255&s.next_in[d++])<<p,p+=8;for(u=(c=r)[_=3*((h=o)+(l=f&w))];;){if(f>>=c[_+1],p-=c[_+1],0!=(16&u)){for(u&=15;p<u;)g--,f|=(255&s.next_in[d++])<<p,p+=8;if(x=c[_+2]+(f&I[u]),f>>=u,p-=u,v-=b,m>=x)C=m-x,a.window[m++]=a.window[C++],a.window[m++]=a.window[C++],b-=2;else{C=m-x;do{C+=a.end}while(C<0);if(b>(u=a.end-C)){if(b-=u,m-C>0&&u>m-C)do{a.window[m++]=a.window[C++]}while(0!=--u);else j(a.window,C,a.window,m,u),m+=u,C+=u,u=0;C=0}}do{a.window[m++]=a.window[C++]}while(0!=--b);break}if(0!=(64&u))return s.msg="invalid distance code",g+=b=p>>3<(b=s.avail_in-g)?p>>3:b,d-=b,p-=b<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=d-s.next_in_index,s.next_in_index=d,a.write=m,T;l+=c[_+2],u=c[_=3*(h+(l+=f&I[u]))]}break}if(0!=(64&u))return 0!=(32&u)?(g+=b=p>>3<(b=s.avail_in-g)?p>>3:b,d-=b,p-=b<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=d-s.next_in_index,s.next_in_index=d,a.write=m,S):(s.msg="invalid literal/length code",g+=b=p>>3<(b=s.avail_in-g)?p>>3:b,d-=b,p-=b<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=d-s.next_in_index,s.next_in_index=d,a.write=m,T);if(l+=c[_+2],0==(u=c[_=3*(h+(l+=f&I[u]))])){f>>=c[_+1],p-=c[_+1],a.window[m++]=c[_+2],v--;break}}else f>>=c[_+1],p-=c[_+1],a.window[m++]=c[_+2],v--}while(v>=258&&g>=10);return g+=b=p>>3<(b=s.avail_in-g)?p>>3:b,d-=b,p-=b<<3,a.bitb=f,a.bitk=p,s.avail_in=g,s.total_in+=d-s.next_in_index,s.next_in_index=d,a.write=m,k},W.prototype.huft_build=function(e,t,n,i,r,o,a,s,l,c,h){var u,f,p,d,g,m,v,y,x,S,C,A,I,R,P;S=0,g=n;do{this.c[e[t+S]]++,S++,g--}while(0!=g);if(this.c[0]==n)return a[0]=-1,s[0]=0,k;for(y=s[0],m=1;m<=b&&0==this.c[m];m++);for(v=m,y<m&&(y=m),g=b;0!=g&&0==this.c[g];g--);for(p=g,y>g&&(y=g),s[0]=y,R=1<<m;m<g;m++,R<<=1)if((R-=this.c[m])<0)return T;if((R-=this.c[g])<0)return T;for(this.c[g]+=R,this.x[1]=m=0,S=1,I=2;0!=--g;)this.x[I]=m+=this.c[S],I++,S++;g=0,S=0;do{0!=(m=e[t+S])&&(this.v[this.x[m]++]=g),S++}while(++g<n);for(n=this.x[p],this.x[0]=g=0,S=0,d=-1,A=-y,this.u[0]=0,C=0,P=0;v<=p;v++)for(u=this.c[v];0!=u--;){for(;v>A+y;){if(d++,P=(P=p-(A+=y))>y?y:P,(f=1<<(m=v-A))>u+1&&(f-=u+1,I=v,m<P))for(;++m<P&&!((f<<=1)<=this.c[++I]);)f-=this.c[I];if(P=1<<m,this.hn[0]+P>w)return T;this.u[d]=C=this.hn[0],this.hn[0]+=P,0!=d?(this.x[d]=g,this.r[0]=m,this.r[1]=y,m=g>>>A-y,this.r[2]=C-this.u[d-1]-m,j(this.r,0,l,3*(this.u[d-1]+m),3)):a[0]=C}for(this.r[1]=v-A,S>=n?this.r[0]=192:h[S]<i?(this.r[0]=this.v[S]<256?0:96,this.r[2]=this.v[S++]):(this.r[0]=o[this.v[S]-i]+16+64,this.r[2]=r[this.v[S++]-i]),f=1<<v-A,m=g>>>A;m<P;m+=f)j(this.r,0,l,3*(C+m),3);for(m=1<<v-1;0!=(g&m);m>>>=1)g^=m;for(g^=m,x=(1<<A)-1;(g&x)!=this.x[d];)d--,x=(1<<(A-=y))-1}return 0!=R&&1!=p?_:k},W.prototype.inflate_trees_bits=function(e,t,n,i,r){var o;return this.initWorkArea(19),this.hn[0]=0,(o=this.huft_build(e,0,19,19,null,null,n,t,i,this.hn,this.v))==T?r.msg="oversubscribed dynamic bit lengths tree":o!=_&&0!=t[0]||(r.msg="incomplete dynamic bit lengths tree",o=T),o},W.prototype.inflate_trees_dynamic=function(e,t,n,i,r,o,a,s,l){var c;return this.initWorkArea(288),this.hn[0]=0,(c=this.huft_build(n,0,e,257,D,F,o,i,s,this.hn,this.v))!=k||0==i[0]?(c==T?l.msg="oversubscribed literal/length tree":-4!=c&&(l.msg="incomplete literal/length tree",c=T),c):(this.initWorkArea(288),(c=this.huft_build(n,e,t,0,B,N,a,r,s,this.hn,this.v))!=k||0==r[0]&&e>257?(c==T?l.msg="oversubscribed distance tree":c==_?(l.msg="incomplete distance tree",c=T):-4!=c&&(l.msg="empty distance tree with lengths",c=T),c):k)},W.prototype.initWorkArea=function(e){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(e),this.c=new Int32Array(16),this.r=new Int32Array(3),this.u=new Int32Array(b),this.x=new Int32Array(16)),this.v.length<e&&(this.v=new Int32Array(e));for(var t=0;t<e;t++)this.v[t]=0;for(t=0;t<16;t++)this.c[t]=0;for(t=0;t<3;t++)this.r[t]=0;j(this.c,0,this.u,0,b),j(this.c,0,this.x,0,16)};var q="function"==typeof new Uint8Array(1).subarray;function j(e,t,n,i,r){if(0!=r){if(!e)throw"Undef src";if(!n)throw"Undef dest";0==t&&r==e.length?X(e,n,i):q?X(e.subarray(t,t+r),n,i):1==e.BYTES_PER_ELEMENT&&r>100?X(new Uint8Array(e.buffer,e.byteOffset+t,r),n,i):function(e,t,n,i,r){for(var o=0;o<r;++o)n[i+o]=e[t+o]}(e,t,n,i,r)}}function X(e,t,n){t.set(e,n)}function K(e,t,n,i){e=t?new Uint8Array(e,t,n):new Uint8Array(e);var r=new O;r.inflateInit(y,!0),r.next_in=e,r.next_in_index=0,r.avail_in=e.length;for(var o=[],a=0;;){var s=new Uint8Array(32e3);r.next_out=s,r.next_out_index=0,r.avail_out=s.length;var l=r.inflate(x);if(l!=k&&l!=S)throw r.msg;if(0!=r.avail_out){var c=new Uint8Array(s.length-r.avail_out);j(s,0,c,0,s.length-r.avail_out),s=c}if(o.push(s),a+=s.length,l==S)break}if(i&&(i[0]=(t||0)+r.next_in_index),1==o.length)return o[0].buffer;for(var h=new Uint8Array(a),u=0,f=0;f<o.length;++f){var p=o[f];j(p,0,h,u,p.length),u+=p.length}return h.buffer}function Y(){}function Z(e){this._tree=e,this._ancestors=[],this._cursor=null}function Q(e){this.data=e,this.left=null,this.right=null,this.red=!0}function J(e){this._root=null,this._comparator=e,this.size=0}function ee(e){return null!==e&&e.red}function te(e,t){var n=e.get_child(!t);return e.set_child(!t,n.get_child(t)),n.set_child(t,e),e.red=!0,n.red=!1,n}function ne(e,t){return e.set_child(!t,te(e.get_child(!t),!t)),te(e,t)}function ie(e,t,n){this.discrete=!1===e,this.delta=e||.01,this.K=void 0===t?25:t,this.CX=void 0===n?1.1:n,this.centroids=new J(re),this.nreset=0,this.reset()}function re(e,t){return e.mean>t.mean?1:e.mean<t.mean?-1:0}function oe(e,t){return e.mean_cumn-t.mean_cumn}function ae(e){this.config=e||{},this.mode=this.config.mode||"auto",ie.call(this,"cont"===this.mode&&e.delta),this.digest_ratio=this.config.ratio||.9,this.digest_thresh=this.config.thresh||1e3,this.n_unique=0}!function(e){var t,n,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(e.event.fixHooks)for(var a=i.length;a;)e.event.fixHooks[i[--a]]=e.event.mouseHooks;var s=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=r.length;t;)this.addEventListener(r[--t],l,!1);else this.onmousewheel=l;e.data(this,"mousewheel-line-height",s.getLineHeight(this)),e.data(this,"mousewheel-page-height",s.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=r.length;t;)this.removeEventListener(r[--t],l,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function l(i){var r=i||window.event,a=o.call(arguments,1),l=0,u=0,f=0,p=0,d=0,g=0;if((i=e.event.fix(r)).type="mousewheel","detail"in r&&(f=-1*r.detail),"wheelDelta"in r&&(f=r.wheelDelta),"wheelDeltaY"in r&&(f=r.wheelDeltaY),"wheelDeltaX"in r&&(u=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(u=-1*f,f=0),l=0===f?u:f,"deltaY"in r&&(f=-1*r.deltaY,l=f),"deltaX"in r&&(u=r.deltaX,0===f&&(l=-1*u)),0!==f||0!==u){if(1===r.deltaMode){var m=e.data(this,"mousewheel-line-height");l*=m,f*=m,u*=m}else if(2===r.deltaMode){var v=e.data(this,"mousewheel-page-height");l*=v,f*=v,u*=v}if(p=Math.max(Math.abs(f),Math.abs(u)),(!n||p<n)&&(n=p,h(r,p)&&(n/=40)),h(r,p)&&(l/=40,u/=40,f/=40),l=Math[l>=1?"floor":"ceil"](l/n),u=Math[u>=1?"floor":"ceil"](u/n),f=Math[f>=1?"floor":"ceil"](f/n),s.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();d=i.clientX-y.left,g=i.clientY-y.top}return i.deltaX=u,i.deltaY=f,i.deltaFactor=n,i.offsetX=d,i.offsetY=g,i.deltaMode=0,a.unshift(i,l,u,f),t&&clearTimeout(t),t=setTimeout(c,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function c(){n=null}function h(e,t){return s.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(t),function(e){var t,n=e.Promise;n&&"resolve"in n&&"reject"in n&&"all"in n&&"race"in n&&(new n(function(e){t=e}),"function"==typeof t)||(e.Promise=k);var i="pending",r="sealed",o="fulfilled",a="rejected",s=function(){};function l(e){return"[object Array]"===Object.prototype.toString.call(e)}var c,h="undefined"!=typeof setImmediate?setImmediate:setTimeout,u=[];function f(){for(var e=0;e<u.length;e++)u[e][0](u[e][1]);u=[],c=!1}function p(e,t){u.push([e,t]),c||(c=!0,h(f,0))}function d(e){var t=e.owner,n=t.state_,i=t.data_,r=e[n],s=e.then;if("function"==typeof r){n=o;try{i=r(i)}catch(e){y(s,e)}}g(s,i)||(n===o&&m(s,i),n===a&&y(s,i))}function g(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var i=t.then;if("function"==typeof i)return i.call(t,function(i){n||(n=!0,t!==i?m(e,i):v(e,i))},function(t){n||(n=!0,y(e,t))}),!0}}catch(t){return n||y(e,t),!0}return!1}function m(e,t){e!==t&&g(e,t)||v(e,t)}function v(e,t){e.state_===i&&(e.state_=r,e.data_=t,p(b,e))}function y(e,t){e.state_===i&&(e.state_=r,e.data_=t,p(x,e))}function w(e){var t=e.then_;e.then_=void 0;for(var n=0;n<t.length;n++)d(t[n])}function b(e){e.state_=o,w(e)}function x(e){e.state_=a,w(e)}function k(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(this instanceof k==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(e,t){function n(e){y(t,e)}try{e(function(e){m(t,e)},n)}catch(e){n(e)}}(e,this)}k.prototype={constructor:k,state_:i,then_:null,data_:void 0,then:function(e,t){var n={owner:this,then:new this.constructor(s),fulfilled:e,rejected:t};return this.state_===o||this.state_===a?p(d,n):this.then_.push(n),n.then},catch:function(e){return this.then(null,e)}},k.all=function(e){if(!l(e))throw new TypeError("You must pass an array to Promise.all().");return new this(function(t,n){var i=[],r=0;function o(e){return r++,function(n){i[e]=n,--r||t(i)}}for(var a,s=0;s<e.length;s++)(a=e[s])&&"function"==typeof a.then?a.then(o(s),n):i[s]=a;r||t(i)})},k.race=function(e){if(!l(e))throw new TypeError("You must pass an array to Promise.race().");return new this(function(t,n){for(var i,r=0;r<e.length;r++)(i=e[r])&&"function"==typeof i.then?i.then(t,n):t(i)})},k.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this(function(t){t(e)})},k.reject=function(e){return new this(function(t,n){n(e)})}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this),Y.prototype.clear=function(){this._root=null,this.size=0},Y.prototype.find=function(e){for(var t=this._root;null!==t;){var n=this._comparator(e,t.data);if(0===n)return t.data;t=t.get_child(n>0)}return null},Y.prototype.findIter=function(e){for(var t=this._root,n=this.iterator();null!==t;){var i=this._comparator(e,t.data);if(0===i)return n._cursor=t,n;n._ancestors.push(t),t=t.get_child(i>0)}return null},Y.prototype.lowerBound=function(e){for(var t=this._root,n=this.iterator(),i=this._comparator;null!==t;){var r=i(e,t.data);if(0===r)return n._cursor=t,n;n._ancestors.push(t),t=t.get_child(r>0)}for(var o=n._ancestors.length-1;o>=0;--o)if(i(e,(t=n._ancestors[o]).data)<0)return n._cursor=t,n._ancestors.length=o,n;return n._ancestors.length=0,n},Y.prototype.upperBound=function(e){for(var t=this.lowerBound(e),n=this._comparator;null!==t.data()&&0===n(t.data(),e);)t.next();return t},Y.prototype.min=function(){var e=this._root;if(null===e)return null;for(;null!==e.left;)e=e.left;return e.data},Y.prototype.max=function(){var e=this._root;if(null===e)return null;for(;null!==e.right;)e=e.right;return e.data},Y.prototype.iterator=function(){return new Z(this)},Y.prototype.each=function(e){for(var t,n=this.iterator();null!==(t=n.next());)e(t)},Y.prototype.reach=function(e){for(var t,n=this.iterator();null!==(t=n.prev());)e(t)},Z.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},Z.prototype.next=function(){if(null===this._cursor){var e=this._tree._root;null!==e&&this._minNode(e)}else{var t;if(null===this._cursor.right)do{if(t=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===t);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},Z.prototype.prev=function(){if(null===this._cursor){var e=this._tree._root;null!==e&&this._maxNode(e)}else{var t;if(null===this._cursor.left)do{if(t=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===t);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},Z.prototype._minNode=function(e){for(;null!==e.left;)this._ancestors.push(e),e=e.left;this._cursor=e},Z.prototype._maxNode=function(e){for(;null!==e.right;)this._ancestors.push(e),e=e.right;this._cursor=e},Q.prototype.get_child=function(e){return e?this.right:this.left},Q.prototype.set_child=function(e,t){e?this.right=t:this.left=t},J.prototype=new Y,J.prototype.insert=function(e){var t=!1;if(null===this._root)this._root=new Q(e),t=!0,this.size++;else{var n=new Q(void 0),i=0,r=0,o=null,a=n,s=null,l=this._root;for(a.right=this._root;;){if(null===l?(l=new Q(e),s.set_child(i,l),t=!0,this.size++):ee(l.left)&&ee(l.right)&&(l.red=!0,l.left.red=!1,l.right.red=!1),ee(l)&&ee(s)){var c=a.right===o;l===s.get_child(r)?a.set_child(c,te(o,!r)):a.set_child(c,ne(o,!r))}var h=this._comparator(l.data,e);if(0===h)break;r=i,i=h<0,null!==o&&(a=o),o=s,s=l,l=l.get_child(i)}this._root=n.right}return this._root.red=!1,t},J.prototype.remove=function(e){if(null===this._root)return!1;var t=new Q(void 0),n=t;n.right=this._root;for(var i=null,r=null,o=null,a=1;null!==n.get_child(a);){var s=a;r=i,i=n,n=n.get_child(a);var l=this._comparator(e,n.data);if(a=l>0,0===l&&(o=n),!ee(n)&&!ee(n.get_child(a)))if(ee(n.get_child(!a))){var c=te(n,a);i.set_child(s,c),i=c}else if(!ee(n.get_child(!a))){var h=i.get_child(!s);if(null!==h)if(ee(h.get_child(!s))||ee(h.get_child(s))){var u=r.right===i;ee(h.get_child(s))?r.set_child(u,ne(i,s)):ee(h.get_child(!s))&&r.set_child(u,te(i,s));var f=r.get_child(u);f.red=!0,n.red=!0,f.left.red=!1,f.right.red=!1}else i.red=!1,h.red=!0,n.red=!0}}return null!==o&&(o.data=n.data,i.set_child(i.right===n,n.get_child(null===n.left)),this.size--),this._root=t.right,null!==this._root&&(this._root.red=!1),null!==o},ie.prototype.reset=function(){this.centroids.clear(),this.n=0,this.nreset+=1,this.last_cumulate=0},ie.prototype.size=function(){return this.centroids.size},ie.prototype.toArray=function(e){var t=[];return e?(this._cumulate(!0),this.centroids.each(function(e){t.push(e)})):this.centroids.each(function(e){t.push({mean:e.mean,n:e.n})}),t},ie.prototype.summary=function(){return[(this.discrete?"exact ":"approximating ")+this.n+" samples using "+this.size()+" centroids","min = "+this.percentile(0),"Q1  = "+this.percentile(.25),"Q2  = "+this.percentile(.5),"Q3  = "+this.percentile(.75),"max = "+this.percentile(1)].join("\n")},ie.prototype.push=function(e,t){t=t||1,e=Array.isArray(e)?e:[e];for(var n=0;n<e.length;n++)this._digest(e[n],t)},ie.prototype.push_centroid=function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)this._digest(e[t].mean,e[t].n)},ie.prototype._cumulate=function(e){if(!(this.n===this.last_cumulate||!e&&this.CX&&this.CX>this.n/this.last_cumulate)){var t=0;this.centroids.each(function(e){e.mean_cumn=t+e.n/2,t=e.cumn=t+e.n}),this.n=this.last_cumulate=t}},ie.prototype.find_nearest=function(e){if(0===this.size())return null;var t=this.centroids.lowerBound({mean:e}),n=null===t.data()?t.prev():t.data();if(n.mean===e||this.discrete)return n;var i=t.prev();return i&&Math.abs(i.mean-e)<Math.abs(n.mean-e)?i:n},ie.prototype._new_centroid=function(e,t,n){var i={mean:e,n:t,cumn:n};return this.centroids.insert(i),this.n+=t,i},ie.prototype._addweight=function(e,t,n){t!==e.mean&&(e.mean+=n*(t-e.mean)/(e.n+n)),e.cumn+=n,e.mean_cumn+=n/2,e.n+=n,this.n+=n},ie.prototype._digest=function(e,t){var n=this.centroids.min(),i=this.centroids.max(),r=this.find_nearest(e);if(r&&r.mean===e)this._addweight(r,e,t);else if(r===n)this._new_centroid(e,t,0);else if(r===i)this._new_centroid(e,t,this.n);else if(this.discrete)this._new_centroid(e,t,r.cumn);else{var o=r.mean_cumn/this.n;Math.floor(4*this.n*this.delta*o*(1-o))-r.n>=t?this._addweight(r,e,t):this._new_centroid(e,t,r.cumn)}this._cumulate(!1),!this.discrete&&this.K&&this.size()>this.K/this.delta&&this.compress()},ie.prototype.bound_mean=function(e){var t=this.centroids.upperBound({mean:e}),n=t.prev();return[n,n.mean===e?n:t.next()]},ie.prototype.p_rank=function(e){var t=(Array.isArray(e)?e:[e]).map(this._p_rank,this);return Array.isArray(e)?t:t[0]},ie.prototype._p_rank=function(e){if(0!==this.size()){if(e<this.centroids.min().mean)return 0;if(e>this.centroids.max().mean)return 1;this._cumulate(!0);var t=this.bound_mean(e),n=t[0],i=t[1];if(this.discrete)return n.cumn/this.n;var r=n.mean_cumn;return n!==i&&(r+=(e-n.mean)*(i.mean_cumn-n.mean_cumn)/(i.mean-n.mean)),r/this.n}},ie.prototype.bound_mean_cumn=function(e){this.centroids._comparator=oe;var t=this.centroids.upperBound({mean_cumn:e});this.centroids._comparator=re;var n=t.prev();return[n,n&&n.mean_cumn===e?n:t.next()]},ie.prototype.percentile=function(e){var t=(Array.isArray(e)?e:[e]).map(this._percentile,this);return Array.isArray(e)?t:t[0]},ie.prototype._percentile=function(e){if(0!==this.size()){this._cumulate(!0);var t=this.n*e,n=this.bound_mean_cumn(t),i=n[0],r=n[1];return r===i||null===i||null===r?(i||r).mean:this.discrete?t<=i.cumn?i.mean:r.mean:i.mean+(t-i.mean_cumn)*(r.mean-i.mean)/(r.mean_cumn-i.mean_cumn)}},ie.prototype.compress=function(){if(!this.compressing){var e,t,n=this.toArray();for(this.reset(),this.compressing=!0;n.length>0;)this.push_centroid((e=n,void 0,t=Math.floor(Math.random()*e.length),e.splice(t,1)[0]));this._cumulate(!0),this.compressing=!1}},ae.prototype=Object.create(ie.prototype),ae.prototype.constructor=ae,ae.prototype.push=function(e){ie.prototype.push.call(this,e),this.check_continuous()},ae.prototype._new_centroid=function(e,t,n){this.n_unique+=1,ie.prototype._new_centroid.call(this,e,t,n)},ae.prototype._addweight=function(e,t,n){1===e.n&&(this.n_unique-=1),ie.prototype._addweight.call(this,e,t,n)},ae.prototype.check_continuous=function(){return!("auto"!==this.mode||this.size()<this.digest_thresh)&&(this.n_unique/this.size()>this.digest_ratio&&(this.mode="cont",this.discrete=!1,this.delta=this.config.delta||.01,this.compress(),!0))};var se,le,ce,he,ue,fe,pe,de,ge,me,ve,ye,we,be,xe,ke,Se,Ce,Te,_e,Ae=function(e){return e.BamAlignment=function(){this.hidden=!1},e.BamAlignment.prototype.isMapped=function(){return 0==(4&this.flags)},e.BamAlignment.prototype.isPaired=function(){return 0!=(1&this.flags)},e.BamAlignment.prototype.isProperPair=function(){return 0!=(2&this.flags)},e.BamAlignment.prototype.isFirstOfPair=function(){return 0!=(64&this.flags)},e.BamAlignment.prototype.isSecondOfPair=function(){return 0!=(128&this.flags)},e.BamAlignment.prototype.isSecondary=function(){return 0!=(256&this.flags)},e.BamAlignment.prototype.isSupplementary=function(){return 0!=(2048&this.flags)},e.BamAlignment.prototype.isFailsVendorQualityCheck=function(){return 0!=(512&this.flags)},e.BamAlignment.prototype.isDuplicate=function(){return 0!=(1024&this.flags)},e.BamAlignment.prototype.isMateMapped=function(){return 0==(8&this.flags)},e.BamAlignment.prototype.isNegativeStrand=function(){return 0!=(16&this.flags)},e.BamAlignment.prototype.isMateNegativeStrand=function(){return 0!=(32&this.flags)},e.BamAlignment.prototype.tags=function(){return this.tagDict||(this.tagBA?(this.tagDict=function(e){var t=0,n=e.length,i={};for(;t<n;){var r,o=String.fromCharCode(e[t])+String.fromCharCode(e[t+1]),a=String.fromCharCode(e[t+2]);if("A"==a)r=String.fromCharCode(e[t+3]),t+=4;else if("i"===a||"I"===a)r=(f=e)[(p=t+3)+3]<<24|f[p+2]<<16|f[p+1]<<8|f[p],t+=7;else if("c"===a||"C"===a)r=e[t+3],t+=4;else if("s"===a||"S"===a)r=(h=e)[(u=t+3)+1]<<8|h[u],t+=5;else if("f"===a)l=t+3,c=void 0,void 0,c=new DataView(e.buffer),!0,r=c.getFloat32(l,!0),t+=7;else{if("Z"!==a){r="Error unknown type: "+a,i[o]=r;break}for(t+=3,r="";;){var s=e[t++];if(0===s)break;r+=String.fromCharCode(s)}}i[o]=r}var l,c;var h,u;var f,p;return i}(this.tagBA),this.tagBA=void 0):this.tagDict={}),this.tagDict},e.BamAlignment.prototype.popupData=function(t){var n,i,r=[];if(this.insertions)for(var o=0;o<this.insertions.length;o+=1){var a=this.insertions[o].start;if(t==a||t==a-1)return r.push({name:"Insertion",value:this.insertions[o].seq}),r.push({name:"Location",value:a}),r}for(var s in r.push({name:"Read Name",value:this.readName}),r.push("<hr>"),r.push({name:"Alignment Start",value:e.numberFormatter(1+this.start),borderTop:!0}),r.push({name:"Read Strand",value:!0===this.strand?"(+)":"(-)",borderTop:!0}),r.push({name:"Cigar",value:this.cigar}),r.push({name:"Mapped",value:l(this.isMapped())}),r.push({name:"Mapping Quality",value:this.mq}),r.push({name:"Secondary",value:l(this.isSecondary())}),r.push({name:"Supplementary",value:l(this.isSupplementary())}),r.push({name:"Duplicate",value:l(this.isDuplicate())}),r.push({name:"Failed QC",value:l(this.isFailsVendorQualityCheck())}),this.isPaired()&&(r.push("<hr>"),r.push({name:"First in Pair",value:!this.isSecondOfPair(),borderTop:!0}),r.push({name:"Mate is Mapped",value:l(this.isMateMapped())}),this.pairOrientation&&r.push({name:"Pair Orientation",value:this.pairOrientation}),this.isMateMapped()&&(r.push({name:"Mate Chromosome",value:this.mate.chr}),r.push({name:"Mate Start",value:this.mate.position+1}),r.push({name:"Mate Strand",value:!0===this.mate.strand?"(+)":"(-)"}),r.push({name:"Insert Size",value:this.fragmentLength}))),r.push("<hr>"),n=!0,i=this.tags())i.hasOwnProperty(s)&&(n?(r.push({name:s,value:i[s],borderTop:!0}),n=!1):r.push({name:s,value:i[s]}));return r;function l(e){return e?"Yes":"No"}},e.BamFilter=function(e){e||(e={}),this.vendorFailed=void 0===e.vendorFailed||e.vendorFailed,this.duplicates=void 0===e.duplicates||e.duplicates,this.secondary=e.secondary||!1,this.supplementary=e.supplementary||!1,this.mqThreshold=void 0===e.mqThreshold?0:e.mqThreshold},e.BamFilter.prototype.pass=function(e){return(!this.vendorFailed||!e.isFailsVendorQualityCheck())&&((!this.duplicates||!e.isDuplicate())&&((!this.secondary||!e.isSecondary())&&((!this.supplementary||!e.isSupplementary())&&!(e.mq<this.mqThreshold))))},e}((Ae=function(e){function t(e){return e.isPaired()&&e.mate&&e.isMateMapped()&&e.chr===e.mate.chr&&(e.isFirstOfPair()||e.isSecondOfPair())&&!(e.isSecondary()||e.isSupplementary())}function n(){this.alignments=this.alignments.concat(this.currentBucket.alignments),this.currentBucket.downsampledCount>0&&this.downsampledIntervals.push(new a(this.currentBucket.start,this.currentBucket.end,this.currentBucket.downsampledCount)),this.paired=this.paired||this.currentBucket.paired}function i(e,t,n){this.start=e,this.end=t,this.alignments=[],this.downsampledCount=0,this.samplingDepth=n.samplingDepth,this.pairsSupported=n.pairsSupported,this.downsampledReads=n.downsampledReads,this.pairsCache=n.pairsCache}function r(e,t,n){this.chr=e,this.bpStart=t,this.length=n-t,this.coverage=new Array(this.length),this.maximum=0,this.threshold=.2,this.qualityWeight=!0}function o(){this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0}function a(e,t,n){this.start=e,this.end=t,this.counts=n}function s(e,t){this.totalCount=0,this.frCount=0,this.rfCount=0,this.ffCount=0,this.sumF=0,this.sumF2=0}return e.AlignmentContainer=function(e,t,n,o,a,l){this.chr=e,this.start=Math.floor(t),this.end=Math.ceil(n),this.length=n-t,this.coverageMap=new r(e,t,n),this.alignments=[],this.downsampledIntervals=[],this.samplingWindowSize=void 0===o?100:o,this.samplingDepth=void 0===a?50:a,this.pairsSupported=void 0===l||l,this.paired=!1,this.pairsCache={},this.downsampledReads=new Set,this.currentBucket=new i(this.start,this.start+this.samplingWindowSize,this),this.filter=function(e){return e.isMapped()&&!e.isFailsVendorQualityCheck()},this.pairedEndStats=new s},e.AlignmentContainer.prototype.push=function(e){!1!==this.filter(e)&&(e.isPaired()&&this.pairedEndStats.push(e),this.coverageMap.incCounts(e),this.pairsSupported&&this.downsampledReads.has(e.readName)||(e.start>=this.currentBucket.end&&(n.call(this),this.currentBucket=new i(e.start,e.start+this.samplingWindowSize,this)),this.currentBucket.addAlignment(e)))},e.AlignmentContainer.prototype.forEach=function(e){this.alignments.forEach(e)},e.AlignmentContainer.prototype.finish=function(){if(void 0!==this.currentBucket&&n.call(this),this.pairsSupported){var e=[],t=this.downsampledReads;this.alignments.forEach(function(n){t.has(n.readName)||e.push(n)}),this.alignments=e}this.alignments.sort(function(e,t){return e.start-t.start}),this.pairsCache=void 0,this.downsampledReads=void 0,this.pairedEndStats.compute()},e.AlignmentContainer.prototype.contains=function(e,t,n){return this.chr==e&&this.start<=t&&this.end>=n},e.AlignmentContainer.prototype.hasDownsampledIntervals=function(){return this.downsampledIntervals&&this.downsampledIntervals.length>0},i.prototype.addAlignment=function(n){var i,r,o,a;this.alignments.length<this.samplingDepth?this.pairsSupported&&t(n)?(a=this.pairsCache[n.readName])?(a.setSecondAlignment(n),this.pairsCache[n.readName]=void 0):(a=new e.PairedAlignment(n),this.paired=!0,this.pairsCache[n.readName]=a,this.alignments.push(a)):this.alignments.push(n):(i=this.samplingDepth/(this.samplingDepth+this.downsampledCount+1),Math.random()<i?(r=Math.floor(Math.random()*(this.alignments.length-1)),o=this.alignments[r],this.pairsSupported&&t(n)?(void 0!==this.pairsCache[o.readName]&&(this.pairsCache[o.readName]=void 0),a=new e.PairedAlignment(n),this.paired=!0,this.pairsCache[n.readName]=a,this.alignments[r]=a):this.alignments[r]=n,this.downsampledReads.add(o.readName)):this.downsampledReads.add(n.readName),this.downsampledCount++)},r.prototype.incCounts=function(e){var t=this;function n(n){var i,r,a,s,l;for(a=n.start-t.bpStart,s=0;s<n.len;a++,s++)t.coverage[a]||(t.coverage[a]=new o),r=n.seq.charAt(s),i=e.strand?"pos"+r:"neg"+r,l=n.qual[s],t.coverage[a][i]+=1,t.coverage[a]["qual"+r]+=l,t.coverage[a].total+=1,t.coverage[a].qual+=l,t.maximum=Math.max(t.coverage[a].total,t.maximum)}void 0===e.blocks?n(e):e.blocks.forEach(function(e){n(e)})},o.prototype.isMismatch=function(t){var n,i=this,r=e.CoverageMap.threshold*(e.CoverageMap.qualityWeight&&this.qual?this.qual:this.total);return n=0,["A","T","C","G"].forEach(function(r){r!==t&&(n+=e.CoverageMap.qualityWeight&&i.qual?i["qual"+r]:i["pos"+r]+i["neg"+r])}),n>=r},a.prototype.popupData=function(e){return[{name:"start",value:this.start+1},{name:"end",value:this.end},{name:"# downsampled:",value:this.counts}]},s.prototype.push=function(e){if(e.isProperPair()){var t=Math.abs(e.fragmentLength);this.sumF+=t,this.sumF2+=t*t;var n=e.pairOrientation;if("string"==typeof n&&4==n.length)switch(""+n.charAt(0)+n.charAt(2)){case"FF":case"RR":this.ffCount++;break;case"FR":this.frCount++;break;case"RF":this.rfCount++}this.totalCount++}},s.prototype.compute=function(){if(this.totalCount>100){this.ffCount/this.totalCount>.9?this.orienation="ff":this.frCount/this.totalCount>.9?this.orienation="fr":this.rfCount/this.totalCount>.9&&(this.orienation="rf");var e=this.sumF/this.totalCount,t=Math.sqrt((this.totalCount*this.sumF2-this.sumF*this.sumF)/(this.totalCount*this.totalCount));this.lowerFragmentLength=e-3*t,this.upperFragmentLength=e+3*t}},e}(Ae||{}))||{});Ae=function(e){return e.BamWebserviceReader=function(t){this.config=t,e.BamUtils.setReaderDefaults(this,t)},e.BamWebserviceReader.prototype.readAlignments=function(t,n,i){var r=this;return new Promise(function(o,a){(function(){var t=this;{if(this.header)return Promise.resolve(this.header);var n=this.config.url+"?file="+this.config.alignmentFile+"&options=-b,-H",i=e.buildOptions(this.config),r=e.browser?e.browser.genome:null;return new Promise(function(o,a){e.BamUtils.readHeader(n,i,r).then(function(e){t.header=e,o(e)}).catch(a)})}}).call(r).then(function(s){var l,c;l=s.chrAliasTable.hasOwnProperty(t)?s.chrAliasTable[t]:t,c=r.config.url+"?reference="+r.config.referenceFile+"&file="+r.config.alignmentFile+"&region="+l+":"+n+"-"+i,e.xhr.loadString(c,e.buildOptions(r.config)).then(function(a){var c;s.chrToIndex[l],c=new e.AlignmentContainer(t,n,i,r.samplingWindowSize,r.samplingDepth,r.pairsSupported),e.BamUtils.decodeSamRecords(a,c,l,n,i,r.filter),o(c)}).catch(function(e){a(e)})}).catch(a)})},e}((Ae=function(e){var t=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],n=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"],i=o(new Uint8Array([66,65,77,1]),0);function r(e,t){for(var n,i,r,o,a=[],s=0,l=e.start,c=t.length,h=0;h<c;h++){var u=t[h];switch(u.ltr){case"H":case"P":break;case"S":s+=u.len,o="S";break;case"N":l+=u.len,o="N";break;case"D":l+=u.len,o="D";break;case"I":i="*"===e.seq?"*":e.seq.substr(s,u.len),r=e.qual?e.qual.slice(s,u.len):void 0,void 0===n&&(n=[]),n.push({start:l,len:u.len,seq:i,qual:r}),s+=u.len;break;case"M":case"EQ":case"=":case"X":i="*"===e.seq?"*":e.seq.substr(s,u.len),r=e.qual?e.qual.slice(s,u.len):void 0,a.push({start:l,len:u.len,seq:i,qual:r,gapType:o}),s+=u.len,l+=u.len;break;default:console.log("Error processing cigar element: "+u.len+u.ltr)}}return{blocks:a,insertions:n}}function o(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function a(e){var t,n,i,r,o,a,s,l,c;for(t=[],n=[],o=null,r=e.length,i=0;i<r;i++)a=e.charAt(i),void 0,(c=a.charCodeAt(0))>=48&&c<=57?n.push(a):(s=a,l=Number.parseInt(n.join("")),n=[],null!=o&&o.ltr==s?o.len+=l:(o={len:l,ltr:s},t.push(o)));return t}function s(e){var t={};return e.forEach(function(e){var n=e.split(":");t[n[0]]=n[2]}),t}return e.BamUtils={readHeader:function(t,n,i){return new Promise(function(r,o){e.xhr.loadArrayBuffer(t,n).then(function(t){var n,o,a;o=e.unbgzf(t),a=new Uint8Array(o),n=e.BamUtils.decodeBamHeader(a,i),r(n)}).catch(function(e){o(e)})})},decodeBamHeader:function(e,t){var n,r,a,s,l;if((n=o(e,0))!==i)throw new Error("BAM header contains an invalid BAM magic");r=o(e,4);for(var c=0;c<r;++c)String.fromCharCode(e[c+8]);var h=o(e,r+8),u=r+12;for(a={},s=[],l={},c=0;c<h;++c){for(var f=o(e,u),p="",d=0;d<f-1;++d)p+=String.fromCharCode(e[u+4+d]);o(e,u+f+4);a[p]=c,s[c]=p,t&&(l[t.getChromosomeName(p)]=p),u=u+8+f}return{magicNumber:n,size:u,chrNames:s,chrToIndex:a,chrAliasTable:l}},bam_tag2cigar:function(e,t,i,r,a,s){function l(e){return"C"==e||"c"==e||"A"==e?1:"S"==e||"s"==e?2:"I"==e||"i"==e||"f"==e?4:0}if(1!=s.length||a.start<0)return!1;for(var c=i+(r+1>>1)+r;c+4<t;){if("CG"==String.fromCharCode(e[c])+String.fromCharCode(e[c+1]))break;var h=String.fromCharCode(e[c+2]);if("B"==h)c+=8+l(h=String.fromCharCode(e[c+3]))*o(e,c+4);else if("Z"==h||"H"==h)for(c+=3;0!=e[c++];);else c+=3+l(h)}if(c>=t)return!1;if("B"!=String.fromCharCode(e[c+2])||"I"!=String.fromCharCode(e[c+3]))return!1;var u=o(e,c+4),f=c+8;if(f+4*u>t)return!1;var p="",d=0;s.length=0,c=f;for(var g=0;g<u;++g,c+=4){var m=o(e,c),v=m>>4,y=n[15&m];"M"!=y&&"EQ"!=y&&"X"!=y&&"D"!=y&&"N"!=y&&"="!=y||(d+=v),p=p+v+y,s.push({len:v,ltr:y})}return a.cigar=p,a.lengthOnRef=d,!0},decodeBamRecords:function(i,a,s,l,c,h,u,f){for(var p,d,g,m,v,y,w,b,x,k,S,C,T,_,A,I,R,P,E,L,M,D,F,B,N;a<i.length;){if((p=a+o(i,a)+4)>i.length)return;if(d=new e.BamAlignment,m=o(i,a+4),v=o(i,a+8),!(m<0)){if(c&&(m>c||v>u))return;if(!(c&&m<c)){for((4294901760&(y=o(i,a+12)))>>16,w=(65280&y)>>8,b=255&y,k=(4294901760&(x=o(i,a+16)))>>16,S=65535&x,C=o(i,a+20),_=o(i,a+24),A=o(i,a+28),T=o(i,a+32),I=[],R=0;R<b-1;++R)I.push(String.fromCharCode(i[a+36+R]));for(I=I.join(""),E=0,L="",P=a+36+b,D=[],M=0;M<S;++M){var O=o(i,P),H=O>>4,z=n[15&O];"M"!=z&&"EQ"!=z&&"X"!=z&&"D"!=z&&"N"!=z&&"="!=z||(E+=H),L=L+H+z,P+=4,D.push({len:H,ltr:z})}if(d.chr=l[m],d.start=v,d.flags=k,d.strand=!(16&k),d.readName=I,d.cigar=L,d.lengthOnRef=E,d.fragmentLength=T,d.mq=w,e.BamUtils.bam_tag2cigar(i,p,P,C,d,D),d.end=d.start+d.lengthOnRef,d.end<h)a=p;else{for(F=[],B=C+1>>1,R=0;R<B;++R){var $=i[P+R];F.push(t[(240&$)>>4]),F.push(t[15&$])}if(F=F.slice(0,C).join(""),P+=B,1===C&&"*"===String.fromCharCode(i[P+R]+33));else for(N=[],R=0;R<C;++R)N.push(i[P+R]);P+=C,_>=0&&(d.mate={chr:l[_],position:A,strand:!(32&k)}),d.seq=F,d.qual=N,d.tagBA=new Uint8Array(i.buffer.slice(P,p)),this.setPairOrientation(d),(!h||d.start<=u&&d.start+d.lengthOnRef>=h&&(void 0===f||f.pass(d)))&&(void 0!==c&&m!=c||(g=r(d,D),d.blocks=g.blocks,d.insertions=g.insertions,s.push(d))),a=p}}}}},decodeSamRecords:function(t,n,i,o,l,c){var h,u,f,p,d,g,m,v,y,w,b;for(p=(h=t.splitLines()).length,!1,u=0;u<p;u++)if(d=h[u].split("\t"),(w=new e.BamAlignment).chr=d[2],w.start=Number.parseInt(d[3])-1,w.flags=Number.parseInt(d[1]),w.readName=d[0],w.strand=!(16&w.flags),w.mq=Number.parseInt(d[4]),w.cigar=d[5],w.fragmentLength=Number.parseInt(d[8]),w.seq=d[9],"*"!==w.chr&&w.isMapped()&&w.chr===i){if(w.start>l)break;if(y=0,(b=a(w.cigar)).forEach(function(e){var t=e.len,n=e.ltr;"M"!=n&&"EQ"!=n&&"X"!=n&&"D"!=n&&"N"!=n&&"="!=n||(y+=t)}),w.lengthOnRef=y,!(w.start+y<o)){for(m=d[10],w.qual=[],f=0;f<m.length;f++)w.qual[f]=m.charCodeAt(f)-33;w.tagDict=d.length<11?{}:s(d.slice(11)),w.isMateMapped()&&(v=d[6],w.mate={chr:"="===v?w.chr:v,position:Number.parseInt(d[7]),strand:!(32&w.flags)}),this.setPairOrientation(w),(void 0===c||c.pass(w))&&(g=r(w,b),w.blocks=g.blocks,w.insertions=g.insertions,n.push(w))}}},setReaderDefaults:function(t,n){t.filter=n.filter||new e.BamFilter,t.samplingWindowSize=void 0===n.samplingWindowSize?100:n.samplingWindowSize,t.samplingDepth=void 0===n.samplingDepth?50:n.samplingDepth,t.samplingDepth>2500&&(e.log("Warning: attempt to set sampling depth > maximum value of 2500"),t.samplingDepth=2500),n.viewAsPairs?t.pairsSupported=!0:t.pairsSupported=void 0===n.pairsSupported||n.pairsSupported},setPairOrientation:function(e){if(e.isMapped()&&e.mate&&e.isMateMapped()&&e.mate.chr===e.chr){var t=e.strand?"F":"R",n=e.mate,i=n.strand?"F":"R",r=" ",o=" ";e.isFirstOfPair()?(r="1",o="2"):e.isSecondOfPair()&&(r="2",o="1");var a=[],s=e.fragmentLength,l=e.end-e.start;if(0==s)s=(e.start<n.start?n.start+l:n.start-l)-e.start;s>0?(a[0]=t,a[1]=r,a[2]=i,a[3]=o):(a[2]=t,a[3]=r,a[0]=i,a[1]=o),e.pairOrientation=a.join("")}}},e}((Ae=function(t){function n(e,n,i){var r,o=t.nucleotideColorComponents[n];if(o)return r=e<5?.1:Math.max(.1,Math.min(1,.1+.9*(e-5)/15)),(r=Math.round(10*r)/10)>=1?t.nucleotideColors[n]:"rgba("+o[0]+","+o[1]+","+o[2]+","+r+")"}function r(e){var n,i,r=this,a=r.colorBy;switch(i=r.parent.color,a){case"strand":i=e.strand?r.posStrandColor:r.negStrandColor;break;case"firstOfPairStrand":e instanceof t.PairedAlignment?i=e.firstOfPairStrand()?r.posStrandColor:r.negStrandColor:e.isPaired()&&(e.isFirstOfPair()?i=e.strand?r.posStrandColor:r.negStrandColor:e.isSecondOfPair()?i=e.strand?r.negStrandColor:r.posStrandColor:console.log("ERROR. Paired alignments are either first or second."));break;case"pairOrientation":if(r.pairOrientation&&e.pairOrientation){var s=o[r.pairOrientation];if(s){var l=r.pairColors[s[e.pairOrientation]];l&&(i=l)}else console.log("No orientation types for "+r.pairOrientation)}break;case"fragmentLength":e.pairOrientation&&(r.parent.minFragmentLength&&Math.abs(e.fragmentLength)<r.parent.minFragmentLength?i=r.smallFragmentLengthColor:r.parent.maxFragmentLength&&Math.abs(e.fragmentLength)>r.parent.maxFragmentLength&&(i=r.largeFragmentLengthColor));break;case"tag":void 0!==(n=e.tags()[r.colorByTag])&&(i=r.bamColorTag===r.colorByTag?"rgb("+n+")":r.tagColors.getColor(n));break;default:i=r.parent.color}return i}t.BAMTrack=function(e){this.featureSource=new t.BamSource(e),void 0===e.height&&(e.height=300),t.configTrack(this,e),void 0===e.coverageTrackHeight&&(e.coverageTrackHeight=50),this.coverageTrack=new CoverageTrack(e,this),this.alignmentTrack=new AlignmentTrack(e,this),this.visibilityWindow=e.visibilityWindow||3e4,this.viewAsPairs=e.viewAsPairs,this.pairsSupported=void 0===e.pairsSupported,this.color=e.color||"rgb(185, 185, 185)",this.sortOption=e.sortOption||{sort:"NUCLEOTIDE"},this.sortDirection=!0,this.filterOption=e.filterOption||{name:"mappingQuality",params:[30,void 0]},this.minFragmentLength=e.minFragmentLength,this.maxFragmentLength=e.maxFragmentLength},t.BAMTrack.prototype.getFeatures=function(e,t,n){var i=this;return this.featureSource.getAlignments(e,t,n).then(function(e){return void 0===i.minFragmentLength&&(i.minFragmentLength=e.pairedEndStats.lowerFragmentLength),void 0===i.maxFragmentLength&&(i.maxFragmentLength=e.pairedEndStats.upperFragmentLength),e})},t.BAMTrack.filters={noop:function(){return function(e){return!1}},strand:function(e){return function(t){return t.strand===e}},mappingQuality:function(e,t){return function(n){return!!(e&&n.mq<e)||!!(t&&n.mq>t)}}},t.BAMTrack.prototype.computePixelHeight=function(e){return this.coverageTrack.computePixelHeight(e)+this.alignmentTrack.computePixelHeight(e)},t.BAMTrack.prototype.draw=function(e){this.coverageTrack.height>0&&this.coverageTrack.draw(e),this.alignmentTrack.draw(e)},t.BAMTrack.prototype.paintAxis=function(e,t,n){this.coverageTrack.paintAxis(e,t,this.coverageTrackHeight)},t.BAMTrack.prototype.popupMenuItemList=function(t){var n,i,r=this,o=[];return(n=e("<div>")).text("Sort by base"),i=function(){r.alignmentTrack.sortAlignmentRows(t.genomicLocation,r.sortOption),r.trackView.update(),r.sortDirection=!r.sortDirection,t.popover.hide()},o.push({name:void 0,object:n,click:i,init:void 0}),!1===r.viewAsPairs&&((n=e("<div>")).text("View mate in split screen"),i=function(){r.alignmentTrack.popupMenuItemList(t)},o.push({name:void 0,object:n,click:i,init:void 0})),o},t.BAMTrack.prototype.popupData=function(e){return e.y>=this.coverageTrack.top&&e.y<this.coverageTrack.height?this.coverageTrack.popupData(e):this.alignmentTrack.popupData(e)},t.BAMTrack.prototype.menuItemList=function(n){var r,o,a,s,l,c,h=this,u=[],f=[];return u.push((l=n,(c=e("<div>")).text("Sort by base"),{name:void 0,object:c,click:function(){var e,n,r=i.first(t.browser.genomicStateList),o=r.referenceFrame;l.hide(),n=Math.floor(t.browser.viewportContainerWidth()/r.locusCount*.5),e=Math.floor(o.start+o.toBP(n)),h.altClick(e,void 0,void 0),"show center guide"===t.browser.centerGuide.$centerGuideToggle.text()&&t.browser.centerGuide.$centerGuideToggle.trigger("click")},init:void 0})),f.push({key:"none",label:"track color"}),f.push({key:"strand",label:"read strand"}),h.alignmentTrack.hasPairs&&(f.push({key:"firstOfPairStrand",label:"first-of-pair strand"}),f.push({key:"pairOrientation",label:"pair orientation"}),f.push({key:"fragmentLength",label:"fragment length"})),a="tag"+(h.alignmentTrack.colorByTag?" ("+h.alignmentTrack.colorByTag+")":""),f.push({key:"tag",label:a}),(r=e('<div class="igv-track-menu-category igv-track-menu-border-top">')).text("Color by"),u.push({name:void 0,object:r,click:void 0,init:void 0}),f.forEach(function(n){s=h.alignmentTrack.colorBy===n.key,u.push(function(n,i,r){var o=[];o.push("<div>"),o.push(i?'<i class="fa fa-check"></i>':'<i class="fa fa-check fa-check-hidden"></i>'),"tag"===n.key?o.push('<span id="color-by-tag">'):o.push("<span>");return o.push(n.label),o.push("</span>"),o.push("</div>"),{name:void 0,object:e(o.join("")),click:function(){t.popover.hide(),"tag"===n.key?(t.dialog.configure(function(){return"Tag Name"},h.alignmentTrack.colorByTag?h.alignmentTrack.colorByTag:"",function(){var n=t.dialog.$dialogInput.val().trim();h.alignmentTrack.colorBy="tag",n!==h.alignmentTrack.colorByTag&&(h.alignmentTrack.colorByTag=t.dialog.$dialogInput.val().trim(),h.alignmentTrack.tagColors=new t.PaletteColorTable("Set1"),e("#color-by-tag").text(h.alignmentTrack.colorByTag)),h.trackView.update()},void 0,void 0),t.dialog.show(e(h.trackView.trackDiv))):(h.alignmentTrack.colorBy=n.key,h.trackView.update())},init:void 0}}(n,s))}),o=[],h.pairsSupported&&h.alignmentTrack.hasPairs&&(o.push('<div class="igv-track-menu-border-top">'),o.push(!0===h.viewAsPairs?'<i class="fa fa-check">':'<i class="fa fa-check fa-check-hidden">'),o.push("</i>"),o.push("View as pairs"),o.push("</div>"),u.push({object:e(o.join("")),click:function(){var t=e(this).find("i");n.hide(),h.viewAsPairs=!h.viewAsPairs,!0===h.viewAsPairs?t.removeClass("fa-check-hidden"):t.addClass("fa-check-hidden"),h.featureSource.setViewAsPairs(h.viewAsPairs),h.trackView.update()}})),u},CoverageTrack=function(e,n){this.parent=n,this.featureSource=n.featureSource,this.top=0,this.height=e.coverageTrackHeight,this.dataRange={min:0},this.paintAxis=t.paintAxis},CoverageTrack.prototype.computePixelHeight=function(e){return this.height},CoverageTrack.prototype.draw=function(e){var n,i,r,o,a,s,l,c,h,u,f,p=this,d=e.features,g=e.context,m=e.bpPerPixel,v=e.bpStart,y=v+e.pixelWidth*m+1,w=d.coverageMap;for(this.top&&g.translate(0,top),w.refSeq&&(f=w.refSeq.toUpperCase()),this.dataRange.max=w.maximum,o=Math.max(1,Math.ceil(1/m)),l=0,c=w.coverage.length;l<c;l++)if(!((n=w.bpStart+l)<v)){if(n>y)break;(h=w.coverage[l])&&(a=Math.round(h.total/this.dataRange.max*this.height),r=this.height-a,i=Math.floor((n-v)/m),t.graphics.setProperties(g,{fillStyle:this.parent.color,strokeStyle:this.color}),t.graphics.fillRect(g,i,r,o,a))}if(f)for(l=0,c=w.coverage.length;l<c;l++)if(!((n=w.bpStart+l)<v)){if(n>y)break;(h=w.coverage[l])&&(a=h.total/this.dataRange.max*this.height,r=this.height-a,i=Math.floor((n-v)/m),s=f[l],h.isMismatch(s)&&(t.graphics.setProperties(g,{fillStyle:t.nucleotideColors[s]}),t.graphics.fillRect(g,i,r,o,a),u=0,["A","C","T","G"].forEach(function(e){var n;n=(h["pos"+e]+h["neg"+e])/p.dataRange.max*p.height,r=p.height-n-u,u+=n,t.graphics.setProperties(g,{fillStyle:t.nucleotideColors[e]}),t.graphics.fillRect(g,i,r,o,n)})))}},CoverageTrack.prototype.popupData=function(e){var n,i,r,o=e.genomicLocation,a=(e.x,e.y,e.viewport.genomicState.referenceFrame),s=this.featureSource.alignmentContainer.coverageMap,l=[];return n=o-s.bpStart,(i=s.coverage[n])&&(l.push(a.chrName+":"+t.numberFormatter(1+o)),l.push({name:"Total Count",value:i.total}),(r=i.posA+i.negA)>0&&(r=r.toString()+" ("+Math.floor((i.posA+i.negA)/i.total*100)+"%)"),l.push({name:"A",value:r}),(r=i.posC+i.negC)>0&&(r=r.toString()+" ("+Math.floor(r/i.total*100)+"%)"),l.push({name:"C",value:r}),(r=i.posG+i.negG)>0&&(r=r.toString()+" ("+Math.floor(r/i.total*100)+"%)"),l.push({name:"G",value:r}),(r=i.posT+i.negT)>0&&(r=r.toString()+" ("+Math.floor(r/i.total*100)+"%)"),l.push({name:"T",value:r}),(r=i.posN+i.negN)>0&&(r=r.toString()+" ("+Math.floor(r/i.total*100)+"%)"),l.push({name:"N",value:r})),l},AlignmentTrack=function(e,t){this.parent=t,this.featureSource=t.featureSource,this.top=0==e.coverageTrackHeight?0:e.coverageTrackHeight+5,this.alignmentRowHeight=e.alignmentRowHeight||14,this.negStrandColor=e.negStrandColor||"rgba(150, 150, 230, 0.75)",this.posStrandColor=e.posStrandColor||"rgba(230, 150, 150, 0.75)",this.insertionColor=e.insertionColor||"rgb(138, 94, 161)",this.deletionColor=e.deletionColor||"black",this.skippedColor=e.skippedColor||"rgb(150, 170, 170)",this.smallFragmentLengthColor=e.smallFragmentLengthColor||"rgb(0, 0, 150)",this.largeFragmentLengthColor=e.largeFragmentLengthColor||"rgb(200, 0, 0)",this.pairOrientation=e.pairOrienation||"fr",this.pairColors={},this.pairColors.RL=e.rlColor||"rgb(0, 150, 0)",this.pairColors.RR=e.rrColor||"rgb(20, 50, 200)",this.pairColors.LL=e.llColor||"rgb(0, 150, 150)",this.colorBy=e.colorBy||"pairOrientation",this.colorByTag=e.colorByTag,this.bamColorTag=void 0===e.bamColorTag?"YC":e.bamColorTag,this.sortOption=e.sortOption||{sort:"NUCLEOTIDE"},this.sortDirection=!0,this.hasPairs=!1},AlignmentTrack.prototype.computePixelHeight=function(e){if(e.packedAlignmentRows){var t=0;return e.hasDownsampledIntervals()&&(t+=10),t+this.alignmentRowHeight*e.packedAlignmentRows.length+5}return this.height},AlignmentTrack.prototype.draw=function(e){var i=this,o=e.features,a=e.context,s=e.bpPerPixel,l=e.bpStart,c=e.pixelWidth,h=l+c*s+1,u=o.packedAlignmentRows,f=o.sequence,p=0;function d(e,n,o){var c=r.call(i,e.firstAlignment),u=(e.connectingStart-l)/s,f=(e.connectingEnd-l)/s,p=n+o/2;e.connectingEnd<l||e.connectingStart>h||(e.mq<=0&&(c=t.Color.addAlpha(c,"0.15")),t.graphics.setProperties(a,{fillStyle:c,strokeStyle:c}),t.graphics.strokeLine(a,u,p,f,p))}function g(e,c,u){var p,d,g,m=r.call(i,e),v="alignmentColor",y=e.blocks;if(!(e.start+e.lengthOnRef<l||e.start>h))for(e.mq<=0&&(m=t.Color.addAlpha(m,"0.15")),t.graphics.setProperties(a,{fillStyle:m,strokeStyle:v}),g=0;g<y.length;g++)if(!((d=y[g]).start+d.len<l)){if(w(d),d.start+d.len>h)break;e.insertions&&e.insertions.forEach(function(e){var n=(e.start-l)/s-1;t.graphics.fillRect(a,n,c-1,3,u+2,{fillStyle:i.insertionColor})})}function w(r){var h,d,w,b,x,k,S,C,T,_=r.start-o.start,A=(r.start-l)/s,I=(r.start+r.len-l)/s,R=Math.max(1,I-A),P=i.alignmentRowHeight/2,E=r.seq.toUpperCase(),L=i.skippedColor,M=i.deletionColor,D=c+u/2;if(void 0!==r.gapType&&void 0!==I&&void 0!==p&&("D"===r.gapType?t.graphics.strokeLine(a,p,D,A,D,{strokeStyle:M}):t.graphics.strokeLine(a,p,D,A,D,{strokeStyle:L})),p=I,!0===e.strand&&g===y.length-1?(k=[A,I,I+P,I,A,A],S=[c,c,c+u/2,c+u,c+u,c],t.graphics.fillPolygon(a,k,S,{fillStyle:m}),i.highlightedAlignmentReadNamed===e.readName&&t.graphics.strokePolygon(a,k,S,{strokeStyle:"red"}),e.mq<=0&&t.graphics.strokePolygon(a,k,S,{strokeStyle:v})):!1===e.strand&&0===g?(k=[I,A,A-P,A,I,I],S=[c,c,c+u/2,c+u,c+u,c],t.graphics.fillPolygon(a,k,S,{fillStyle:m}),i.highlightedAlignmentReadNamed===e.readName&&t.graphics.strokePolygon(a,k,S,{strokeStyle:"red"}),e.mq<=0&&t.graphics.strokePolygon(a,k,S,{strokeStyle:v})):(t.graphics.fillRect(a,A,c,R,u,{fillStyle:m}),e.mq<=0&&(a.save(),a.strokeStyle=v,a.strokeRect(A,c,R,u),a.restore())),f&&"*"!==E)for(C=0,T=E.length;C<T;C++)_+C<0||(d=E.charAt(C),h=f.charAt(_+C),"="===d&&(d=h),"X"!==d&&h===d||(x=r.qual&&r.qual.length>C?n(r.qual[C],d,r.start):t.nucleotideColors[d])&&(w=(r.start+C-l)/s,b=Math.max(1,1/s),t.graphics.fillRect(a,w,c,b,u,{fillStyle:x})))}}this.top&&a.translate(0,this.top),f&&(f=f.toUpperCase()),o.hasDownsampledIntervals()?(p=10,o.downsampledIntervals.forEach(function(e){var n=(e.start-l)/s,i=(e.end-l)/s;i-n>5&&(n+=1,i-=1),t.graphics.fillRect(a,n,2,i-n,3,{fillStyle:"black"})})):p=0,this.alignmentsYOffset=p,u&&u.forEach(function(e,n){var r,o=p+i.alignmentRowHeight*n,a=i.alignmentRowHeight-2;for(n=0;n<e.alignments.length;n++)if(r=e.alignments[n],i.hasPairs=i.hasPairs||r.isPaired(),!(r.start+r.lengthOnRef<l)){if(r.start>h)break;!0!==r.hidden&&(r instanceof t.PairedAlignment?(d(r,o,a),g(r.firstAlignment,o,a),r.secondAlignment&&g(r.secondAlignment,o,a)):g(r,o,a))}})},AlignmentTrack.prototype.sortAlignmentRows=function(e,t){var n=this;this.featureSource.alignmentContainer.packedAlignmentRows.forEach(function(i){i.updateScore(e,n.featureSource.alignmentContainer,t)}),this.featureSource.alignmentContainer.packedAlignmentRows.sort(function(e,t){return!0===n.sortDirection?e.score-t.score:t.score-e.score})},AlignmentTrack.prototype.popupData=function(e){var t;return(t=this.getClickedObject(e.viewport,e.y,e.genomicLocation))?t.popupData(e.genomicLocation):void 0},AlignmentTrack.prototype.popupMenuItemList=function(e){var n,r,o,a,s,l,c,h,u,f,p,d;this.highlightedAlignmentReadNamed=void 0,e.popover.hide(),(n=this.getClickedObject(e.viewport,e.y,e.genomicLocation))&&(this.highlightedAlignmentReadNamed=n.readName,r=t.browser.genomicStateList.map(function(e){return e.locusSearchString}),a=e.viewport.genomicState.locusIndex,s=i.first(r,1+a),l=1===i.size(r)?void 0:i.last(r,i.size(r)-(1+a)),c=n,h=e.viewport,d=h.$viewport.width()*h.genomicState.referenceFrame.bpPerPixel,p=(c.start+(c.start+c.lengthOnRef))/2,u=c.chr+":"+Math.round(p-d/2).toString()+"-"+Math.round(p+d/2).toString(),p=(c.mate.position+(c.mate.position+c.lengthOnRef))/2,f=c.chr+":"+Math.round(p-d/2).toString()+"-"+Math.round(p+d/2).toString(),o=[u,f],s.splice(-1,1),Array.prototype.push.apply(s,o),l&&Array.prototype.push.apply(s,l),t.browser.search(s.join(" ")))},AlignmentTrack.prototype.getClickedObject=function(e,t,n){var i,r,o,a,s;if(i=e.cachedFeatures.features.packedAlignmentRows,r=e.cachedFeatures.features.downsampledIntervals,(o=Math.floor((t-this.top-this.alignmentsYOffset)/this.alignmentRowHeight))<0){for(s=0;s<r.length;s++)if(r[s].start<=n&&r[s].end>=n)return r[s]}else if(o<i.length&&(a=i[o].alignments.filter(function(e){return n>=e.start&&n<=e.start+e.lengthOnRef})).length>0)return a[0]};var o={fr:{F1R2:"LR",F2R1:"LR",F1F2:"LL",F2F1:"LL",R1R2:"RR",R2R1:"RR",R1F2:"RL",R2F1:"RL"},rf:{R1F2:"LR",R2F1:"LR",R1R2:"LL",R2R1:"LL",F1F2:"RR",F2F1:"RR",F1R2:"RL",F2R1:"RL"},ff:{F2F1:"LR",R1R2:"LR",F2R1:"LL",R1F2:"LL",R2F1:"RR",F1R2:"RR",R2R1:"RL",F1F2:"RL"}};return t}((Ae=function(e){function t(t){var n=[];return t.forEach(function(t){t.alignments.forEach(function(t){t instanceof e.PairedAlignment?(t.firstAlignment&&n.push(t.firstAlignment),t.secondAlignment&&n.push(t.secondAlignment)):n.push(t)})}),n}function n(t,n,i,r){if(t){if(0===t.length)return[];var o,a,s,l,c,h,u=[],f=0,p=0,d=[];for(t.sort(function(e,t){return e.start-t.start}),o=h=Math.max(n,t[0].start),t.forEach(function(e){var t=Math.max(0,e.start-h);void 0===u[t]&&(u[t]=[]),u[t].push(e)});f<t.length&&d.length<r;){for(a=new e.BamAlignmentRow;o<=i;){for(l=void 0;!l&&o<=i;)void 0===u[s=o-h]?++o:l=u[s];if(!l)break;c=l.pop(),0===l.length&&(u[s]=void 0),a.alignments.push(c),o=c.start+c.lengthOnRef+8,++f}if(a.alignments.length>0&&d.push(a),o=h,f===p)break;p=f}return d}}return e.BamSource=function(t){this.config=t,this.alignmentContainer=void 0,this.maxRows=t.maxRows||1e3,e.isFilePath(t.url)?console.log("ignore"):t.url&&t.url.startsWith("data:")&&(this.config.indexed=!1),"ga4gh"===t.sourceType?this.bamReader=new e.Ga4ghAlignmentReader(t):"pysam"===t.sourceType?this.bamReader=new e.BamWebserviceReader(t):"htsget"===t.sourceType?this.bamReader=new e.HtsgetReader(t):"shardedBam"===t.sourceType?this.bamReader=new e.ShardedBamReader(t):!1===this.config.indexed?this.bamReader=new e.BamReaderNonIndexed(t):this.bamReader=new e.BamReader(t),this.viewAsPairs=t.viewAsPairs},e.BamSource.prototype.setViewAsPairs=function(i){var r,o,a;if(this.viewAsPairs!==i&&(this.viewAsPairs=i,this.alignmentContainer)){var s,l=this.alignmentContainer;i?(r=l.packedAlignmentRows,o={},a=[],r.forEach(function(t){t.alignments.forEach(function(t){var n,i;(i=t).isPaired()&&i.isMateMapped()&&i.chr===i.mate.chr&&(i.isFirstOfPair()||i.isSecondOfPair())&&!i.isSecondary()&&!i.isSupplementary()?(n=o[t.readName])?(n.setSecondAlignment(t),o[t.readName]=void 0):(n=new e.PairedAlignment(t),o[t.readName]=n,a.push(n)):a.push(t)})}),s=a):s=t(l.packedAlignmentRows),l.packedAlignmentRows=n(s,l.start,l.end,this.maxRows)}},e.BamSource.prototype.getAlignments=function(i,r,o){var a,s=this;return s.alignmentContainer&&s.alignmentContainer.contains(i,r,o)?Promise.resolve(s.alignmentContainer):s.bamReader.readAlignments(i,r,o).then(function(i){var r=s.config.maxRows||500,o=i.alignments;return s.viewAsPairs||(o=t([{alignments:o}])),a=o.length>0,i.packedAlignmentRows=n(o,i.start,i.end,r),i.alignments=void 0,s.alignmentContainer=i,a?e.browser.genome.sequence.getSequence(i.chr,i.start,i.end).then(function(e){if(e)return i.coverageMap.refSeq=e,i.sequence=e,i}):i})},e}((Ae=function(e){return e.BamReaderNonIndexed=function(t){this.config=t,this.bamPath=t.url,this.isDataUri=t.url&&t.url.startsWith("data:"),e.BamUtils.setReaderDefaults(this,t)},e.BamReaderNonIndexed.prototype.readAlignments=function(t,n,i){var r=this;if(this.alignmentCache)return l(t,n,i);if(this.isDataUri){var o=function(e){var t,n=e.split(","),i=n[0].split(":")[1],r=n[1];r=i.indexOf("base64")>=0?atob(r):decodeURI(r);t=new Uint8Array(r.length);for(var o=0;o<r.length;o++)t[o]=r.charCodeAt(o);return t}(this.bamPath),a=e.unbgzf(o.buffer);return s(new Uint8Array(a)),Promise.resolve(l(t,n,i))}return e.xhr.loadArrayBuffer(r.bamPath,e.buildOptions(r.config)).then(function(r){var o=e.unbgzf(r);return s(new Uint8Array(o)),l(t,n,i)});function s(t){var n=[];r.header=e.BamUtils.decodeBamHeader(t),e.BamUtils.decodeBamRecords(t,r.header.size,n,r.header.chrNames),r.alignmentCache=new e.FeatureCache(n)}function l(t,n,i){var o,a,s,l;return a=(o=r.header).chrAliasTable.hasOwnProperty(t)?o.chrAliasTable[t]:t,s=r.alignmentCache.queryFeatures(a,n,i),l=new e.AlignmentContainer(t,n,i,r.samplingWindowSize,r.samplingDepth,r.pairsSupported),s.forEach(function(e){l.push(e)}),l.finish(),l}},e}((Ae=function(e){var t=65536;function n(){var t=this;return t.index?Promise.resolve(t.index):e.loadBamIndex(t.baiPath,t.config).then(function(e){return t.index=e,t.index})}return e.BamReader=function(t){this.config=t,this.bamPath=t.url,this.baiPath=t.indexURL||e.inferIndexPath(this.bamPath,"bai"),e.BamUtils.setReaderDefaults(this,t)},e.BamReader.prototype.readAlignments=function(i,r,o){var a=this;return function(){var i=this;return this.chrToIndex?Promise.resolve(this.chrToIndex):function(){var i=this;return n.call(i).then(function(n){var r=n.firstAlignmentBlock+t,o=e.buildOptions(i.config,{range:{start:0,size:r}}),a=e.browser?e.browser.genome:null;return e.BamUtils.readHeader(i.bamPath,o,a)}).then(function(e){return e})}.call(i).then(function(e){return i.chrToIndex=e.chrToIndex,i.indexToChr=e.chrNames,i.chrAliasTable=e.chrAliasTable,i.chrToIndex})}.call(a).then(function(t){var s,l,c;return l=a.chrAliasTable.hasOwnProperty(i)?a.chrAliasTable[i]:i,s=t[l],c=new e.AlignmentContainer(i,r,o,a.samplingWindowSize,a.samplingDepth,a.pairsSupported),void 0===s?Promise.resolve(c):n.call(a).then(function(t){var n=t.blocksForRange(s,r,o),i=[];return n?0===n.length?Promise.resolve(c):(n.forEach(function(t){i.push(new Promise(function(n,i){var l=t.minv.block,h={start:l,size:t.maxv.block+65e3-l+1};e.xhr.loadArrayBuffer(a.bamPath,e.buildOptions(a.config,{range:h})).then(function(i){var l=new Uint8Array(e.unbgzf(i));e.BamUtils.decodeBamRecords(l,t.minv.offset,c,a.indexToChr,s,r,o,a.filter),n(c)}).catch(i)}))}),Promise.all(i)):Promise.resolve(null)}).then(function(e){return c.finish(),c})})},e}((Ae=function(e){return e.loadBamIndex=function(t,n,i){return new Promise(function(r,a){var s=e.browser?e.browser.genome:null;e.xhr.loadArrayBuffer(t,e.buildOptions(n)).then(function(n){var a,l,c,h,u,f,p,d,g,m,v,y,w,b,x=[],k=Number.MAX_VALUE,S=0;if(n){if(i)n=new o.Gunzip(new Uint8Array(n)).decompress().buffer;if(!(21578050===(a=(u=new e.BinaryParser(new DataView(n))).getInt())||i&&21578324===a))throw new Error(t+" is not a "+(i?"tabix":"bai")+" file");if(h=u.getInt(),i){u.getInt(),u.getInt(),u.getInt(),u.getInt(),u.getInt(),u.getInt(),u.getInt();for(b={},y=0;y<h;y++){var C=u.getString();s&&(C=s.getChromosomeName(C)),b[C]=y}}for(w=0;w<h;w++){for(f={},p=[],l=u.getInt(),v=0;v<l;v++)if(37450===(d=u.getInt())){T=u.getInt(),g=u.getVPointer(),m=u.getVPointer();u.getLong(),u.getLong()}else{f[d]=[];var T=u.getInt();for(y=0;y<T;y++)g=u.getVPointer(),m=u.getVPointer(),g&&m&&(g.block<k&&(k=g.block),m.block>S&&(S=m.block),f[d].push([g,m]))}for(c=u.getInt(),y=0;y<c;y++)g=u.getVPointer(),p.push(g);l>0&&(x[w]={binIndex:f,linearIndex:p})}r(new e.BamIndex(x,k,S,b,i))}else r(null)}).catch(a)})},e.BamIndex=function(e,t,n,i,r){this.firstAlignmentBlock=t,this.lastAlignmentBlock=n,this.indices=e,this.sequenceIndexMap=i,this.tabix=r},e.BamIndex.prototype.blocksForRange=function(e,t,n){var i,r,o,a,s,l,c,h,u,f,p,d,g=this.indices[e];if(g){for(i=function(e,t){var n,i=[];t>=1<<29&&(t=1<<29);for(--t,i.push(0),n=1+(e>>26);n<=1+(t>>26);++n)i.push(n);for(n=9+(e>>23);n<=9+(t>>23);++n)i.push(n);for(n=73+(e>>20);n<=73+(t>>20);++n)i.push(n);for(n=585+(e>>17);n<=585+(t>>17);++n)i.push(n);for(n=4681+(e>>14);n<=4681+(t>>14);++n)i.push(n);return i}(t,n),r=[],i.forEach(function(e){if(g.binIndex[e])for(var t=g.binIndex[e],n=t.length,i=0;i<n;++i){var o=t[i][0],a=t[i][1];r.push({minv:o,maxv:a,bin:e})}}),o=g.linearIndex.length,a=null,s=Math.min(t>>14,o-1),l=Math.min(n>>14,o-1),h=s;h<=l;++h)(c=g.linearIndex[h])&&(a&&!c.isLessThan(a)||(a=c));return f=a,p=[],d=null,0===(u=r).length?u:(u.sort(function(e,t){var n=e.minv.block-t.minv.block;return 0!=n?n:e.minv.offset-t.minv.offset}),u.forEach(function(e){e.maxv.isGreaterThan(f)&&(null===d?(p.push(e),d=e):e.minv.block-d.maxv.block<65e3?e.maxv.isGreaterThan(d.maxv)&&(d.maxv=e.maxv):(p.push(e),d=e))}),p)}return[]},e}((Ae=((se=Ae||{}).BamAlignmentRow=function(){this.alignments=[],this.score=void 0},se.BamAlignmentRow.prototype.findCenterAlignment=function(e,t){var n=void 0;return this.alignments.forEach(function(i){void 0===n&&(i.start+i.lengthOnRef<e||i.start>t||(n=i))}),n},se.BamAlignmentRow.prototype.updateScore=function(e,t,n){this.score=this.calculateScore(e,1+e,t,n)},se.BamAlignmentRow.prototype.calculateScore=function(e,t,n,i){var r,o,a,s,l,c;return void 0===(s=this.findCenterAlignment(e,t))?Number.MAX_VALUE:(o=a=void 0,"NUCLEOTIDE"===i.sort?(s.blocks&&s.blocks.length>0&&(l=h(s.blocks,e,n.start))&&(o=u(l,n)),s.firstAlignment&&s.firstAlignment.blocks&&s.firstAlignment.blocks.length>0&&(l=h(s.firstAlignment.blocks,e,n.start))&&(o=u(l,n)),s.secondAlignment&&s.secondAlignment.blocks&&s.secondAlignment.blocks.length>0&&(c=h(s.secondAlignment.blocks,e,n.start))&&(a=u(c,n)),void 0===(r=void 0===o?a:o)?Number.MAX_VALUE:r):"STRAND"===i.sort?s.strand?1:-1:"START"===i.sort?s.start:Number.MAX_VALUE);function h(e,t,n){var i=void 0;return e.forEach(function(e){for(var r=0,o=e.start-n,a=e.start,s=e.seq.length;r<s;r++,o++,a++)t===a&&(i={block:e,blockSeqIndex:r,referenceSequenceIndex:o,location:t})}),i}function u(e,t){var n,i,r;return"*"===e.block.seq?3:(n=t.sequence.charAt(e.referenceSequenceIndex),"="===(i=e.block.seq.charAt(e.blockSeqIndex))&&(i=n),"N"===i?2:n===i?3:"X"===i||n!==i?-((r=t.coverageMap.coverage[e.location-t.coverageMap.bpStart])["pos"+i]+r["neg"+i]+(r.qual?r.qual:0)/1e3):void 0)}},se))||{}))||{}))||{}))||{}))||{}))||{}))||{}),Ae=function(e){return e.HtsgetReader=function(t){this.config=t,e.BamUtils.setReaderDefaults(this,t)},e.HtsgetReader.prototype.readAlignments=function(t,n,i,r){var o,a,s=this;return o=s.header&&s.header.chrAliasTable.hasOwnProperty(t)?s.header.chrAliasTable[t]:t,a=s.config.endpoint+"/reads/"+s.config.id+"?referenceName="+o+"&start="+n+"&end="+i,e.xhr.loadJson(a,s.config).then(function(t){return n=t.htsget.urls,i=[],n.forEach(function(t){if(t.url.startsWith("data:"))i.push(Promise.resolve(function(e){var t,n=e.split(","),i=n[0].split(":")[1],r=n[1];r=i.indexOf("base64")>=0?atob(r):decodeURI(r),t=new Uint8Array(r.length);for(var o=0;o<r.length;o++)t[o]=r.charCodeAt(o);return t}(t.url)));else{var n={};t.headers&&(n.headers=t.headers,n.headers.hasOwnProperty("referer")&&delete n.headers.referer),i.push(new Promise(function(i,r){e.xhr.loadArrayBuffer(t.url,n).then(function(e){i(new Uint8Array(e))})}))}}),Promise.all(i);var n,i}).then(function(a){var l,c,h,u,f,p,d,g,m;if(d=0,(p=a).forEach(function(e){d+=e.length}),m=0,g=new Uint8Array(d),p.forEach(function(e){g.set(e,m),m+=e.length}),l=g,c=e.unbgzf(l.buffer),h=new Uint8Array(c),!s.header){var v=e.browser?e.browser.genome:void 0;s.header=e.BamUtils.decodeBamHeader(h,v)}return void 0!==(f=s.header.chrToIndex[t])||o===s.header.chrAliasTable.hasOwnProperty(t)||r?(u=new e.AlignmentContainer(t,n,i,s.samplingWindowSize,s.samplingDepth,s.pairsSupported),e.BamUtils.decodeBamRecords(h,s.header.size,u,s.header.chrNames,f,n,i),u.finish(),u):(o=s.header.chrAliasTable[t],s.readAlignments(o,n,i,1))})},e}((Ae=function(e){function t(){this.posA=0,this.negA=0,this.posT=0,this.negT=0,this.posC=0,this.negC=0,this.posG=0,this.negG=0,this.posN=0,this.negN=0,this.pos=0,this.neg=0,this.qualA=0,this.qualT=0,this.qualC=0,this.qualG=0,this.qualN=0,this.qual=0,this.total=0}return e.CoverageMap=function(e,n,i,r,o){var a=this;this.refSeq=o,this.chr=e,this.bpStart=n,this.length=i-n,this.coverage=new Array(this.length),this.maximum=0,r.forEach(function(e){e.blocks.forEach(function(n){var i,r,o,s,l;for(o=n.start-a.bpStart,s=0;s<n.len;o++,s++)a.coverage[o]||(a.coverage[o]=new t),r=n.seq.charAt(s),i=e.strand?"pos"+r:"neg"+r,l=n.qual[s],a.coverage[o][i]+=1,a.coverage[o]["qual"+r]+=l,a.coverage[o].total+=1,a.coverage[o].qual+=l,a.maximum=Math.max(a.coverage[o].total,a.maximum)})})},e.CoverageMap.threshold=.2,e.CoverageMap.qualityWeight=!0,t.prototype.isMismatch=function(t){var n,i=this,r=e.CoverageMap.threshold*(e.CoverageMap.qualityWeight&&this.qual?this.qual:this.total);return n=0,["A","T","C","G"].forEach(function(r){r!==t&&(n+=e.CoverageMap.qualityWeight&&i.qual?i["qual"+r]:i["pos"+r]+i["neg"+r])}),n>=r},e}((Ae=((le=Ae||{}).unbgzf=function(e,t){var n=[],i=[0],r=0;for(t=t||e.byteLength-18;i[0]<t;){var o=new Uint8Array(e,i[0],18),a=o[11]<<8|o[10],s=(o[12],o[13],o[15],o[14],o[17]<<8|o[16]+1),l=12+a+i[0],c=e.byteLength-l;if(c<s+8)break;var h=K(e,l,c,i);i[0]+=8,r+=h.byteLength,n.push(h)}if(1==n.length)return n[0];for(var u=new Uint8Array(r),f=0,p=0;p<n.length;++p){var d=new Uint8Array(n[p]);j(d,0,u,f,d.length),f+=d.length}return u.buffer},le.BGZFile=function(e){this.filePosition=0,this.config=e},le.BGZFile.prototype.nextBlock=function(){var e=this;return new Promise(function(t,n){le.xhr.loadArrayBuffer(e.path,le.buildOptions(e.config,{range:{start:e.filePosition,size:18}})).then(function(i){var r=new Uint8Array(i),o=(r[11],r[10],r[12],r[13],r[15],r[14],r[17]<<8|r[16]+1);e.filePosition+=18,le.xhr.loadArrayBuffer(e.path,le.buildOptions(e.config,{range:{start:e.filePosition,size:o}})).then(function(n){var i=K(n);e.filePosition+=o+8,t(i)}).catch(n)}).catch(n)})},le))||{}))||{}),(ce=Ae||{}).PairedAlignment=function(e){this.firstAlignment=e,this.chr=e.chr,this.readName=e.readName,e.start<e.mate.position?(this.start=e.start,this.end=Math.max(e.mate.position,e.start+e.lengthOnRef),this.connectingStart=e.start+e.lengthOnRef,this.connectingEnd=e.mate.position):(this.start=e.mate.position,this.end=e.start+e.lengthOnRef,this.connectingStart=e.mate.position,this.connectingEnd=e.start),this.lengthOnRef=this.end-this.start},ce.PairedAlignment.prototype.setSecondAlignment=function(e){this.secondAlignment=e,e.start>this.firstAlignment.start?(this.end=e.start+e.lengthOnRef,this.connectingEnd=e.start):(this.start=e.start,this.connectingStart=e.start+e.lengthOnRef),this.lengthOnRef=this.end-this.start},ce.PairedAlignment.prototype.popupData=function(e){var t=[];return t=t.concat(this.firstAlignment.popupData(e)),this.secondAlignment&&(t.push("-------------------------------"),t=t.concat(this.secondAlignment.popupData(e))),t},ce.PairedAlignment.prototype.isPaired=function(){return!0},ce.PairedAlignment.prototype.firstOfPairStrand=function(){return this.firstAlignment.isFirstOfPair()?this.firstAlignment.strand:this.secondAlignment&&this.secondAlignment.isFirstOfPair()?this.secondAlignment.strand:this.firstAlignment.mate.strand},Ae=ce,(he=Ae||{}).ShardedBamReader=function(e){var t,n,i,r;this.config=e,i={},r={},t=he.browser?he.browser.genome:void 0,e.sources.sequences.forEach(function(e){i[e]=null,t&&(n=t.getChromosomeName(e),r[n]=e)}),this.chrAliasTable=r,this.bamReaders=i,he.BamUtils.setReaderDefaults(this,e)},he.ShardedBamReader.prototype.readAlignments=function(e,t,n){var i,r,o,a,s=this;return i=s.chrAliasTable.hasOwnProperty(e)?s.chrAliasTable[e]:e,this.bamReaders.hasOwnProperty(i)&&"none"!==this.bamReaders[i]?((r=s.bamReaders[i])||(o={url:s.config.sources.url.replace("$CHR",i)},s.config.sources.indexURL&&(o.indexURL=s.config.sources.indexURL.replace("$CHR",i)),a=Object.assign(s.config,o),r=new he.BamReader(a),s.bamReaders[i]=r),r.readAlignments(i,t,n).catch(function(r){return console.error(r),he.presentAlert("Error reading BAM or index file for: "+o.url),s.bamReaders[i]="none",new he.AlignmentContainer(e,t,n)})):Promise.resolve(new he.AlignmentContainer(e,t,n))},Ae=he,(ue=Ae||{}).isb={querySegByStudy:function(e,t){var n='SELECT * FROM [isb-cgc:tcga_201510_alpha.Copy_Number_segments] WHERE ParticipantBarcode IN (SELECT ParticipantBarcode FROM [isb-cgc:tcga_201510_alpha.Clinical_data] WHERE Study = "'+e+'")';return t&&(n+=" limit "+t),n},decodeSeg:function(e){var t={};return t.ParticipantBarcode=e.f[0].v,t.Study=e.f[4].v,t.Chromosome=e.f[6].v,t.Start=e.f[7].v,t.End=e.f[8].v,t.Num_Probes=e.f[9].v,t.Segment_mean=e.f[10].v,t}},Ae=ue,Ae=function(e){var t=64;function n(e,t){this.index=e,this.reductionLevel=t.getInt(),this.reserved=t.getInt(),this.dataOffset=t.getLong(),this.indexOffset=t.getLong()}function i(e,t,n,i){this.config=n,this.filesize=t,this.fileOffset=e,this.path=n.url,this.littleEndian=i}function r(e){this.items=e;var t,n,i=Number.MAX_VALUE,r=0,o=Number.MAX_VALUE,a=0;for(t=0;t<e.length;t++)n=e[t],i=Math.min(i,n.startChrom),r=Math.max(r,n.endChrom),o=Math.min(o,n.startBase),a=Math.max(a,n.endBase);this.startChrom=i,this.endChrom=r,this.startBase=o,this.endBase=a}function a(e,t,n,i,r){return e?(i>e.startChrom||i==e.startChrom&&r>=e.startBase)&&(t<e.endChrom||t==e.endChrom&&n<=e.endBase):(console.log("null item"),!1)}function s(e){e?(this.basesCovered=e.getLong(),this.minVal=e.getDouble(),this.maxVal=e.getDouble(),this.sumData=e.getDouble(),this.sumSquares=e.getDouble(),l.call(this)):(this.basesCovered=0,this.minVal=0,this.maxVal=0,this.sumData=0,this.sumSquares=0,this.mean=0,this.stddev=0)}function l(){var e=this.basesCovered;if(e>0){this.mean=this.sumData/e,this.stddev=Math.sqrt(this.sumSquares/(e-1));this.minVal<0&&(this.mean,this.stddev),this.maxVal>0&&(this.mean,this.stddev);this.defaultRange={min:0,max:this.mean+3*this.stddev}}}function c(t,n,i,r,o,a,s){var l,c,h=new e.BinaryParser(t),u=h.getInt(),f=h.getInt(),p=h.getInt(),d=h.getInt(),g=h.getInt(),m=h.getByte(),v=(h.getByte(),h.getUShort());if(u>=n&&u<=r)for(;v-- >0;){switch(m){case 1:f=h.getInt(),p=h.getInt(),l=h.getFloat();break;case 2:f=h.getInt(),l=h.getFloat(),p=f+g;break;case 3:l=h.getFloat(),p=f+g,f+=d}if(!(u<n||u===n&&p<i)){if(u>r||u===r&&f>=o)break;Number.isFinite(l)&&(c=s[u],a.push({chr:c,start:f,end:p,value:l}))}}}function h(t,n,i,r,o,a,s){for(var l,c,h,u,f,p,d,g,m,v,y,w,b,x=new e.BinaryParser(t);x.remLength()>=13;)if(b=s[l=x.getInt()],c=x.getInt(),h=x.getInt(),u=x.getString(),!(l<n||l===n&&h<i)){if(l>r||l===r&&c>=o)break;if(p={chr:b,start:c,end:h},a.push(p),(f=u.split("\t")).length>0&&(p.name=f[0]),f.length>1&&(p.score=parseFloat(f[1])),f.length>2&&(p.strand=f[2]),f.length>3&&(p.cdStart=parseInt(f[3])),f.length>4&&(p.cdEnd=parseInt(f[4])),f.length>5&&"."!==f[5]&&"0"!==f[5]&&(p.color=e.Color.createColorString(f[5])),f.length>8){d=parseInt(f[6]),g=f[7].split(","),m=f[8].split(","),v=[];for(var k=0;k<d;k++)w=(y=start+parseInt(m[k]))+parseInt(g[k]),v.push({start:y,end:w});p.exons=v}}}function u(t,n,i,r,o,a,s,l){for(var c,h,u,f,p,d,g,m,v,y=new e.BinaryParser(t);y.remLength()>=32;){switch(v=s[c=y.getInt()],h=y.getInt(),u=y.getInt(),f=y.getInt(),p=y.getFloat(),d=y.getFloat(),g=y.getFloat(),y.getFloat(),l){case"min":m=p;break;case"max":m=d;break;default:m=0==f?0:g/f}if(!(c<n||c===n&&u<i)){if(c>r||c===r&&h>=o)break;Number.isFinite(m)&&a.push({chr:v,start:h,end:u,value:m})}}}return e.BWReader=function(e){this.path=e.url,this.headPath=e.headURL||this.path,this.rpTreeCache={},this.config=e},e.BWReader.prototype.readWGFeatures=function(e,t,n){var i=this;return i.getZoomHeaders().then(function(e){var r,o,a;return 0,r=i.chromTree.idToChrom.length-1,o=i.chromTree.idToChrom[0],a=i.chromTree.idToChrom[r],i.readFeatures(o,0,a,Number.MAX_VALUE,t,n)})},e.BWReader.prototype.readFeatures=function(t,n,i,r,a,s){var l,f,p,d=this,g=new e.BufferedReader(d.config);return d.getZoomHeaders().then(function(e){var t,n=function(e,t){var n,i,r=null;for(n=0;n<t.length;n++)if((i=t[n]).reductionLevel<e){r=i;break}return r}(a,e);return n?(t=n.indexOffset,l=u):(t=d.header.fullIndexOffset,l="BigWig"===d.type?c:h),d.loadRPTree(t)}).then(function(e){return f=d.chromTree.chromToID[t],p=d.chromTree.chromToID[i],void 0===f||void 0===p?void 0:e.findLeafItemsOverlapping(f,n,p,r)}).then(function(e){var t=[];return e&&0!=e.length?(e.forEach(function(e){t.push(g.dataViewForRange({start:e.dataOffset,size:e.dataSize},!0).then(function(e){var t=[],i=new o.Inflate(e).decompress();return l(new DataView(i.buffer),f,n,p,r,t,d.chromTree.idToChrom,s),t}))}),Promise.all(t)):[]}).then(function(e){var t=[];return(t=t.concat.apply(t,e)).sort(function(e,t){return e.start-t.start}),t})},e.BWReader.prototype.getZoomHeaders=function(){var e=this;return e.zoomLevelHeaders?Promise.resolve(e.zoomLevelHeaders):e.loadHeader().then(function(){return e.zoomLevelHeaders})},e.BWReader.prototype.loadHeader=function(){var i=this;return e.xhr.loadArrayBuffer(i.path,e.buildOptions(i.config,{range:{start:0,size:t}})).then(function(t){var n;i.littleEndian=!0;var r=new e.BinaryParser(new DataView(t));if(2291137574===(o=r.getUInt()))i.type="BigWig";else if(2273964779==o)i.type="BigBed";else{var o;i.littleEndian=!1,r.littleEndian=!1,r.position=0,654085990===(o=r.getUInt())?i.type="BigWig":3958540679==o&&(i.type="BigBed")}return(n={}).bwVersion=r.getUShort(),n.nZoomLevels=r.getUShort(),n.chromTreeOffset=r.getLong(),n.fullDataOffset=r.getLong(),n.fullIndexOffset=r.getLong(),n.fieldCount=r.getUShort(),n.definedFieldCount=r.getUShort(),n.autoSqlOffset=r.getLong(),n.totalSummaryOffset=r.getLong(),n.uncompressBuffSize=r.getInt(),n.reserved=r.getLong(),n}).then(function(r){return i.header=r,function(){var i=t,r=this,o={start:i,size:r.header.fullDataOffset-i+5};return e.xhr.loadArrayBuffer(r.path,e.buildOptions(r.config,{range:o})).then(function(t){var o,a,l,c=r.header.nZoomLevels,h=new e.BinaryParser(new DataView(t));for(r.zoomLevelHeaders=[],r.firstZoomDataOffset=Number.MAX_VALUE,o=1;o<=c;o++)l=new n(a=c-o,h),r.firstZoomDataOffset=Math.min(l.dataOffset,r.firstZoomDataOffset),r.zoomLevelHeaders[a]=l;return r.header.autoSqlOffset>0&&(h.position=r.header.autoSqlOffset-i,r.autoSql=h.getString()),r.header.totalSummaryOffset>0&&(h.position=r.header.totalSummaryOffset-i,r.totalSummary=new s(h)),r.header.chromTreeOffset>0&&(h.position=r.header.chromTreeOffset-i,r.chromTree=new function(t,n){var i=e.browser?e.browser.genome:null,r=(t.getInt(),t.getInt(),t.getInt()),o=(t.getInt(),t.getLong(),t.getLong(),{}),a=[];this.chromToID=o,this.idToChrom=a,function e(t,s){s>=0&&(t.position=s);var l,c,h,u,f,p,d=t.getByte(),g=(t.getByte(),t.getUShort());if(1==d)for(l=0;l<g;l++)c=t.getFixedLengthTrimmedString(r),h=t.getInt(),t.getInt(),i&&(c=i.getChromosomeName(c)),o[c]=h,a[h]=c;else for(l=0;l<g;l++)c=t.getFixedLengthTrimmedString(r),u=t.getLong(),f=u-n,p=t.position,e(t,f),t.position=p}(t,-1)}(h,i)),h.position=r.header.fullDataOffset-i,r.dataCount=h.getInt(),r.header})}.call(i)})},e.BWReader.prototype.loadRPTree=function(e){var t=this.rpTreeCache[e];return t?Promise.resolve(t):(t=new i(e,this.contentLength,this.config,this.littleEndian),this.rpTreeCache[e]=t,t.load())},i.prototype.load=function(){var t=this,n=t.fileOffset+48,i=new e.BufferedReader(t.config,t.filesize,512e3);return t.readNode(n,i).then(function(e){return t.rootNode=e,t})},i.prototype.readNode=function(t,n){var i,o,a=this;return n.dataViewForRange({start:t,size:4},!1).then(function(r){var s,l;l=(s=new e.BinaryParser(r,a.littleEndian)).getByte(),o=1===l,s.getByte(),i=s.getUShort();var c={start:t+=4,size:i*(o?32:24)};return n.dataViewForRange(c,!1)}).then(function(t){var n,a=new Array(i),s=new e.BinaryParser(t);if(o){for(n=0;n<i;n++){var l={isLeaf:!0,startChrom:s.getInt(),startBase:s.getInt(),endChrom:s.getInt(),endBase:s.getInt(),dataOffset:s.getLong(),dataSize:s.getLong()};a[n]=l}return new r(a)}for(n=0;n<i;n++){l={isLeaf:!1,startChrom:s.getInt(),startBase:s.getInt(),endChrom:s.getInt(),endBase:s.getInt(),childOffset:s.getLong()};a[n]=l}return new r(a)})},i.prototype.findLeafItemsOverlapping=function(t,n,i,r){var o=this;return new Promise(function(s,l){var c=[],h=new Set,u=new e.BufferedReader(o.config,o.filesize,512e3);h.add(0),function e(f,p){if(a(f,t,n,i,r)){var d=f.items;d.forEach(function(s){a(s,t,n,i,r)&&(s.isLeaf?c.push(s):s.childNode?e(s.childNode):(h.add(s.childOffset),o.readNode(s.childOffset,u).then(function(t){s.childNode=t,e(t,s.childOffset)}).catch(l)))})}null!=p&&h.delete(p);0===h.size&&s(c)}(o.rootNode,0)})},s.prototype.updateStats=function(e){this.basesCovered+=e.count,this.sumData+=status.sumData,this.sumSquares+=sumSquares,this.minVal=MIN(_minVal,min),this.maxVal=MAX(_maxVal,max),l.call(this)},e}((Ae=((fe=Ae||{}).BufferedReader=function(e,t,n){this.path=e.url,this.contentLength=t,this.bufferSize=n||512e3,this.range={start:-1,size:-1},this.config=e},fe.BufferedReader.prototype.dataViewForRange=function(e,t){var n,i,r=this;return r.data&&r.range.start<=e.start&&r.range.start+r.range.size>=e.start+e.size?Promise.resolve(o(r,e,t)):(n=e.size?Math.max(r.bufferSize,e.size):r.bufferSize,i=r.contentLength>0&&e.start+n>r.contentLength?{start:e.start}:{start:e.start,size:n},fe.xhr.loadArrayBuffer(r.path,fe.buildOptions(r.config,{range:i})).then(function(n){return r.data=n,r.range=i,o(r,e,t)}));function o(e,t,n){var i=e.data.byteLength,r=t.start-e.range.start;return n?new Uint8Array(e.data,r,i-r):new DataView(e.data,r,i-r)}},fe))||{}),Ae=function(e){var t=new Set(["fastaURL","indexURL","cytobandURL","indexed"]);return e.FastaSequence=function(e){e.fastaURL.startsWith("data:")?(this.file=function(e){var t,n=e.split(","),i=n[0].split(":")[1],r=n[1];r=i.indexOf("base64")>=0?atob(r):decodeURI(r);t=new Uint8Array(r.length);for(var a=0;a<r.length;a++)t[a]=r.charCodeAt(a);var s=new o.Gunzip(t).decompress();return String.fromCharCode.apply(null,s)}(e.fastaURL),this.indexed=!1,this.isDataURI=!0):(this.file=e.fastaURL,this.indexed=!1!==e.indexed,this.indexed&&(this.indexFile=e.indexURL||e.indexFile||this.file+".fai")),this.withCredentials=e.withCredentials,this.config=function(e){var n,i={};for(n in e)e.hasOwnProperty(n)&&!t.has(n)&&(i[n]=e[n]);return i}(e)},e.FastaSequence.prototype.init=function(){var t=this;return t.indexed?new Promise(function(n,i){t.getIndex().then(function(i){var r=0;t.chromosomes={},t.chromosomeNames.forEach(function(n){var i=t.index[n].size;t.chromosomes[n]=new e.Chromosome(n,r++,i)}),n()}).catch(i)}):t.loadAll()},e.FastaSequence.prototype.getSequence=function(t,n,i){var r;return(r=e.browser?e.browser.genome:void 0)&&(t=r.getChromosomeName(t)),this.indexed?function(t,n,i){var r=this;return new Promise(function(o,a){var s=r.interval;if(s&&s.contains(t,n,i))o(f(s,n,i));else{var l=n,c=i;if(i-n<1e5){var h=i-n,u=Math.round(n+h/2);l=Math.max(0,u-5e4),c=u+5e4}r.readSequence(t,l,c).then(function(a){r.interval=new e.GenomicInterval(t,l,c,a),o(f(r.interval,n,i))}).catch(a)}function f(e,t,n){var i=t-e.start,r=n-t,o=e.features?e.features.substr(i,r):null;return o}})}.call(this,t,n,i):function(e,t,n){var i=this.sequences[e];return i&&i.length>=n?Promise.resolve(i.substring(t,n)):Promise.resolve("")}.call(this,t,n,i)},e.FastaSequence.prototype.getIndex=function(){var t=this;return new Promise(function(n,i){t.index?n(t.index):e.xhr.load(t.indexFile,e.buildOptions(t.config)).then(function(e){var i=e.splitLines(),r=i.length,o=0;for(t.chromosomeNames=[],t.index={};o<r;){var a=i[o++].split("\t");if(5==a.length){var s=a[0],l={size:parseInt(a[1]),position:parseInt(a[2]),basesPerLine:parseInt(a[3]),bytesPerLine:parseInt(a[4])};t.chromosomeNames.push(s),t.index[s]=l}}n&&n(t.index)}).catch(i)})},e.FastaSequence.prototype.loadAll=function(){var t=this;return this.isDataURI?Promise.resolve(n(this.file)):e.xhr.load(t.file,e.buildOptions(t.config)).then(n);function n(n){t.chromosomeNames=[],t.chromosomes={},t.sequences={};for(var i,r,o=n.splitLines(),a=o.length,s=0,l="",c=0;s<a;)(i=o[s++].trim()).startsWith("#")||0===i.length||(i.startsWith(">")?(l&&(t.chromosomeNames.push(r),t.sequences[r]=l,t.chromosomes[r]=new e.Chromosome(r,c++,l.length)),r=i.substr(1).split("\\s+")[0],l=""):l+=i);l&&(t.chromosomeNames.push(r),t.sequences[r]=l,t.chromosomes[r]=new e.Chromosome(r,c++,l.length))}},e.FastaSequence.prototype.readSequence=function(t,n,i){var r=this;return new Promise(function(o,a){r.getIndex().then(function(){var s=r.index[t];if(s){var l=Math.max(0,n),c=Math.min(s.size,i),h=s.bytesPerLine,u=s.basesPerLine,f=s.position,p=h-u,d=Math.floor(l/u),g=Math.floor(c/u),m=l-d*u,v=f+d*h+m,y=f+g*h+(c-g*u)-1-v+1;y<=0&&o(null),e.xhr.load(r.file,e.buildOptions(r.config,{range:{start:v,size:y}})).then(function(e){var t,n="",i=0,r=e.length;for(m>0&&(t=Math.min(c-l,u-m),n+=e.substr(i,t),i+=t+p,t);i<r;)t=Math.min(u,r-i),n+=e.substr(i,t),i+=t+p,t;o(n)}).catch(a)}else console.log("No index entry for chr: "+t),r.interval=new e.GenomicInterval(t,n,i,null),o(null)}).catch(a)})},e}((Ae=function(e){function t(e,t){var n,i,r,o,a,s;return n=e.Assembly,i=t.Assembly,r=e["Cell Type"],o=t["Cell Type"],a=e.Target,s=t.Target,n===i?r===o?a===s?0:a<s?-1:1:r<o?-1:1:n<i?-1:1}return e.EncodeDataSource=function(e){this.columnFormat=e},e.EncodeDataSource.prototype.retrieveData=function(n){var r,o,a;return"bigWig",r=n,e.xhr.loadJson((o=r,a="bigWig","https://www.encodeproject.org/search/?type=experiment&assembly="+o+"&files.file_format="+a+"&format=json&field=lab.title&field=biosample_term_name&field=assay_term_name&field=target.label&field=files.file_format&field=files.output_type&field=files.href&field=files.replicate.technical_replicate_number&field=files.replicate.biological_replicate_number&field=files.assembly&limit=all"),{}).then(function(e){return t=e,n=r,o="bigWig",a=[],i.each(t["@graph"],function(e){var t,r,s,l;t=e.biosample_term_name||"",r=e.target?e.target.label:"",s=i.filter(e.files,function(e){return o===e.file_format&&n===e.assembly}),l=i.map(s,function(n){var i=n.replicate?n.replicate.bioligcal_replicate_number:void 0,o=n.replicate?n.replicate.technical_replicate_number:void 0,a=t+" "+r;return i&&(a+=" "+i),o&&(a+=(i?":":"0:")+o),{Assembly:n.assembly,ExperimentID:e["@id"],"Cell Type":t,"Assay Type":e.assay_term_name,Target:r,Lab:e.lab?e.lab.title:"",Format:n.file_format,"Output Type":n.output_type,url:"https://www.encodeproject.org"+n.href,"Bio Rep":i,"Tech Rep":o,Name:a}}),Array.prototype.push.apply(a,l)}),i.map(a,function(e){return i.mapObject(e,function(e){return void 0===e||""===e?"-":e})});var t,n,o,a}).then(function(e){return e.sort(t),Promise.resolve(e)})},e.EncodeDataSource.prototype.tableData=function(e){var t=this;return i.map(e,function(e){return i.values(i.pick(e,i.map(t.columnFormat,function(e){return i.first(i.keys(e))})))})},e.EncodeDataSource.prototype.tableColumns=function(){return i.map(this.columnFormat,function(e){return{title:i.first(i.keys(e)),width:i.first(i.values(e))}})},e.EncodeDataSource.prototype.dataAtRowIndex=function(e,t){var n;return{url:(n=e[t]).url,color:function(e){var t,n;t={DEFAULT:"rgb(3, 116, 178)",H3K27AC:"rgb(200, 0, 0)",H3K27ME3:"rgb(130, 0, 4)",H3K36ME3:"rgb(0, 0, 150)",H3K4ME1:"rgb(0, 150, 0)",H3K4ME2:"rgb(0, 150, 0)",H3K4ME3:"rgb(0, 150, 0)",H3K9AC:"rgb(100, 0, 0)",H3K9ME1:"rgb(100, 0, 0)"},n=void 0===e||""===e||"-"===e?"DEFAULT":e.toUpperCase();return t[n]}(n.Target),name:n.Name}},e}((Ae=function(t){return t.Browser=function(n,i){this.config=n,t.browser=this,t.browser.$root=e('<div id="igvRootDiv" class="igv-root-div">'),function(e){this.flanking=e.flanking,this.type=e.type||"IGV",this.crossDomainProxy=e.crossDomainProxy,this.formats=e.formats,this.trackDefaults=e.trackDefaults,e.search?this.searchConfig={type:"json",url:e.search.url,coords:void 0===e.search.coords?1:e.search.coords,chromosomeField:e.search.chromosomeField||"chromosome",startField:e.search.startField||"start",endField:e.search.endField||"end",geneField:e.search.geneField||"geneSymbol",snpField:e.search.snpField||"snp",resultsField:e.search.resultsField}:(e.reference&&e.reference.id?e.reference.id:e.genome?e.genome:"hg19",this.searchConfig={type:"plain",url:"https://portals.broadinstitute.org/webservices/igv/locus?genome=$GENOME$&name=$FEATURE$",coords:0,chromosomeField:"chromosome",startField:"start",endField:"end"})}.call(this,n),e("input[id='trackHeightInput']").val(this.trackHeight),this.trackContainerDiv=i,this.trackViews=[],this.trackLabelsVisible=!0,this.featureDB={},this.constants={dragThreshold:3,defaultColor:"rgb(0,0,150)",doubleClickDelay:n.doubleClickDelay||500},this.eventHandlers={},function(){var n=this;window.onresize=t.throttle(function(){n.resize()},10),e(document).on("mousedown.browser",function(e){n.isMouseDown=!0}),e(document).on("mouseup.browser",function(e){n.isMouseDown=void 0,n.dragTrackView&&n.dragTrackView.$trackDragScrim.hide(),n.dragTrackView=void 0}),e(document).on("click.browser",function(e){var i=e.target;n.$root.get(0).contains(i)||t.popover.hide()}),e(this.trackContainerDiv).on("mousemove.cursorTrackingGuide",t.throttle(function(e){var i;e.preventDefault(),i=Math.max(50,t.translateMouseCoordinates(e,n.trackContainerDiv).x-5),i=Math.min(n.trackContainerDiv.clientWidth-65,i),n.$cursorTrackingGuide.css({left:i+"px"})},10))}.call(this)},t.Browser.hasKnownFileExtension=function(e){var n=t.getExtension(e);return void 0!==n&&t.Browser.knownFileExtensions.has(n)},t.Browser.prototype.disableZoomWidget=function(){this.$zoomContainer.hide()},t.Browser.prototype.enableZoomWidget=function(){this.$zoomContainer.show()},t.Browser.prototype.toggleCursorGuide=function(e){i.size(e)>1||"all"===i.first(e).locusSearchString.toLowerCase()?(this.$cursorTrackingGuide.is(":visible")&&this.$cursorTrackingGuideToggle.click(),this.$cursorTrackingGuideToggle.hide()):this.$cursorTrackingGuideToggle.show()},t.Browser.prototype.toggleCenterGuide=function(e){i.size(e)>1||"all"===i.first(e).locusSearchString.toLowerCase()?(this.centerGuide.$container.is(":visible")&&this.centerGuide.$centerGuideToggle.click(),this.centerGuide.$centerGuideToggle.hide()):this.centerGuide.$centerGuideToggle.show()},t.Browser.prototype.loadTracksWithConfigList=function(e){var t=this,n=[];return e.forEach(function(e){var i=t.loadTrack(e);i&&n.push(i)}),this.trackViews.forEach(function(e){e.resize()}),n},t.Browser.prototype.loadTrack=function(e){var n,i,r,o=this;if(t.inferTrackTypes(e),this.trackDefaults&&e.type&&(n=this.trackDefaults[e.type]))for(i in n)n.hasOwnProperty(i)&&void 0===e[i]&&(e[i]=n[i]);return void 0===(r=t.createTrack(e))?(t.presentAlert("Unknown file type: "+e.url,void 0),r):(void 0===r.order&&(r.order=this.trackViews.length),"function"==typeof r.getFileHeader?r.getFileHeader().then(function(e){o.addTrack(r)}).catch(function(e){t.presentAlert(e)}):o.addTrack(r),r)},t.Browser.prototype.addTrack=function(n){var i;void 0!==t.popover&&t.popover.hide(),i=new t.TrackView(this,e(this.trackContainerDiv),n),this.trackViews.push(i),this.reorderTracks(),i.update()},t.Browser.prototype.reorderTracks=function(){var t=this;this.trackViews.sort(function(e,t){return(e.track.order||0)-(t.track.order||0)}),e(this.trackContainerDiv).children("igv-track-div").detach(),this.trackViews.forEach(function(e){t.trackContainerDiv.appendChild(e.trackDiv)})},t.Browser.prototype.removeTrackByName=function(e){var t;t=i.first(i.filter(this.trackViews,function(t){return e===t.track.name})),this.removeTrack(t.track)},t.Browser.prototype.removeTrack=function(e){for(var t,n=0;n<this.trackViews.length;n++)if(e===this.trackViews[n].track){t=this.trackViews[n];break}t&&(this.trackViews.splice(n,1),this.trackContainerDiv.removeChild(t.trackDiv),this.fireEvent("trackremoved",[t.track]))},t.Browser.prototype.findTracks=function(e,t){var n=[];return this.trackViews.forEach(function(i){t===i.track[e]&&n.push(i.track)}),n},t.Browser.prototype.reduceTrackOrder=function(e){var t,n,i=[];1!==this.trackViews.length&&(this.trackViews.forEach(function(n,r,o){i.push({trackView:n,index:r}),e===n&&(t=i[r])}),0!==t.index&&(n=t.trackView.track.order,t.trackView.track.order=i[t.index-1].trackView.track.order,i[t.index-1].trackView.track.order=n,this.reorderTracks()))},t.Browser.prototype.increaseTrackOrder=function(e){var t,n,i=[];1!==this.trackViews.length&&(this.trackViews.forEach(function(n,r,o){i.push({trackView:n,index:r}),e===n&&(t=i[r])}),this.trackViews.length-1!==t.index&&(n=t.trackView.track.order,t.trackView.track.order=i[1+t.index].trackView.track.order,i[1+t.index].trackView.track.order=n,this.reorderTracks()))},t.Browser.prototype.setTrackHeight=function(e){this.trackHeight=e,this.trackViews.forEach(function(t){t.setTrackHeight(e)})},t.Browser.prototype.resize=function(){var e;!0===function(e){var t,n,r,o,a;i.size(e)>0?(n=i.first(e),i.size(n.viewports)>0?(r=i.first(n.viewports),o=r.$viewport.width(),a=r.genomicState.referenceFrame.bpPerPixel,t=o*a>r.genomicState.chromosome.bpLength):t=!1):t=!1;return t}(this.trackViews)?(e=i.first(i.first(this.trackViews).viewports),this.search(e.genomicState.chromosome.name)):i.each(i.union([this.ideoPanel,this.karyoPanel,this.centerGuide],this.trackViews),function(e){e&&e.resize()})},t.Browser.prototype.repaint=function(){i.each(i.union([this.ideoPanel,this.karyoPanel,this.centerGuide],this.trackViews),function(e){e&&e.repaint()})},t.Browser.prototype.repaintWithLocusIndex=function(e){this.karyoPanel&&this.karyoPanel.repaint(),this.ideoPanel&&t.IdeoPanel.repaintPanel(this.ideoPanel.panelWithLocusIndex(e)),i.each(t.Viewport.viewportsWithLocusIndex(e),function(e){e.repaint()})},t.Browser.prototype.update=function(){this.updateLocusSearchWidget(i.first(this.genomicStateList)),this.windowSizePanel.updateWithGenomicState(i.first(this.genomicStateList)),i.each([this.ideoPanel,this.karyoPanel,this.centerGuide],function(e){e&&e.repaint()}),i.each(this.trackViews,function(e){e.update()})},t.Browser.prototype.updateWithLocusIndex=function(e){t.browser.updateLocusSearchWidget(i.first(this.genomicStateList)),0===e&&this.windowSizePanel.updateWithGenomicState(this.genomicStateList[e]),this.ideoPanel&&t.IdeoPanel.repaintPanel(this.ideoPanel.panelWithLocusIndex(e)),this.karyoPanel&&this.karyoPanel.repaint(),i.each(t.Viewport.viewportsWithLocusIndex(e),function(e){e.update()}),this.centerGuide&&this.centerGuide.repaint()},t.Browser.prototype.loadInProgress=function(){var e;return e=!1,i.each(this.trackViews,function(t){!1===e&&(e=t.isLoading())}),e},t.Browser.prototype.updateLocusSearchWidget=function(e){var n,i,r,o,a,s;0===e.locusIndex&&1===e.locusCount?"all"===e.locusSearchString.toLowerCase()?(this.$searchInput.val(e.locusSearchString),this.chromosomeSelectWidget.$select.val("all")):(n=e.referenceFrame,this.chromosomeSelectWidget.$select.val(n.chrName),this.$searchInput&&(a=n.start+n.bpPerPixel*(this.viewportContainerWidth()/e.locusCount),this.genome&&(s=this.genome.getChromosome(n.chrName))&&(a=Math.min(a,s.bpLength)),i=t.numberFormatter(Math.floor(n.start+1)),r=t.numberFormatter(Math.floor(a)),o=n.chrName+":"+i+"-"+r,this.$searchInput.val(o)),this.fireEvent("locuschange",[n,o])):this.$searchInput.val("")},t.Browser.prototype.syntheticViewportContainerBBox=function(){var t,n=e(this.trackContainerDiv),i=e('<div class="igv-track-div">'),r=e('<div class="igv-viewport-container igv-viewport-container-shim">');return n.append(i),i.append(r),t={position:r.position(),width:r.width(),height:r.height()},i.remove(),t},t.Browser.prototype.syntheticViewportContainerWidth=function(){return this.syntheticViewportContainerBBox().width},t.Browser.prototype.viewportContainerWidth=function(){return this.trackViews&&this.trackViews.length>0?this.trackViews[0].$viewportContainer.width():this.syntheticViewportContainerWidth()},t.Browser.prototype.minimumBasesExtent=function(){return this.config.minimumBases},t.Browser.prototype.goto=function(e,n,r){var o,a,s,l,c;t.popover&&t.popover.hide(),void 0!==this.genome?((o=i.first(this.genomicStateList)).chromosome=this.genome.getChromosome(e),a=t.browser.viewportContainerWidth()/o.locusCount,(s=o.referenceFrame).chrName=o.chromosome.name,void 0===r?(l=Math.round(a*s.bpPerPixel/2),n=Math.max(0,n-l)):s.bpPerPixel=(r-n)/a,o.chromosome?(o.chromosome.bpLength||(o.chromosome.bpLength=1),c=o.chromosome.bpLength/a,s.bpPerPixel>c&&(s.bpPerPixel=c),void 0===r&&(r=n+a*s.bpPerPixel),o.chromosome&&r>o.chromosome.bpLength&&(n-=r-o.chromosome.bpLength)):console&&console.log&&console.log("Could not find chromsome "+s.chrName),s.start=n,this.update()):console.log("Missing genome - bailing ...")},t.Browser.prototype.zoomIn=function(){var e=this;this.loadInProgress()||i.each(i.range(i.size(this.genomicStateList)),function(t){!function(e,t){var n,i,r,o=e.genomicStateList[t],a=o.referenceFrame,s=Math.floor(e.viewportContainerWidth()/o.locusCount);if(i=e.minimumBasesExtent(),l=s,c=a.bpPerPixel/2,r=Math.floor(l*c),i>r)return;var l,c;n=a.start+a.bpPerPixel*(s/2),a.start=n-s/2*(a.bpPerPixel/2),a.bpPerPixel/=2,e.updateWithLocusIndex(t)}(e,t)})},t.Browser.prototype.zoomOut=function(){var e=this;this.loadInProgress()||i.each(i.range(i.size(this.genomicStateList)),function(n){!function(e,n){var i,r,o,a,s,l,c=t.browser.genomicStateList[n],h=c.referenceFrame,u=Math.floor(e.viewportContainerWidth()/c.locusCount);r=2*h.bpPerPixel,s=25e7,e.genome&&(i=e.genome.getChromosome(h.chrName))&&(s=i.bpLength);r>(o=s/u)&&(r=o);a=h.start+h.bpPerPixel*u/2,l=r*u,h.start=Math.round(a-l/2),h.start<0?h.start=0:h.start>s-l&&(h.start=s-l);h.bpPerPixel=r,e.updateWithLocusIndex(n)}(e,n)})},t.Browser.prototype.selectMultiLocusPanelWithGenomicState=function(e){this.multiLocusPanelLayoutWithTruthFunction(function(t){return i.isEqual(t,e)})},t.Browser.prototype.closeMultiLocusPanelWithGenomicState=function(e){this.multiLocusPanelLayoutWithTruthFunction(function(t){return!i.isEqual(t,e)})},t.Browser.prototype.multiLocusPanelLayoutWithTruthFunction=function(n){var i,r=this,o=e("#igv-content-header");!0===this.config.showIdeogram&&t.IdeoPanel.$empty(o),this.emptyViewportContainers(),i=this.genomicStateList.filter(function(e){return n(e)}),this.genomicStateList=i.map(function(e,t,n){return e.locusIndex=t,e.locusCount=n.length,e.referenceFrame.bpPerPixel=(e.end-e.start)/(r.viewportContainerWidth()/e.locusCount),e}),!0===this.config.showIdeogram&&this.ideoPanel.buildPanels(o),this.buildViewportsWithGenomicStateList(this.genomicStateList),this.zoomWidgetLayout(),this.toggleCenterGuide(this.genomicStateList),this.toggleCursorGuide(this.genomicStateList),this.resize()},t.Browser.prototype.emptyViewportContainers=function(){e(".igv-scrollbar-outer-div").remove(),e(".igv-viewport-div").remove(),e(".igv-ruler-sweeper-div").remove(),i.each(this.trackViews,function(e){e.viewports=[],e.scrollbar=void 0,i.each(i.keys(e.track.rulerSweepers),function(t){e.track.rulerSweepers[t]=void 0}),e.track.rulerSweepers=void 0})},t.Browser.prototype.buildViewportsWithGenomicStateList=function(n){this.trackViews.forEach(function(i){n.forEach(function(n,r){i.viewports.push(new t.Viewport(i,i.$viewportContainer,n)),i.track instanceof t.RulerTrack&&i.track.createRulerSweeper(i.viewports[r],i.viewports[r].$viewport,e(i.viewports[r].contentDiv),n)}),i.configureViewportContainer(i.$viewportContainer,i.viewports)})},t.Browser.prototype.search=function(n){var i,r=this;i=n.split(" "),this.getGenomicStateList(i,this.viewportContainerWidth()).then(function(i){var o;if(i.length>0)return i.forEach(function(e,n){e.locusIndex=n,e.locusCount=i.length,e.referenceFrame=new t.ReferenceFrame(e.chromosome.name,e.start,(e.end-e.start)/(r.viewportContainerWidth()/e.locusCount))}),r.genomicStateList=i,r.emptyViewportContainers(),r.updateLocusSearchWidget(r.genomicStateList[0]),r.zoomWidgetLayout(),r.toggleCenterGuide(r.genomicStateList),r.toggleCursorGuide(r.genomicStateList),!0===r.config.showIdeogram&&(o=e("#igv-content-header"),t.IdeoPanel.$empty(o),r.ideoPanel.buildPanels(o)),r.buildViewportsWithGenomicStateList(i),r.update(),i;throw new Error("Unrecognized locus "+n)}).catch(function(e){t.presentAlert(e)})},t.Browser.prototype.zoomWidgetLayout=function(){var e;e=i.filter(this.genomicStateList,function(e){return"all"===e.locusSearchString.toLowerCase()}),i.size(e)>0?this.disableZoomWidget():this.enableZoomWidget()},t.Browser.prototype.getGenomicStateList=function(e){var n,r,o,a=this,s=t.browser.searchConfig,l=[];if(n=[],e.forEach(function(e){(r=function(e,n){var r,o,a,s,l,c;if(c={},r=e.split(":"),s=r[0],!(l=n.getChromosome(s.toLowerCase())))return!1;{if(c.chromosome=l,c.start=0,c.end=l.bpLength,1===r.length)return c;if((o=i.last(r).split("-")).length>2)return!1;if(c.start=c.end=void 0,a=o[0].replace(/\,/g,""),isNaN(a))return!1;if(c.start=parseInt(a,10)-1,2===o.length){if(a=o[1].replace(/\,/g,""),isNaN(a))return!1;c.end=parseInt(a,10)}return t.Browser.validateLocusExtent(c.chromosome,c),c}}(e,a.genome))?(r.locusSearchString=e,l.push(r)):n.push(e)}),0==n.length)return Promise.resolve(l);if(o=[],n.forEach(function(e){var n,i;(n=a.featureDB[e.toLowerCase()])?(i=c(n,e))&&l.push(i):o.push(function(e){var n=s.url.replace("$FEATURE$",e);n.indexOf("$GENOME$")>-1&&(n=n.replace("$GENOME$",a.genome.id?a.genome.id:"hg19"));return t.xhr.loadString(n).then(function(t){return{result:t,locusSearchString:e}})}(e))}),o.length>0)return Promise.all(o).then(function(e){return e.forEach(function(e){var t=c(e.result,e.locusSearchString);t&&l.push(t)}),l});function c(e,n){var i,r,o,l,c,h,u,f;return"plain"===s.type?(u=[],f=[],e.splitLines().forEach(function(e){""===e||u.push(e)}),u.forEach(function(e){var n,i,r,o,a=e.split("\t");a.length>=3&&(r=(i=a[1].split(":"))[1].split("-"),n=a[2].trim(),o={gene:a[0],chromosome:t.browser.genome.getChromosomeName(i[0].trim()),start:parseInt(r[0].replace(/,/g,"")),end:parseInt(r[1].replace(/,/g,"")),type:"gtex"===n?"snp":"gene"},f.push(o))}),i=f):i=JSON.parse(e),s.resultsField&&(i=i[s.resultsField]),i&&0!==i.length?(r=i[0]).hasOwnProperty(s.chromosomeField)&&r.hasOwnProperty(s.startField)?(o=r[s.chromosomeField],l=r[s.startField]-s.coords,void 0===(c=r[s.endField])&&(c=l+1),t.browser.flanking&&(l=Math.max(0,l-t.browser.flanking),c+=t.browser.flanking),(h=Object.assign({},r)).chromosome=a.genome.getChromosome(o),h.start=l,h.end=c,h.locusSearchString=n,h.selection=new t.GtexSelection(r[s.geneField],r[s.snpField]),h):void console.log("Search service results must includ chromosome and start fields: "+r):void 0}},t.Browser.validateLocusExtent=function(e,n){var i,r=n.start,o=n.end;void 0===o?(o=(r-=t.browser.minimumBasesExtent()/2)+t.browser.minimumBasesExtent())>e.bpLength?r=(o=e.bpLength)-t.browser.minimumBasesExtent():r<0&&(r=0,o=t.browser.minimumBasesExtent()):o-r<t.browser.minimumBasesExtent()&&((i=(o+r)/2)-t.browser.minimumBasesExtent()/2<0?o=(r=0)+t.browser.minimumBasesExtent():i+t.browser.minimumBasesExtent()/2>e.bpLength?r=(o=e.bpLength)-t.browser.minimumBasesExtent():o=(r=i-t.browser.minimumBasesExtent()/2)+t.browser.minimumBasesExtent()),n.start=Math.ceil(r),n.end=Math.floor(o)},t.Browser.prototype.loadSampleInformation=function(e){var n=e;e instanceof File&&(n=e.name),"fam"===n.substr(n.lastIndexOf(".")+1)&&t.sampleInformation.loadPlinkFile(e)},t.Browser.prototype.on=function(e,t){this.eventHandlers[e]||(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)},t.Browser.prototype.un=function(e,t){if(this.eventHandlers[e]){var n=this.eventHandlers[e].indexOf(t);-1!==n&&this.eventHandlers[e].splice(n,1)}},t.Browser.prototype.fireEvent=function(e,t,n){var i,r=this.eventHandlers[e];if(void 0!==r&&0!==r.length)return i=n||window,r.map(function(e){return e.apply(i,t)})[0]},t}((Ae=function(e){function t(e,t){this.block=e,this.offset=t}return e.BinaryParser=function(e,t){this.littleEndian=t||!0,this.position=0,this.view=e,this.length=e.byteLength},e.BinaryParser.prototype.available=function(){return this.length-this.position},e.BinaryParser.prototype.remLength=function(){return this.length-this.position},e.BinaryParser.prototype.hasNext=function(){return this.position<this.length-1},e.BinaryParser.prototype.getByte=function(){var e=this.view.getUint8(this.position,this.littleEndian);return this.position++,e},e.BinaryParser.prototype.getShort=function(){var e=this.view.getInt16(this.position,this.littleEndian);return this.position+=2,e},e.BinaryParser.prototype.getUShort=function(){var e=this.view.getUint16(this.position,this.littleEndian);return this.position+=2,e},e.BinaryParser.prototype.getInt=function(){var e=this.view.getInt32(this.position,this.littleEndian);return this.position+=4,e},e.BinaryParser.prototype.getUInt=function(){var e=this.view.getUint32(this.position,this.littleEndian);return this.position+=4,e},e.BinaryParser.prototype.getLong=function(){var e=[];e[0]=this.view.getUint8(this.position),e[1]=this.view.getUint8(this.position+1),e[2]=this.view.getUint8(this.position+2),e[3]=this.view.getUint8(this.position+3),e[4]=this.view.getUint8(this.position+4),e[5]=this.view.getUint8(this.position+5),e[6]=this.view.getUint8(this.position+6),e[7]=this.view.getUint8(this.position+7);var t=0;if(this.littleEndian)for(var n=e.length-1;n>=0;n--)t=256*t+e[n];else for(n=0;n<e.length;n++)t=256*t+e[n];return this.position+=8,t},e.BinaryParser.prototype.getString=function(e){for(var t,n="";0!=(t=this.view.getUint8(this.position++))&&(n+=String.fromCharCode(t),!e||n.length!=e););return n},e.BinaryParser.prototype.getFixedLengthString=function(e){var t,n,i="";for(t=0;t<e;t++)(n=this.view.getUint8(this.position++))>0&&(i+=String.fromCharCode(n));return i},e.BinaryParser.prototype.getFixedLengthTrimmedString=function(e){var t,n,i="";for(t=0;t<e;t++)(n=this.view.getUint8(this.position++))>32&&(i+=String.fromCharCode(n));return i},e.BinaryParser.prototype.getFloat=function(){var e=this.view.getFloat32(this.position,this.littleEndian);return this.position+=4,e},e.BinaryParser.prototype.getDouble=function(){var e=this.view.getFloat64(this.position,this.littleEndian);return this.position+=8,e},e.BinaryParser.prototype.skip=function(e){return this.position+=e,this.position},e.BinaryParser.prototype.getVPointer=function(){var e=this.position,n=this.view.getUint8(e+1)<<8|this.view.getUint8(e),i=4294967296*(255&this.view.getUint8(e+6))+16777216*(255&this.view.getUint8(e+5))+65536*(255&this.view.getUint8(e+4))+256*(255&this.view.getUint8(e+3))+(255&this.view.getUint8(e+2));return this.position+=8,new t(i,n)},t.prototype.isLessThan=function(e){return this.block<e.block||this.block===e.block&&this.offset<e.offset},t.prototype.isGreaterThan=function(e){return this.block>e.block||this.block===e.block&&this.offset>e.offset},t.prototype.print=function(){return this.block+":"+this.offset},e}((Ae=((pe=Ae||{}).BWSource=function(e){this.reader=new pe.BWReader(e),this.wgValues={}},pe.BWSource.prototype.getFeatures=function(e,t,n,i,r){return"all"===e.toLowerCase()?this.getWGValues(r):this.reader.readFeatures(e,t,e,n,i,r)},pe.BWSource.prototype.getDefaultRange=function(){return null!=this.reader.totalSummary?this.reader.totalSummary.defaultRange:void 0},pe.BWSource.prototype.getWGValues=function(e){var t,n=this;return n.wgValues[e]?Promise.resolve(n.wgValues[e]):(t=pe.browser.genome.getGenomeLength()/500,n.reader.readWGFeatures(pe.browser.genome,t,e).then(function(t){var i=[];return t.forEach(function(e){var t,n,r;r=e.chr,n=pe.browser.genome.getCumulativeOffset(r),(t=Object.assign({},e)).chr="all",t.start=n+e.start,t.end=n+e.end,i.push(t)}),n.wgValues[e]=i,i}))},pe))||{}))||{}))||{}))||{}),Ae=function(e){var t=function(e){},n="ASC";return e.AneuTrack=function(n){e.configTrack(this,n),this.maxHeight=n.maxHeight-2||500,this.sampleSquishHeight=n.sampleSquishHeight||20,this.sampleExpandHeight=n.sampleExpandHeight||125,this.sampleHeight=this.sampleExpandHeight,this.highColor=n.highColor||"rgb(30,30,255)",this.lowColor=n.lowColor||"rgb(220,0,0)",this.midColor=n.midColor||"rgb(150,150,150)",this.posColorScale=n.posColorScale||new e.GradientColorScale({low:.1,lowR:255,lowG:255,lowB:255,high:1.5,highR:255,highG:0,highB:0}),this.negColorScale=n.negColorScale||new e.GradientColorScale({low:-1.5,lowR:0,lowG:0,lowB:255,high:-.1,highR:255,highG:255,highB:255}),this.sampleCount=0,this.samples={},this.sampleNames=[],t("AneuTrack: config: "+JSON.stringify(n)),this.config=n},e.AneuTrack.prototype.getSummary=function(e,n,i,r){filtersummary=function(e){var t,n,i=[];for(t=0,n=e.length;t<n;t++){var o=e[t];Math.abs(o.score-2)>.5&&o.end-o.start>5e6&&i.push(o)}r(i)},this.featureSourceRed?this.featureSourceRed.getFeatures(e,n,i,filtersummary):(t("Aneu track has no summary data yet"),r(null))},e.AneuTrack.prototype.loadSummary=function(t,n,i,r){var o,a=this;if(!this.featureSourceRed){return o=e.buildOptions(a.config,{tokens:a.config.tokens,success:function(o){o&&(o=JSON.parse(o),a.featureSourceRed=new e.AneuFeatureSource(config,o.redline),a.getSummary(t,n,i,r))}}),e.xhr.loadString(a.config.url,o),null}this.featureSourceRed.getFeatures(t,n,i,r)},e.AneuTrack.prototype.getFeatures=function(n,i,r){var o=this;return new Promise(function(a,s){(function(){var n=this;return new Promise(function(i,r){var o,a;n.featureSourceRed?i():(o=function(r){r=JSON.parse(r),t("Got json: "+r+", diff :"+r.diff),n.featureSource=new e.AneuFeatureSource(n.config,r.diff),n.featureSourceRed=new e.AneuFeatureSource(n.config,r.redline),i()},a=e.buildOptions(n.config,{tokens:n.config.tokens}),e.xhr.loadString(n.config.url,a).then(o))})}).call(o).then(function(){o.featureSourceRed.getFeatures(n,i,r,function(e){o.redlinedata=e,o.featureSource.getFeatures(n,i,r,a)})})})},e.AneuTrack.prototype.getColor=function(e){return e<2?this.lowColor:e>2?this.highColor:this.midColor},e.AneuTrack.prototype.paintAxis=function(t,n,i){this.maxLogP,this.minLogP;var r={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};function o(e,t,n,i){return i-Math.round((n-e)/t*i)}e.graphics.fillRect(t,0,0,n,i,{fillStyle:"rgb(255, 255, 255)"});var a=this.max;a||(a=8);var s=49;e.graphics.strokeLine(t,s,o(0,a,0,this.maxheight),s,o(0,a,a,this.maxheight),r),s-=5;for(var l=0;l<=a;l+=1){var c=o(0,a,l,this.maxheight);e.graphics.strokeLine(t,s,c,s+5,c,r),l>0&&l<a&&e.graphics.fillText(t,l,s-4,c+3,r)}r.textAlign="center",e.graphics.fillText(t,"ploidy",s-15,i/2,r,{rotate:{angle:-90}})},e.AneuTrack.prototype.draw=function(n){var i,r,o,a,s,l,c,h,u,f,p,d,g,m,v,y,w,b=this;i=n.context,a=n.pixelWidth,s=n.pixelHeight;var x=4,k=0;e.graphics.fillRect(i,0,0,a,s,{fillStyle:"rgb(255, 255, 255)"});var S=this;window.track=S;var C=function(e){for(f=0,h=e.length;f<h;f++){u=e[f].sample;var t=e[f].value;t>x&&(x=t),t<k&&(k=t)}x>10&&(x=10),k=Math.max(k,0),S.max=x},T=function(i,s,h){for(r=n.bpPerPixel,o=n.bpStart,l=o+a*r+1,w=r,f=0,T=s.length;f<T;f++)(u=s[f].sample)&&this.samples&&this.samples.hasOwnProperty(u)&&(this.samples[u]=b.sampleCount,this.sampleNames.push(u),this.sampleCount++);!function(e){var t;if(void 0===b.isLog)for(b.isLog=!1,t=0;t<e.length;t++)if(e[t].value<0)return void(b.isLog=!0)}(s);var S=2;b.isLog&&(k=0,S=0);var C=b.height-4;b.maxheight=C;var T=s.length;for(f=0;f<T;f++)if(!((c=s[f]).end<o)){if(c.start>l)break;if(c.sample?(p=b.samples[c.sample]*b.sampleHeight,t("Got sample y="+p)):p=0,g=c.score,d=b.midColor,b.isLog?(g=Math.log2(g/2))<S-.1?d=b.negColorScale.getColor(g):g>S+.1&&(d=b.posColorScale.getColor(g)):g<S-.2?d=b.lowColor:g>S+.2&&(d=b.highColor),m=Math.round((c.start-o)/w),v=Math.round((c.end-o)/w),y=Math.max(2,v-m),g<=x){var _=P(k,x,g,C);1==h&&t("       Got value "+g+", h="+_+", y+h="+(p+_)+", px="+m+", px1="+v+", pw="+y+", color="+d+", maxh="+C),e.graphics.fillRect(i,m,p+_,y,2,{fillStyle:d})}}},_=b.height-4,A={font:"normal 10px Arial",textAlign:"right",strokeStyle:"rgb(150,150,150)",fillStyle:"rgb(150,150,150)"};if(n.features&&C(n.features),this.redlinedata&&C(this.redlinedata),k<2&&2<x){var I=P(k,x,2,_);console.log("drawing dashed line and solid line at "+I+" to "+a),e.graphics.dashedLine(i,20,I,a,I,4,A);var R=P(k,x,0,_);e.graphics.strokeLine(i,20,R,a,R,A)}else t("NOT drawing line at 2");function P(e,t,n,i){return i-Math.round((n-e)/t*i)}n.features?T(i,n.features,!1):console.log("No diff feature list. options="+JSON.stringify(n)),this.redlinedata?T(i,this.redlinedata,!1):console.log("No redline feature list")},e.AneuTrack.prototype.computePixelHeight=function(e){var t,n,i;for(t=0,n=e.length;t<n;t++)i=e[t].sample,this.samples&&!this.samples.hasOwnProperty(i)&&(this.samples[i]=this.sampleCount,this.sampleNames.push(i),this.sampleCount++);this.sampleCount=Math.max(1,this.sampleCount);var r=Math.max(30,this.sampleCount*this.sampleHeight);return this.height=r,r},e.AneuTrack.prototype.sortSamples=function(e,t,n,i,r){var o,a,s,l,c,h,u,f=this,p=n-t,d={};this.featureSource.getFeatures(e,t,n,function(e){for(c=0,p=e.length;c<p;c++)if(!((o=e[c]).end<t)){if(o.start>n)break;a=Math.max(t,o.start),s=Math.min(n,o.end),l=(s-a)/p,(h=d[o.sample])||(h=0),d[o.sample]=h+l*o.value}for((u=Object.keys(f.samples)).sort(function(e,t){var n=d[e],r=d[t];return n||(n=Number.MAX_VALUE),r||(r=Number.MAX_VALUE),n==r?0:n>r?i:-1*i}),c=0;c<u.length;c++)f.samples[u[c]]=c;f.sampleNames=u,r()})},e.AneuTrack.prototype.altClick=function(e,t,i){var r=t.toBP(2.5);this.sortSamples(t.chr,e-r,e+r,n),n="ASC"===n?"DESC":"ASC"},e.AneuTrack.prototype.popupData=function(e){var n,i,r=e.genomicLocation,o=(e.x,e.y),a=e.viewport.genomicState.referenceFrame,s=Math.floor(o/this.sampleHeight);if(t("popupData for row "+s+", sampleNames="+JSON.stringify(this.sampleNames)),s<this.sampleNames.length){if(n=this.sampleNames[s],i=n?[{name:"Sample",value:n}]:[],this.featureSource.featureCache){var l=a.chrName;this.featureSource.featureCache.queryFeatures(l,r,r).forEach(function(e){e.sample===n&&(i.push({name:"Value",value:e.value}),i.push({name:"Start",value:e.start}),i.push({name:"End",value:e.end}))})}if(this.featureSourceRed.featureCache){l=a.chrName;this.featureSourceRed.featureCache.queryFeatures(l,r,r).forEach(function(e){e.sample===n&&(i.push({name:"Value",value:e.value}),i.push({name:"Start",value:e.start}),i.push({name:"End",value:e.end}))})}return i}return null},e}((Ae=((de=Ae||{}).AneuFeatureSource=function(e,t){var n;function i(e){var t;return t=e.lastIndexOf("/"),e.substring(0,t+1)}this.config=e||{},de.isFilePath(this.config.url)?this.filename=i(this.config.url.name)+t:(this.config.url=i(this.config.url)+t,this.filename=t,this.headURL=this.config.headURL||t),this.parser=(n="aneu",new de.FeatureParser(n))},de.AneuFeatureSource.prototype.getFeatures=function(e,t,n,i){var r=this,o=new de.GenomicInterval(e,t,n),a=this.featureCache;if(a&&a.containsRange(o)){var s=this.featureCache.queryFeatures(e,t,n);i(s)}else this.loadFeatures(function(o){r.featureCache=new de.FeatureCache(o);var a=r.featureCache.queryFeatures(e,t,n);i(a)},o)},de.AneuFeatureSource.prototype.getFeatureCache=function(e){var t=this;this.featureCache?e(this.featureCache):this.loadFeatures(function(n){t.featureCache=new de.FeatureCache(n),e(t.featureCache)})},de.AneuFeatureSource.prototype.loadFeatures=function(e,t){var n,i,r,o=this;n=de.buildOptions(o.config,{tokens:o.config.tokensc}),i=function(t){o.header=o.parser.parseHeader(t),r=o.parser.parseFeatures(t),e(r)},de.xhr.loadString(o.config.url,n).then(i)},de))||{}),Ae=function(e){function t(t){var n,i,r,o,a,s,l,c;for(a=new e.IntervalTree,l=t.length,s=Math.max(10,Math.round(l/100)),t.sort(function(e,t){return e.start===t.start?0:e.start>t.start?1:-1}),n=0;n<l;n+=s)i=Math.min(l,n+s),r=(c=t.slice(n,i))[0].start,o=r,c.forEach(function(e){o=Math.max(o,e.end)}),a.insert(r,o,c);return a}return e.FeatureCache=function(n,i){this.treeMap=function(n){var i,r,o={},a=[],s={},l=e.browser?e.browser.genome:null;if(n)for(n.forEach(function(e){var t,n=e.chr;l&&(n=l.getChromosomeName(n)),(t=o[n])||(a.push(n),t=[],o[n]=t),t.push(e)}),i=0;i<a.length;i++)r=a[i],s[r]=t(o[r]);return s}(n),this.range=i},e.FeatureCache.prototype.containsRange=function(e){return void 0===this.range||this.range.contains(e.chr,e.start,e.end)},e.FeatureCache.prototype.queryFeatures=function(e,t,n){var i,r,o,a,s,l,c;return(l=this.treeMap[e])?0==(c=l.findOverlapping(t,n)).length?[]:(i=[],c.forEach(function(e){for(r=e.value,a=r.length,s=0;s<a&&!((o=r[s]).start>n);s++)o.end>=t&&i.push(o)}),i.sort(function(e,t){return e.start-t.start}),i):[]},e.FeatureCache.prototype.allFeatures=function(){var e=[],t=this.treeMap;if(t)for(var n in t){if(t.hasOwnProperty(n))t[n].mapIntervals(function(t){e=e.concat(t.value)})}return e.sort(function(e,t){return e.start-t.start}),e},e}((Ae=function(e){e.getDataWrapper=function(e){return"string"==typeof e||e instanceof String?new t(e):new n(e)};var t=function(e){this.data=e,this.ptr=0};t.prototype.nextLine=function(){var e=this.ptr,t=this.data.indexOf("\n",e);return t>0?(this.ptr=t+1,t===e?void 0:this.data.substring(e,t).trim()):(this.ptr=this.data.length,e>=this.data.length?void 0:this.data.substring(e).trim())};var n=function(e){this.data=e,this.length=this.data.length,this.ptr=0};return n.prototype.nextLine=function(){var e,t;if(t="",!(this.ptr>=this.length)){for(var n=this.ptr;n<this.length;n++)if("\r"!==(e=String.fromCharCode(this.data[n]))){if("\n"===e)break;t+=e}return this.ptr=n+1,t}},e}((Ae=((ge=Ae||{}).CustomServiceReader=function(e){this.config=e,this.supportsWholeGenome=!0},ge.CustomServiceReader.prototype.readFeatures=function(e,t,n){var i=this,r=i.config.url,o=i.config.body;return"all"!==e.toLowerCase()&&(r=r.replace("$CHR",e).replace("$START",t).replace("$END",n),void 0!==o&&(i.config.body=i.config.body.replace("$CHR",e).replace("$START",t).replace("$END",n))),ge.xhr.load(r,i.config).then(function(e){return e?"function"==typeof i.config.parser?i.config.parser(e):e:null})},ge))||{}))||{}),Ae=function(t){function n(e,t,n){var i=Math.round((e.start-t)/n),r=Math.round((e.end-t)/n),o=r-i;return o<3&&(o=3,i-=1),{px:i,px1:r,pw:o}}function i(e,i,r,o,a,s){var l,c,h,u,f,p,d,g,m,v,y,w,b,x,k,S=n(e,i,r),C=this.featureHeight,T=this.arrowSpacing,_=this.color;if(this.config.colorBy){var A=e[this.config.colorBy.field];A&&(_=this.config.colorBy.pallete[A])}else e.color&&(_=e.color);if(a.fillStyle=_,a.strokeStyle=_,"SQUISHED"===this.displayMode&&void 0!==e.row?(C=this.featureHeight/2,b=this.expandedCallHeight*e.row+2):b="EXPANDED"===this.displayMode&&void 0!==e.row?this.squishedCallHeight*e.row+5:5,y=(u=b+C/2)-(w=C/2)/2,0===(h=e.exons?e.exons.length:0))a.fillRect(S.px,b,S.pw,C);else{for(t.graphics.strokeLine(a,S.px+1,u,S.px1-1,u),f="+"===e.strand?1:-1,l=S.px+T/2;l<S.px1;l+=T)t.graphics.strokeLine(a,l-2*f,u-2,l,u),t.graphics.strokeLine(a,l-2*f,u+2,l,u);for(c=0;c<h;c++)if(p=e.exons[c],d=Math.round((p.start-i)/r),g=Math.round((p.end-i)/r),v=Math.max(1,g-d),p.utr)a.fillRect(d,y,v,w);else if(p.cdStart&&(m=Math.round((p.cdStart-i)/r),a.fillRect(d,y,m-d,w),v-=m-d,d=m),p.cdEnd&&(m=Math.round((p.cdEnd-i)/r),a.fillRect(m,y,g-m,w),v-=g-m,g=m),a.fillRect(d,b,v,C),v>T+5){for(a.fillStyle="white",a.strokeStyle="white",l=d+T/2;l<g;l+=T)t.graphics.strokeLine(a,l-2*f,u-2,l,u),t.graphics.strokeLine(a,l-2*f,u+2,l,u);a.fillStyle=_,a.strokeStyle=_}}k=(x=Math.round(s.viewportContainerX))+s.viewportContainerWidth/(s.genomicState.locusCount||1),function(e,n,i,r,o,a,s,l,c){var h,u,f,p,d,g,m,v,y=t.FeatureTrack.selectedGene?t.FeatureTrack.selectedGene.toUpperCase():void 0;c.selection;r<a||i>s?(p=i,d=r):(p=Math.max(i,a),d=Math.min(r,s));l.selection&&"genes"===this.config.type&&void 0!==n.name&&(h=l.selection.colorForGene(n.name));v=d-p>e.measureText(n.name).width,(void 0!==n.name&&n.name.toUpperCase()===y||(v||h)&&"SQUISHED"!==this.displayMode&&void 0!==n.name)&&(u={font:"10px PT Sans",textAlign:"center",fillStyle:h||n.color||this.color,strokeStyle:h||n.color||this.color},"COLLAPSED"===this.displayMode&&"SLANT"===this.labelDisplayMode&&(f={rotate:{angle:45}},delete u.textAlign),g=p+(d-p)/2,w=o,m=f?w+20:w+25,c.labelTransform?(e.save(),c.labelTransform(e,g),t.graphics.fillText(e,n.name,g,m,u,void 0),e.restore()):t.graphics.fillText(e,n.name,g,m,u,f));var w}.call(this,a,e,S.px,S.px1,b,x,k,s.genomicState,s)}function r(e,t,i,r,o){var a,s=n(e,t,i);switch(e.genotype){case"HOMVAR":a=this.homvarColor;break;case"HETVAR":a=this.hetvarColor;break;default:a=this.color}o.fillStyle=a,o.fillRect(s.px,20,s.pw,10)}function o(e,t,i,r,o){n(e,t,i);var a=5,s="EXPANDED"===this.displayMode?this.squishedCallHeight:this.expandedCallHeight;"SQUISHED"===this.displayMode&&null!=e.row?a=s*e.row:"EXPANDED"===this.displayMode&&null!=e.row&&(a=s*e.row);var l=a+.5*s,c=l-.5*s,h=l+.5*s,u=Math.round((e.junction_left-t)/i),f=Math.round((e.junction_right-t)/i);o.beginPath(),o.moveTo(u,l),o.bezierCurveTo(u,c,f,c,f,l),o.lineWidth=1+Math.log(e.num_junction_reads)/Math.log(2),o.strokeStyle="blue",o.stroke();for(var p=e.spanning_frag_coords,d=0;d<p.length;d++){var g=p[d],m=Math.round((g.left-t)/i),v=Math.round((g.right-t)/i);o.beginPath(),o.moveTo(m,l),o.bezierCurveTo(m,h,v,h,v,l),o.lineWidth=1,o.strokeStyle="purple",o.stroke()}}function a(e,t,i,r,o){var a,s,l,c,h,u,f,p,d=n(e,t,i),g=this.snpColors.length;switch(this.colorBy){case"function":l=e.func,c=l.split(","),h=new Set(["nonsense","missense","stop-loss","frameshift","cds-indel"]),u=new Set(["coding-synon"]),f=new Set(["splice-3","splice-5"]),p=new Set(["untranslated-5","untranslated-3"]),a=c.map(function(e){return h.has(e)||f.has(e)?g-1:u.has(e)?g-2:p.has(e)?g-3:0}).reduce(function(e,t){return Math.max(e,t)});break;case"class":a="deletion"===(s=e.class)?g-1:"mnp"===s?g-2:"microsatellite"===s||"named"===s?g-3:0}o.fillStyle=this.snpColors[a],o.fillRect(d.px,20,d.pw,10)}return t.FeatureTrack=function(e){var n,s,l;void 0===e.height&&(e.height=50),void 0===e.maxRows&&(e.maxRows=500),t.configTrack(this,e),this.displayMode=e.displayMode||"COLLAPSED",this.labelDisplayMode=e.labelDisplayMode,this.variantHeight=e.variantHeight||this.height,this.squishedCallHeight=e.squishedCallHeight||30,this.expandedCallHeight=e.expandedCallHeight||15,this.featureHeight=e.featureHeight||14,this.maxRows=e.maxRows,e.url&&(t.filenameOrURLHasSuffix(e.url,".bigbed")||t.filenameOrURLHasSuffix(e.url,".bb")||t.filenameOrURLHasSuffix(e.url,".bigwig")||t.filenameOrURLHasSuffix(e.url,".bw"))?this.featureSource=new t.BWSource(e):this.featureSource=new t.FeatureSource(e),e.render?this.render=e.render:"variant"===e.type?(this.render=r,this.homvarColor="rgb(17,248,254)",this.hetvarColor="rgb(34,12,253)"):"FusionJuncSpan"===e.type?(this.render=o,this.height=e.height||50,this.autoHeight=!1):"snp"===e.type?(this.render=a,this.snpColors=["rgb(0,0,0)","rgb(0,0,255)","rgb(0,255,0)","rgb(255,0,0)"],this.colorBy="function"):(this.render=i,this.arrowSpacing=30,n=this,s=function(){n.trackView&&n.trackView.tile&&"SQUISHED"!==n.displayMode&&n.trackView.update()},l=function(e){t.browser.un&&n===e&&(t.browser.un("trackdrag",s),t.browser.un("trackremoved",l))},t.browser.on&&(t.browser.on("trackdragend",s),t.browser.on("trackremoved",l)))},t.FeatureTrack.prototype.getFileHeader=function(){var e=this;return"function"==typeof e.featureSource.getFileHeader?e.featureSource.getFileHeader().then(function(t){return t&&(t.name&&!e.config.name&&(e.name=t.name),t.color&&!e.config.color&&(e.color="rgb("+t.color+")")),t}):Promise.resolve(void 0)},t.FeatureTrack.prototype.getFeatures=function(e,t,n,i){return this.featureSource.getFeatures(e,t,n,i)},t.FeatureTrack.prototype.computePixelHeight=function(e){if("COLLAPSED"===this.displayMode)return this.variantHeight;var t=0;return e&&"function"==typeof e.forEach&&e.forEach(function(e){e.row&&e.row>t&&(t=e.row)}),Math.max(this.variantHeight,(t+1)*("SQUISHED"===this.displayMode?this.squishedCallHeight:this.expandedCallHeight))},t.FeatureTrack.prototype.draw=function(e){var n,i,r,o=e.features,a=e.context,s=e.bpPerPixel,l=e.bpStart,c=e.pixelWidth,h=e.pixelHeight,u=l+c*s+1;if(t.graphics.fillRect(a,0,0,c,h,{fillStyle:"rgb(255, 255, 255)"}),o){n=t.FeatureTrack.selectedGene?t.FeatureTrack.selectedGene.toUpperCase():void 0;for(var f,p=0,d=o.length;p<d;p++)if(!((f=o[p]).end<l)){if(f.start>u)break;!i&&n&&n===f.name.toUpperCase()?i=f:this.render.call(this,f,l,s,h,a,e)}i&&(r=i.color,i.color="rgb(255,0,0)",this.render.call(this,i,l,s,h,a,e),i.color=r)}else console.log("No feature list")},t.FeatureTrack.prototype.popupData=function(e){if(e.viewport.cachedFeatures){var n,i,r,o,a,s,l=e.genomicLocation,c=e.y;if(n=2*e.viewport.genomicState.referenceFrame.bpPerPixel,a=l-n,s=l+n,i=e.viewport.cachedFeatures.features,"COLLAPSED"!==this.displayMode&&(r="SQUISHED"===this.displayMode?Math.floor((c-2)/this.expandedCallHeight):Math.floor((c-5)/this.squishedCallHeight)),i&&i.length>0)return o=[],i.forEach(function(e){var n;e.end>=a&&e.start<=s&&(void 0!==r&&void 0!==e.row&&r!==e.row||(n=e.popupData?e.popupData(l):function(e){var n=[];for(var i in e)e.hasOwnProperty(i)&&"chr"!==i&&"start"!==i&&"end"!==i&&"row"!==i&&t.isStringOrNumber(e[i])&&n.push({name:i,value:e[i]});return n}(e))&&(o.length>0&&o.push("<HR>"),Array.prototype.push.apply(o,n)))}),o}return null},t.FeatureTrack.prototype.menuItemList=function(t){var n,i=this,r=[];if(this.render===a){var o=["function","class"].map(function(n,r){return{object:e((o=n,a=r,s=i.colorBy,l=0===a?'<div class="igv-track-menu-border-top">':"<div>",o===s?l+'<i class="fa fa-check fa-check-shim"></i>Color by '+o+"</div>":l+'<i class="fa fa-check fa-check-shim fa-check-hidden"></i>Color by '+o+"</div>")),click:function(){t.hide(),i.colorBy=n,i.trackView.update()}};var o,a,s,l});r=r.concat(o)}return n=["COLLAPSED","SQUISHED","EXPANDED"].map(function(n,r){return{object:e((o=n,a=r,s=i.displayMode,l={COLLAPSED:"Collapse",SQUISHED:"Squish",EXPANDED:"Expand"},c=0===a?'<div class="igv-track-menu-border-top">':"<div>",o===s?c+'<i class="fa fa-check fa-check-shim"></i>'+l[o]+"</div>":c+'<i class="fa fa-check fa-check-shim fa-check-hidden"></i>'+l[o]+"</div>")),click:function(){t.hide(),i.displayMode=n,i.trackView.update()}};var o,a,s,l,c}),r=r.concat(n)},t.FeatureTrack.prototype.popupMenuItemList=function(e){if(this.render===a){var t=[],n=this;return t.push({name:"Color by function",click:function(){i("function")}}),t.push({name:"Color by class",click:function(){i("class")}}),t}function i(t){n.colorBy=t,n.trackView.update(),e.popover.hide()}},t.FeatureTrack.prototype.description=function(){var e;return a===this.render?(e="<html>"+this.name+"<hr>",e+="<em>Color By Function:</em><br>",e+='<span style="color:red">Red</span>: Coding-Non-Synonymous, Splice Site<br>',e+='<span style="color:green">Green</span>: Coding-Synonymous<br>',e+='<span style="color:blue">Blue</span>: Untranslated<br>',e+='<span style="color:black">Black</span>: Intron, Locus, Unknown<br><br>',e+="<em>Color By Class:</em><br>",e+='<span style="color:red">Red</span>: Deletion<br>',e+='<span style="color:green">Green</span>: MNP<br>',e+='<span style="color:blue">Blue</span>: Microsatellite, Named<br>',e+='<span style="color:black">Black</span>: Indel, Insertion, SNP',e+="</html>"):this.name},t.FeatureTrack.prototype.popupMenuItemList=function(e){if(this.render===a){var t=[],n=this;return t.push({name:"Color by function",click:function(){i("function")}}),t.push({name:"Color by class",click:function(){i("class")}}),t}function i(t){n.colorBy=t,n.trackView.update(),e.popover.hide()}},t}((Ae=function(e){function t(t){t.forEach(function(t){t.name&&(e.browser.featureDB[t.name.toLowerCase()]=t)})}function n(e,t){if(null!=e&&0!==e.length){var n={},i=[];e.forEach(function(e){var t=e.chr,r=n[t];r||(r=[],n[t]=r,i.push(t)),r.push(e)}),i.forEach(function(e){var i,r,o;i=n[e],r=t,o=[],i.sort(function(e,t){return e.start-t.start}),o.push(-1e3),i.forEach(function(e){var t,n=Math.min(o.length,r),i=e.start;for(t=0;t<n;t++)if(i>=o[t])return e.row=t,void(o[t]=e.end);e.row=t,o[t]=e.end})})}}return e.FeatureSource=function(t){this.config=t||{},this.sourceType=void 0===t.sourceType?"file":t.sourceType,"ga4gh"===t.sourceType?this.reader=new e.Ga4ghVariantReader(t):"immvar"===t.sourceType?this.reader=new e.ImmVarReader(t):"eqtl"===t.type?"gtex-ws"===t.sourceType?this.reader=new e.GtexReader(t):this.reader=new e.GtexFileReader(t):"bigquery"===t.sourceType?this.reader=new e.BigQueryFeatureReader(t):"ucscservice"===t.sourceType?this.reader=new e.UCSCServiceReader(t.source):"custom"===t.sourceType||void 0!==t.source?this.reader=new e.CustomServiceReader(t.source):this.reader=new e.FeatureFileReader(t),this.visibilityWindow=t.visibilityWindow},e.FeatureSource.prototype.getFileHeader=function(){var i=this,r=this.config.maxRows||500;return i.header?Promise.resolve(i.header):"function"==typeof i.reader.readHeader?i.reader.readHeader().then(function(o){if(o){i.header=o;var a=o.features;a&&("gtf"!==i.config.format&&"gff3"!==i.config.format&&"gff"!==i.config.format||(a=new e.GFFHelper(i.config.format).combineFeatures(a)),n(a,r),i.featureCache=new e.FeatureCache(a),i.config.searchable&&t(a))}return o&&o.format&&(i.config.format=o.format),o}):(i.header={},Promise.resolve(i.header))},e.FeatureSource.prototype.getFeatures=function(i,r,o,a){var s,l,c,h,u,f,p,d,g=this;return h=e.browser&&e.browser.genome?e.browser.genome.getChromosomeName(i):i,s=new e.GenomicInterval(h,r,o),l=g.featureCache,c=g.config.maxRows||500,"all"===i.toLowerCase()?l&&void 0===l.range?Promise.resolve((u=l.allFeatures(),d=e.browser.genome,p=new Set(d.wgChromosomeNames),f=[],u.forEach(function(t){var n,i;i=d.getChromosomeName(t.chr),p.has(i)&&((n=Object.assign({},t)).start=e.browser.genome.getGenomeCoordinate(t.chr,t.start),n.end=e.browser.genome.getGenomeCoordinate(t.chr,t.end),f.push(n))}),f)):Promise.resolve(null):l&&l.containsRange(s)?Promise.resolve(g.featureCache.queryFeatures(h,r,o)):g.reader.readFeatures(h,s.start,s.end).then(function(i){if(i){"gtf"!==g.config.format&&"gff3"!==g.config.format&&"gff"!==g.config.format||(i=new e.GFFHelper(g.config.format).combineFeatures(i));var r=g.reader.indexed||"file"!==g.config.sourceType;return g.featureCache=r?new e.FeatureCache(i,s):new e.FeatureCache(i),n(i,c),g.config.searchable&&t(i),i}})},e}((Ae=function(e){var t=Number.MAX_VALUE,n=["Name","gene_name","gene","gene_id","alias","locus"];function i(e){var t,n,i,r={},o=e.split(/(?:")([^"]+)(?:")|([^\s"]+)(?=\s+|$)/g),a=[];for(t=1;t<o.length;t++)o[t]&&0!==o[t].trim().length&&((n=o[t].trim()).endsWith("=")>0?i=n:i?(a.push(i+n),i=void 0):a.push(n));return a.forEach(function(e){if(e){var t=e.split("=",2);2==t.length&&(r[t[0]]=t[1])}}),r}function r(t,n){var i,r,o,a,s,l,c,h,u,f,p,d,g,m;if(!(t.length<3)){if(i=t[0],r=parseInt(t[1]),o=t.length>2?parseInt(t[2]):r+1,d={chr:i,start:r,end:o,score:1e3},t.length>3){c=(l=t[3].replace(/"/g,"")).split(";");for(var v=0;v<c.length;v++){var y=c[v].split("=");"gene_id"==y[0]&&(a=y[1]),"gene_name"==y[0]&&(s=y[1])}d.id=a||l,d.name=s||l}if(t.length>4&&(d.score=parseFloat(t[4])),t.length>5&&(d.strand=t[5]),t.length>6&&(d.cdStart=parseInt(t[6])),t.length>7&&(d.cdEnd=parseInt(t[7])),t.length>8&&"."!==t[8]&&"0"!==t[8]&&(d.color=e.Color.createColorString(t[8])),t.length>11){h=parseInt(t[9]),u=t[10].split(","),f=t[11].split(","),p=[];for(v=0;v<h;v++){var w={start:g=r+parseInt(f[v]),end:m=g+parseInt(u[v])};(d.cdStart>m||d.cdEnd<d.cdStart)&&(w.utr=!0),d.cdStart>=g&&d.cdStart<=m&&(w.cdStart=d.cdStart),d.cdEnd>=g&&d.cdEnd<=m&&(w.cdEnd=d.cdEnd),p.push(w)}d.exons=p}return d.popupData=function(){var e=[];return d.name&&e.push({name:"Name",value:d.name}),"+"!==d.strand&&"-"!==d.strand||e.push({name:"Strand",value:d.strand}),e},d}}function o(e,t){var n=void 0===this.shift?0:1;if(!(e.length<9+n)){for(var i={name:e[0+n],chr:e[1+n],strand:e[2+n],start:parseInt(e[3+n]),end:parseInt(e[4+n]),cdStart:parseInt(e[5+n]),cdEnd:parseInt(e[6+n]),id:e[0+n]},r=parseInt(e[7+n]),o=e[8+n].split(","),a=e[9+n].split(","),s=[],l=0;l<r;l++)s.push({start:parseInt(o[l]),end:parseInt(a[l])});return i.exons=s,i.popupData=function(){return[{name:"Name",value:i.name}]},i}}function a(e,t){var n=void 0===this.shift?0:1;if(!(e.length<11+n)){for(var i={name:e[11+n],chr:e[1+n],strand:e[2+n],start:parseInt(e[3+n]),end:parseInt(e[4+n]),cdStart:parseInt(e[5+n]),cdEnd:parseInt(e[6+n]),id:e[0+n]},r=parseInt(e[7+n]),o=e[8+n].split(","),a=e[9+n].split(","),s=[],l=0;l<r;l++)s.push({start:parseInt(o[l]),end:parseInt(a[l])});return i.exons=s,i.popupData=function(){return[{name:"Name",value:i.name}]},i}}function s(e,t){var n=void 0===this.shift?0:1;if(!(e.length<10+n)){for(var i={name:e[0+n],id:e[1+n],chr:e[2+n],strand:e[3+n],start:parseInt(e[4+n]),end:parseInt(e[5+n]),cdStart:parseInt(e[6+n]),cdEnd:parseInt(e[7+n])},r=parseInt(e[8+n]),o=e[9+n].split(","),a=e[10+n].split(","),s=[],l=0;l<r;l++)s.push({start:parseInt(o[l]),end:parseInt(a[l])});return i.exons=s,i.popupData=function(){return[{name:"Name",value:i.name}]},i}}function l(e,t){var n,i,r,o,a,s,l;return e.length<9?null:(n=e[0],i=parseInt(e[1]),r=parseInt(e[2]),a=e[3],s=parseFloat(e[4]),o=e[5].trim(),l=parseFloat(e[6]),0===s&&(s=l),{chr:n,start:i,end:r,name:a,score:s,strand:o,signal:l,pValue:parseFloat(e[7]),qValue:parseFloat(e[8])})}function c(e,t){return e.length<3?null:{chr:e[0],start:parseInt(e[1]),end:parseInt(e[2]),value:parseFloat(e[3])}}function h(e,t){var n,i,r;return"fixedStep"===t.format?(i=(n=t.index*t.step+t.start)+t.span,r=parseFloat(e[0]),++t.index,isNaN(r)?null:{chr:t.chrom,start:n,end:i,value:r}):"variableStep"===t.format?e.length<2?null:(i=(n=parseInt(e[0],10))+t.span,r=parseFloat(e[1]),isNaN(r)?null:{chr:t.chrom,start:n,end:i,value:r}):c(e)}function u(e,t){var n,i,r,o;return e.length<4?null:(n=e[1],i=parseInt(e[2]),r=e.length>3?parseInt(e[3]):i+1,o={chr:n,start:i,end:r},e.length>4&&(o.score=parseFloat(e[4]),o.value=o.score),o.popupData=function(){return[{name:"Name",value:o.name}]},o)}function f(e,t){var n=e[0],i=e[1],r=parseInt(e[2]),o=parseInt(e[3]),a=parseInt(e[4]),s=parseInt(e[5]),l=e[6],c={chr:n,name:i,junction_left:r,junction_right:o,num_junction_reads:a,num_spanning_frags:s,spanning_frag_coords:[],start:-1,end:-1},h=r,u=o;if(s>0)for(var f=l.split(","),p=0;p<f.length;p++){var d=f[p].split("-"),g=d[0],m=d[1];g<h&&(h=g),m>u&&(u=m),c.spanning_frag_coords.push({left:g,right:m})}return c.start=h,c.end=u,c.popupData=function(){return[{name:"Name",value:c.name}]},c}function p(e,t){return e.length<8?null:{chr:e[0],start:parseInt(e[1])-1,end:parseInt(e[3].split(":")[1]),pvalue:parseFloat(e[5])}}function d(t,i){var r,o,a,s,l,c,h,u,f,p,d,g,m=this.format;if(t.length<9)return null;r=t[0],l=t[2],o=parseInt(t[3])-1,a=parseInt(t[4]),c="."===t[5]?0:parseFloat(t[5]),s=t[6],"."===t[7]||parseInt(t[7]),h=t[8];var v="gff3"===m?"=":/\s+/,y={};if(h.split(";").forEach(function(t){var n,i,r=t.trim().split(v,2);2==r.length&&(n=r[0].trim(),(i=r[1].trim()).startsWith('"')&&i.endsWith('"')&&(i=i.substr(1,i.length-2)),"ID"===r[0]?u=r[1]:"Parent"===r[0]?f=r[1]:"color"===r[0].toLowerCase()?p=e.Color.createColorString(r[1]):"transcript_id"===r[0]&&(u=r[1]),y[n]=i)}),this.nameField)d=y[this.nameField];else for(g=0;g<n.length;g++)if(y.hasOwnProperty(n[g])){this.nameField=n[g],d=y[this.nameField];break}return{id:u,parent:f,name:d,type:l,chr:r,start:o,end:a,score:c,strand:s,color:p,attributeString:h,popupData:function(){var e,t,n=this.attributeString.split(";"),i=[];return n.forEach(function(n){var r=n.trim().split(v,2);2===r.length&&void 0!==r[1]&&(e=r[0].trim(),(t=r[1].trim()).startsWith('"')&&t.endsWith('"')&&(t=t.substr(1,t.length-2)),i.push({name:e,value:t}))}),i}}}function g(e,t){var n,i,r,o,a=this.format,s=a.coords||0;return e.length<3?null:(i=e[a.chr],r=parseInt(e[a.start])-s,o=void 0!==a.end?parseInt(e[a.end]):r+1,n={chr:i,start:r,end:o},a.fields&&a.fields.forEach(function(t,i){i!=a.chr&&i!=a.start&&i!=a.end&&(n[t]=e[i])}),n)}return e.FeatureParser=function(t,n,i){var m;switch(void 0!==t&&(this.format=t.toLowerCase()),this.nameField=i?i.nameField:void 0,this.skipRows=0,n&&(this.decode=n),this.format){case"narrowpeak":case"broadpeak":case"peaks":this.decode=l,this.delimiter=/\s+/;break;case"bedgraph":this.decode=c,this.delimiter=/\s+/;break;case"wig":this.decode=h,this.delimiter=/\s+/;break;case"gff3":case"gff":case"gtf":this.decode=d,this.delimiter="\t";break;case"aneu":this.decode=u,this.delimiter="\t";break;case"fusionjuncspan":this.decode=f,this.delimiter=/\s+/;break;case"gtexgwas":this.skipRows=1,this.decode=p,this.delimiter="\t";break;case"refflat":this.decode=s,this.delimiter=/\s+/;break;case"genepred":this.decode=o,this.delimiter=/\s+/;break;case"genepredext":this.decode=a,this.delimiter=/\s+/;break;case"refgene":this.decode=a,this.delimiter=/\s+/,this.shift=1;break;case"bed":this.decode=r,this.delimiter=i.delimiter||/\s+/;default:void 0!==(m=e.getFormat(t))?(this.decode=g,this.format=m,this.delimiter=m.delimiter||"\t"):(this.decode=r,this.delimiter=/\s+/)}},e.FeatureParser.prototype.parseHeader=function(t){var n,r,o;for(o=e.getDataWrapper(t);(n=o.nextLine())&&(n.startsWith("track")||n.startsWith("#")||n.startsWith("browser"));)n.startsWith("track")?r=i(n):n.startsWith("##gff-version 3")&&(this.format="gff3",r||(r={}),r.format="gff3");return r},e.FeatureParser.prototype.parseFeatures=function(n){if(!n)return null;var i,r,o,a,s,l,c,h,u,f,p,d,g,m,v,y=[],w=0,b=this.decode,x=this.format,k=this.delimiter||"\t";for(i=e.getDataWrapper(n),l=0;s=i.nextLine();)l<this.skipRows||s.startsWith("track")||s.startsWith("#")||s.startsWith("browser")||("wig"===x&&s.startsWith("fixedStep")?(p=void 0,void 0,void 0,void 0,void 0,p=s.split(/\s+/),d=p[1].split("=")[1],g=parseInt(p[2].split("=")[1],10),m=parseInt(p[3].split("=")[1],10),v=p.length>4?parseInt(p[4].split("=")[1],10):1,r={format:"fixedStep",chrom:d,start:g,step:m,span:v,index:0}):"wig"===x&&s.startsWith("variableStep")?(h=void 0,void 0,void 0,h=s.split(/\s+/),u=h[1].split("=")[1],f=h.length>2?parseInt(h[2].split("=")[1],10):1,r={format:"variableStep",chrom:u,span:f}):(a=s.split(k)).length<1||((o=b.call(this,a,r))&&(y.length<t?y.push(o):(c=Math.floor(Math.random()*w))<t&&(y[c]=o),w++),l++));return y},e}((Ae=((me=Ae||{}).FeatureFileReader=function(e){var t;this.config=e||{},this.indexURL=e.indexURL,this.indexed=e.indexed,me.isFilePath(this.config.url)?this.filename=this.config.url.name:this.config.url.startsWith("data:")?(this.indexed=!1,this.dataURI=e.url):(t=me.parseUri(this.config.url),this.filename=t.file,this.path=t.path),this.format=this.config.format,this.parser=this.getParser(this.format,this.config.decode),this.supportsWholeGenome="seg"===this.format},me.FeatureFileReader.prototype.readFeatures=function(e,t,n){return this.index?this.loadFeaturesWithIndex(e,t,n):this.dataURI?this.loadFeaturesFromDataURI():this.loadFeaturesNoIndex()},me.FeatureFileReader.prototype.readHeader=function(){var e=this;return e.header?Promise.resolve(e.header):e.getIndex().then(function(t){var n;return e.dataURI?e.loadFeaturesFromDataURI(e.dataURI).then(function(t){var n=e.header||{};return n.features=t,n}):t?(n=me.buildOptions(e.config,{bgz:t.tabix,range:{start:0,size:65e3}}),me.xhr.loadString(e.config.url,n).then(function(t){return e.header=e.parser.parseHeader(t),e.header})):e.loadFeaturesNoIndex().then(function(t){var n=e.header||{};return n.features=t,n})})},me.FeatureFileReader.prototype.getParser=function(e,t){switch(e){case"vcf":return new me.VcfParser;case"seg":return new me.SegParser;default:return new me.FeatureParser(e,t,this.config)}},me.FeatureFileReader.prototype.loadIndex=function(){var e=this.config.indexURL;return this.filename.endsWith(".gz")?(e||(e=this.config.url+".tbi"),me.loadBamIndex(e,this.config,!0)):(e||(e=this.config.url+".idx"),me.loadTribbleIndex(e,this.config))},me.FeatureFileReader.prototype.loadFeaturesNoIndex=function(){var e=this,t=me.buildOptions(e.config);return me.xhr.loadString(e.config.url,t).then(function(t){return e.header=e.parser.parseHeader(t),e.header instanceof String&&e.header.startsWith("##gff-version 3")&&(e.format="gff3"),e.parser.parseFeatures(t)})},me.FeatureFileReader.prototype.loadFeaturesWithIndex=function(e,t,n){var i,r=this,o=r.index&&r.index.tabix?r.index.sequenceIndexMap[e]:e,a=[];return(i=r.index.blocksForRange(o,t,n))&&0!==i.length?(i.forEach(function(e){a.push(new Promise(function(i,o){var a,s,l,c=e.minv.block,h=e.minv.offset;a=e.maxv.block+65536,s=me.buildOptions(r.config,{range:{start:c,size:a-c+1}}),l=function(e){var o,a,s,l,c,u;for(o=r.index.tabix?new Uint8Array(me.unbgzf(e)):e,a=h?o.slice(h):o,s=r.parser.parseFeatures(a),l=[],u=0;u<s.length&&!((c=s[u]).start>n);u++)c.end>=t&&c.start<=n&&l.push(c);i(l)},r.index.tabix?me.xhr.loadArrayBuffer(r.config.url,s).then(l).catch(o):me.xhr.loadString(r.config.url,s).then(l).catch(o)}))}),Promise.all(a).then(function(e){var t,n;if(1===e.length)n=e[0];else{for(n=e[0],t=1;t<e.length;t++)n=n.concat(e[t]);n.sort(function(e,t){return e.start-t.start})}return n})):Promise.resolve([])},me.FeatureFileReader.prototype.getIndex=function(){var e=this;return void 0!==e.index||!1===e.indexed?Promise.resolve(e.index):e.indexURL||e.indexed||"string"==typeof e.config.url&&e.config.url.endsWith(".gz")?e.loadIndex().then(function(t){return t?(e.index=t,e.indexed=!0):e.indexed=!1,e.index}).catch(function(t){if(e.indexed=!1,"404"!==t.message||void 0!==e.config.indexURL)throw t;me.presentAlert("Index file not found.  Check track configuration",void 0)}):(e.indexed=!1,Promise.resolve(void 0))},me.FeatureFileReader.prototype.loadFeaturesFromDataURI=function(){var e,t,n,i=this.dataURI.split(","),r=i[0].split(":")[1],a=i[1];a=r.indexOf("base64")>=0?atob(a):decodeURI(a),e=new Uint8Array(a.length);for(var s=0;s<a.length;s++)e[s]=a.charCodeAt(s);return t=new o.Gunzip(e).decompress(),n=this.parser.parseFeatures(t),Promise.resolve(n)},me))||{}))||{}))||{}),Ae=function(e){Number.MAX_VALUE;return e.SegParser=function(){},e.SegParser.prototype.parseHeader=function(e){var t,n,i,r=e.splitLines(),o=r.length;for(n=0;n<o;n++)if(!(t=r[n]).startsWith("#"))return i=t.split("\t"),this.header={headings:i,lineCount:n+1},this.header;return this.header},e.SegParser.prototype.parseFeatures=function(e){var t,n,i,r=e?e.splitLines():[],o=r.length,a=[];for(this.header||(this.header=this.parseHeader(e)),i=this.header.headings.length-1,n=this.header.lineCount;n<o;n++)r[n],(t=r[n].split("\t")).length>i&&a.push({sample:t[0],chr:t[1],start:parseInt(t[2]),end:parseInt(t[3]),value:parseFloat(t[i])});return a},e}((Ae=function(e){return e.MergedTrack=function(t){var n=this;t.tracks?(void 0===t.height&&(t.height=50),e.configTrack(this,t),this.tracks=[],t.tracks.forEach(function(t){t.type||e.inferTrackTypes(t);var i=e.createTrack(t);i?(i.autoscale=!1,n.tracks.push(i)):console.log("Could not create track "+t)})):console.log("Error: not tracks defined for merged track. "+t)},e.MergedTrack.prototype.getFeatures=function(e,t,n,i){var r=this.tracks.map(function(r){return r.getFeatures(e,t,n,i)});return Promise.all(r)},e.MergedTrack.prototype.draw=function(e){var t,n,i,r,o,a,s,l;for(i=e.features,e.genomicState.chromosome.name,a=i,s=0,l=-Number.MAX_VALUE,a.forEach(function(e){e.forEach(function(e){Number.isNaN(e.value)||(s=Math.min(s,e.value),l=Math.max(l,e.value))})}),o={min:s,max:l},t=0,n=this.tracks.length;t<n;t++)(r=Object.assign({},e)).features=i[t],this.tracks[t].dataRange=o,this.tracks[t].draw(r)},e.MergedTrack.prototype.paintAxis=function(e,t,n){var i,r,o;for(!0,i=0,r=this.tracks.length;i<r;i++)if("function"==typeof(o=this.tracks[i]).paintAxis){o.paintAxis(e,t,n);break}},e}((Ae=function(e){var t,n,i,r;return e.GFFHelper=function(e){this.format=e},e.GFFHelper.prototype.combineFeatures=function(e){return void 0===t&&(t=new Set,n=new Set,i=new Set,r=new Set,["transcript","primary_transcript","processed_transcript","mRNA","mrna"].forEach(function(e){t.add(e)}),["CDS","cds","start_codon","stop_codon"].forEach(function(e){n.add(e)}),["5UTR","3UTR","UTR","five_prime_UTR","three_prime_UTR","3'-UTR","5'-UTR"].forEach(function(e){i.add(e)}),["exon","coding-exon"].forEach(function(e){r.add(e)})),"gff3"===this.format?function(e){var o,a={},s=[];function l(e){return e.parent&&""!==e.parent.trim()?e.parent.trim().split(","):null}return e.forEach(function(e){var n,i;t.has(e.type)&&((n=e.id)?(i=new GFFTranscript(e),a[n]=i,s.push(i)):s.push(e))}),e.forEach(function(e){var t;r.has(e.type)&&((o=l(e))?o.forEach(function(n){void 0===(t=a[n])&&(t=new GFFTranscript(e),a[n]=t,s.push(t)),t.addExon(e)}):s.push(e))}),e.forEach(function(e){var t;(n.has(e.type)||i.has(e.type))&&((o=l(e))?o.forEach(function(n){void 0===(t=a[n])&&(t=new GFFTranscript(e),a[n]=t,s.push(t)),i.has(e.type)?t.addUTR(e):t.addCDS(e)}):s.push(e))}),s.forEach(function(e){e instanceof GFFTranscript&&e.finish()}),s.sort(function(e,t){return e.start-t.start}),s}.call(this,e):function(e){var o={},a=[];return e.forEach(function(e){var n,i;t.has(e.type)&&((n=e.id)?(i=new GFFTranscript(e),o[n]=i,a.push(i)):a.push(e))}),e.forEach(function(e){var t,n;r.has(e.type)&&(t=e.id)&&(void 0===(n=o[t])&&(n=new GFFTranscript(e),o[t]=n,a.push(n)),n.addExon(e))}),e.forEach(function(e){var t,r;(n.has(e.type)||i.has(e.type))&&(t=e.id)&&(void 0===(r=o[t])&&(r=new GFFTranscript(e),o[t]=r,a.push(r)),i.has(e.type)?r.addUTR(e):r.addCDS(e))}),a.forEach(function(e){e instanceof GFFTranscript&&e.finish()}),a.sort(function(e,t){return e.start-t.start}),a}.call(this,e)},GFFTranscript=function(e){Object.assign(this,e),this.exons=[],this.attributeString=e.attributeString},GFFTranscript.prototype.addExon=function(e){this.exons.push({start:e.start,end:e.end}),this.start=Math.min(this.start,e.start),this.end=Math.max(this.end,e.end)},GFFTranscript.prototype.addCDS=function(e){var t,n,i=this.exons;for(t=0;t<i.length;t++)if(i[t].start<=e.start&&i[t].end>=e.end){n=i[t];break}n?(n.cdStart=n.cdStart?Math.min(e.start,n.cdStart):e.start,n.cdEnd=n.cdEnd?Math.max(e.end,n.cdEnd):e.end):i.push({start:e.start,end:e.end,cdStart:e.start,cdEnd:e.end}),this.start=Math.min(this.start,e.start),this.end=Math.max(this.end,e.end),this.cdStart=this.cdStart?Math.min(e.start,this.cdStart):e.start,this.cdEnd=this.cdEnd?Math.max(e.end,this.cdEnd):e.end},GFFTranscript.prototype.addUTR=function(e){var t,n,i=this.exons;for(t=0;t<i.length;t++)if(i[t].start<=e.start&&i[t].end>=e.end){n=i[t];break}n?e.start===n.start&&e.end===n.end&&(n.utr=!0):i.push({start:e.start,end:e.end,utr:!0}),this.start=Math.min(this.start,e.start),this.end=Math.max(this.end,e.end)},GFFTranscript.prototype.finish=function(){var e=this.cdStart,t=this.cdEnd;this.exons.sort(function(e,t){return e.start-t.start}),e&&this.exons.forEach(function(n){(n.end<e||n.start>t)&&(n.utr=!0)})},e}((Ae=((ve=Ae||{}).FeatureUtils={packFeatures:function(e,t,n){var i,r;if(e){if(t=t||1e4,n||e.sort(function(e,t){return e.start-t.start}),0===e.length)return[];var o,a,s,l,c,h,u=[],f=0,p=0,d=[];for(i=e[0].start,r=e[e.length-1].start,o=h=Math.max(i,e[0].start),e.forEach(function(e){var t=Math.max(0,e.start-h);void 0===u[t]&&(u[t]=[]),u[t].push(e)}),a=0;f<e.length&&d.length<t;){for(;o<=r;){for(l=void 0;!l&&o<=r;)void 0===u[s=o-h]?++o:l=u[s];if(!l)break;c=l.pop(),0===l.length&&(u[s]=void 0),c.row=a,o=c.end+2,++f}if(a++,o=h,f===p)break;p=f}}}},ve))||{}))||{}))||{}),we="DESC",(ye=Ae||{}).SegTrack=function(e){ye.configTrack(this,e),this.isLog=void 0!==e.isLog&&e.isLog,this.displayMode=e.displayMode||"SQUISHED",this.maxHeight=e.maxHeight||500,this.sampleSquishHeight=e.sampleSquishHeight||2,this.sampleExpandHeight=e.sampleExpandHeight||12,this.posColorScale=e.posColorScale||new ye.GradientColorScale({low:.1,lowR:255,lowG:255,lowB:255,high:1.5,highR:255,highG:0,highB:0}),this.negColorScale=e.negColorScale||new ye.GradientColorScale({low:-1.5,lowR:0,lowG:0,lowB:255,high:-.1,highR:255,highG:255,highB:255}),this.sampleCount=0,this.samples={},this.sampleNames=[],this.featureSource=new ye.FeatureSource(this.config),this.supportsWholeGenome=!0},ye.SegTrack.prototype.menuItemList=function(e){var t=this;return[{name:"SQUISHED"===this.displayMode?"Expand sample hgt":"Squish sample hgt",click:function(){e.hide(),t.toggleSampleHeight()}}]},ye.SegTrack.prototype.toggleSampleHeight=function(){this.displayMode="SQUISHED"===this.displayMode?"EXPANDED":"SQUISHED",this.trackView.update()},ye.SegTrack.prototype.getFeatures=function(e,t,n){var i=this;return 0===i.sampleCount&&"function"==typeof i.featureSource.reader.allSamples?i.featureSource.reader.allSamples().then(function(r){return r.forEach(function(e){i.samples[e]=i.sampleCount,i.sampleNames.push(e),i.sampleCount++}),i.featureSource.getFeatures(e,t,n)}):i.featureSource.getFeatures(e,t,n)},ye.SegTrack.prototype.draw=function(e){var t,n,i,r,o,a,s,l,c,h,u,f,p,d,g,m,v,y,w,b;if(w="SQUISHED"===this.displayMode?this.sampleSquishHeight:this.sampleExpandHeight,b="SQUISHED"===this.displayMode?0:1,n=e.context,o=e.pixelWidth,a=e.pixelHeight,ye.graphics.fillRect(n,0,0,o,a,{fillStyle:"rgb(255, 255, 255)"}),t=e.features){for(i=e.bpPerPixel,s=(r=e.bpStart)+o*i+1,y=i,u=0,c=t.length;u<c;u++)h=t[u].sample,this.samples.hasOwnProperty(h)||(this.samples[h]=this.sampleCount,this.sampleNames.push(h),this.sampleCount++);for(u=0,c=t.length;u<c;u++)if(!((l=t[u]).end<r)){if(l.start>s)break;f=this.samples[l.sample]*w+b,d=l.value,this.isLog||(d=Math.log2(d/2)),p=d<-.1?this.negColorScale.getColor(d):d>.1?this.posColorScale.getColor(d):"white",g=Math.round((l.start-r)/y),m=Math.round((l.end-r)/y),v=Math.max(1,m-g),ye.graphics.fillRect(n,g,f,v,w-2*b,{fillStyle:p})}}else console.log("No feature list")},ye.SegTrack.prototype.computePixelHeight=function(e){var t,n,i,r="SQUISHED"===this.displayMode?this.sampleSquishHeight:this.sampleExpandHeight;for(t=0,n=e.length;t<n;t++)i=e[t].sample,this.samples.hasOwnProperty(i)||(this.samples[i]=this.sampleCount,this.sampleNames.push(i),this.sampleCount++);return this.sampleCount*r},ye.SegTrack.prototype.sortSamples=function(e,t,n,i){var r=this,o="ASC"===i?1:-1;this.featureSource.getFeatures(e,t,n).then(function(e){var i,a,s,l,c,h,u={},f=n-t+1;for(l=0;l<e.length;l++)if(!((i=e[l]).end<t)){if(i.start>n)break;a=Math.max(t,i.start),s=(Math.min(n,i.end)-a)/f,(c=u[i.sample])||(c=0),u[i.sample]=c+s*i.value}for((h=Object.keys(r.samples)).sort(function(e,t){var n=u[e],i=u[t];return n||(n=Number.MAX_VALUE),i||(i=Number.MAX_VALUE),n==i?0:n>i?o:-1*o}),l=0;l<h.length;l++)r.samples[h[l]]=l;r.sampleNames=h,r.trackView.update()})},ye.SegTrack.prototype.popupData=function(e){var t,n,i,r=e.genomicLocation,o=(e.x,e.y),a=e.viewport.genomicState.referenceFrame,s="SQUISHED"===this.displayMode?this.sampleSquishHeight:this.sampleExpandHeight;if((n=Math.floor(o/s))<this.sampleNames.length){if(t=this.sampleNames[n],i=[{name:"Sample",value:t}],this.featureSource.featureCache){var l=a.chrName;this.featureSource.featureCache.queryFeatures(l,r,r).forEach(function(e){e.sample===t&&i.push({name:"Value",value:e.value})})}return i}return null},ye.SegTrack.prototype.popupMenuItemList=function(t){var n,i=this;return(n=e("<div>")).text("Sort by value"),[{name:void 0,object:n,click:function(){var e=t.genomicLocation,n=t.viewport.genomicState.referenceFrame,r=n.toBP(2.5);i.sortSamples(n.chrName,e-r,e+r,we),we="ASC"===we?"DESC":"ASC",t.popover.hide()},init:void 0}]},Ae=ye,Ae=function(e){function t(){var t=e.oauth.google.access_token;return t||"undefined"==typeof oauth||(t=oauth.google.access_token),t}return e.ga4ghGet=function(n){var i=n.url+"/"+n.entity+"/"+n.entityId;return n.headers={"Cache-Control":"no-cache"},n.oauthToken=t(),e.xhr.loadJson(i,n)},e.ga4ghSearch=function(n){return new Promise(function(i,r){var o=n.results?n.results:[],a=n.url,s=n.body,l=n.decode,c=e.oauth.google.apiKey,h=e.oauth.google.access_token,u="?",f=n.fields;return h||"undefined"==typeof oauth||(c=oauth.google.access_token),c&&(a=a+u+"key="+c,u="&"),f&&(a=a+u+"fields="+f),function n(c){c?s.pageToken=c:null!=s.pageToken&&delete s.pageToken;var h=JSON.stringify(s);e.xhr.loadJson(a,{sendData:h,contentType:"application/json",headers:{"Cache-Control":"no-cache"},oauthToken:t()}).then(function(e){var t,r;e?((r=l?l(e):e)&&r.forEach(function(e){o.push(e)}),(t=e.nextPageToken)?n(t):i(o)):i(o)}).catch(function(e){r(e)})}()})},e.ga4ghSearchReadGroupSets=function(t){e.ga4ghSearch({url:t.url+"/readgroupsets/search",body:{datasetIds:[t.datasetId],pageSize:"10000"},decode:function(e){return e.readGroupSets}}).then(function(e){t.success(e)}).catch(function(e){console.log(e)})},e.ga4ghSearchVariantSets=function(t){e.ga4ghSearch({url:t.url+"/variantsets/search",body:{datasetIds:[t.datasetId],pageSize:"10000"},decode:function(e){return e.variantSets}}).then(function(e){t.success(e)}).catch(function(e){console.log(e)})},e.ga4ghSearchCallSets=function(t){t.datasetId?e.ga4ghSearchVariantSets({url:t.url,datasetId:t.datasetId,success:function(n){var i=[];n.forEach(function(e){i.push(e.id)}),t.datasetId=void 0,t.variantSetIds=i,e.ga4ghSearchCallSets(t)}}):e.ga4ghSearch({url:t.url+"/callsets/search",body:{variantSetIds:t.variantSetIds,pageSize:"10000"},decode:function(e){return e.callSets&&e.callSets.forEach(function(e){e.variantSetIds=t.variantSetIds}),e.callSets}}).then(function(e){t.success(e)}).catch(function(e){console.log(e)})},e.ga4ghSearchReadAndCallSets=function(t){e.ga4ghSearchReadGroupSets({url:t.url,datasetId:t.datasetId,success:function(n){e.ga4ghSearchCallSets({url:t.url,datasetId:t.datasetId,success:function(e){var i={};e.forEach(function(e){i[e.name]=e});var r=[];n.forEach(function(e){var n={readGroupSetId:e.id,name:e.name,datasetId:t.datasetId},o=i[e.name];o&&(n.callSetId=o.id,n.variantSetIds=o.variantSetIds),r.push(n)}),t.success(r)}})}})},e}((Ae=function(e){var t={ALIGNMENT_MATCH:"M",INSERT:"I",DELETE:"D",SKIP:"N",CLIP_SOFT:"S",CLIP_HARD:"H",PAD:"P",SEQUENCE_MATCH:"=",SEQUENCE_MISMATCH:"X"};return e.Ga4ghAlignmentReader=function(t){this.config=t,this.url=t.url,this.filter=t.filter||new e.BamFilter,this.readGroupSetIds=t.readGroupSetIds,this.authKey=t.authKey,this.samplingWindowSize=void 0===t.samplingWindowSize?100:t.samplingWindowSize,this.samplingDepth=void 0===t.samplingDepth?100:t.samplingDepth,t.viewAsPairs?this.pairsSupported=!0:this.pairsSupported=void 0===t.pairsSupported||t.pairsSupported},e.Ga4ghAlignmentReader.prototype.readAlignments=function(n,i,r){var o=this;return new Promise(function(a,s){function l(n){var i,r,a,s,l,c=n.alignments,h=c.length,u=[],f=e.browser.genome;for(i=0;i<h;i++)n=c[i],(r=new e.BamAlignment).readName=n.fragmentName,r.properPlacement=n.properPlacement,r.duplicateFragment=n.duplicateFragment,r.numberReads=n.numberReads,r.fragmentLength=n.fragmentLength,r.readNumber=n.readNumber,r.failedVendorQualityChecks=n.failedVendorQualityChecks,r.secondaryAlignment=n.secondaryAlignment,r.supplementaryAlignment=n.supplementaryAlignment,r.seq=n.alignedSequence,r.qual=n.alignedQuality,r.matePos=n.nextMatePosition,r.tagDict=n.info,r.flags=0,n.alignment?(r.mapped=!0,r.chr=n.alignment.position.referenceName,f&&(r.chr=f.getChromosomeName(r.chr)),r.start=parseInt(n.alignment.position.position),r.strand=!n.alignment.position.reverseStrand,r.mq=n.alignment.mappingQuality,r.cigar=p(n.alignment.cigar),a=d(n.alignment.cigar),r.lengthOnRef=a.lengthOnRef,l=g(r,a.array),r.blocks=l.blocks,r.insertions=l.insertions):r.mapped=!1,(s=n.nextMatePosition)&&(r.mate={chr:s.referenceFrame,position:parseInt(s.position),strand:!s.reverseStrand}),o.filter.pass(r)&&u.push(r);return u;function p(e){var n="";return e.forEach(function(e){var i=t[e.operation],r=e.operationLength;n+=r+i}),n}function d(e){var n,i,r,o,a=0,s=[];for(o=0;o<e.length;o++)n=e[o],r=t[n.operation],i=parseInt(n.operationLength),"M"!==r&&"EQ"!==r&&"X"!==r&&"D"!==r&&"N"!==r&&"="!==r||(a+=i),s.push({len:i,ltr:r});return{lengthOnRef:a,array:s}}function g(e,t){for(var n,i,r,o,a=[],s=0,l=e.start,c=t.length,h=0;h<c;h++){var u=t[h];switch(u.ltr){case"H":case"P":break;case"S":s+=u.len,r="S";break;case"N":l+=u.len,r="N";break;case"D":l+=u.len,r="D";break;case"I":i="*"===e.seq?"*":e.seq.substr(s,u.len),o=e.qual?e.qual.slice(s,u.len):void 0,void 0===n&&(n=[]),n.push({start:l,len:u.len,seq:i,qual:o}),s+=u.len;break;case"M":case"EQ":case"=":case"X":i="*"===e.seq?"*":e.seq.substr(s,u.len),o=e.qual?e.qual.slice(s,u.len):void 0,a.push({start:l,len:u.len,seq:i,qual:o,gapType:r}),s+=u.len,l+=u.len;break;default:console.log("Error processing cigar element: "+u.len+u.ltr)}}return{blocks:a,insertions:n}}}(o.chrAliasTable?Promise.resolve(o.chrAliasTable):new Promise(function(t,n){o.readMetadata().then(function(i){if(o.chrAliasTable={},e.browser&&i.readGroups&&i.readGroups.length>0){var r=i.readGroups[0].referenceSetId;if(console.log("No reference set specified"),r){var a=o.url+"/references/search";e.ga4ghSearch({url:a,body:{referenceSetId:r},decode:function(e){return e.references}}).then(function(n){n.forEach(function(t){var n=t.name,i=e.browser.genome.getChromosomeName(n);o.chrAliasTable[i]=n}),t(o.chrAliasTable)}).catch(n)}else!function(e,t){var n;if("461916304629"===t||"337315832689"===t){for(n=1;n<23;n++)e["chr"+n]=n;e.chrX="X",e.chrY="Y",e.chrM="MT"}}(o.chrAliasTable,o.config.datasetId),t(o.chrAliasTable)}else t(o.chrAliasTable)}).catch(n)})).then(function(t){var c=t.hasOwnProperty(n)?t[n]:n,h=o.url+"/reads/search";e.ga4ghSearch({url:h,body:{readGroupSetIds:[o.readGroupSetIds],referenceName:c,start:i,end:r,pageSize:"10000"},decode:l,results:new e.AlignmentContainer(n,i,r,o.samplingWindowSize,o.samplingDepth,o.pairsSupported)}).then(a).catch(s)}).catch(s)})},e.Ga4ghAlignmentReader.prototype.readMetadata=function(){return e.ga4ghGet({url:this.url,entity:"readgroupsets",entityId:this.readGroupSetIds})},e.decodeGa4ghReadset=function(e){var t=[];return e.fileData.forEach(function(e){e.refSequences.forEach(function(e){t.push(e.name)})}),t},e}((Ae=function(e){var t={ALIGNMENT_MATCH:"M",INSERT:"I",DELETE:"D",SKIP:"N",CLIP_SOFT:"S",CLIP_HARD:"H",PAD:"P",SEQUENCE_MATCH:"=",SEQUENCE_MISMATCH:"X"};return e.Ga4ghAlignment=function(n,i){var r;this.readName=n.fragmentName,this.properPlacement=n.properPlacement,this.duplicateFragment=n.duplicateFragment,this.numberReads=n.numberReads,this.fragmentLength=n.fragmentLength,this.readNumber=n.readNumber,this.failedVendorQualityChecks=n.failedVendorQualityChecks,this.secondaryAlignment=n.secondaryAlignment,this.supplementaryAlignment=n.supplementaryAlignment,this.seq=n.alignedSequence,this.qual=n.alignedQuality,this.tagDict=n.info,n.alignment?(this.mapped=!0,this.chr=n.alignment.position.referenceName,i&&(this.chr=i.getChromosomeName(this.chr)),this.start=parseInt(n.alignment.position.position),this.strand=!n.alignment.position.reverseStrand,this.mq=n.alignment.mappingQuality,r=function(e){var n,i,r,o,a=0,s=[];for(o=0;o<e.length;o++)n=e[o],r=t[n.operation],i=parseInt(n.operationLength),"M"!=r&&"EQ"!=r&&"X"!=r&&"D"!=r&&"N"!=r&&"="!=r||(a+=i),s.push({len:i,ltr:r});return{lengthOnRef:a,array:s}}(n.alignment.cigar),this.lengthOnRef=r.lengthOnRef,this.blocks=function(e,t){for(var n,i,r,o=[],a=0,s=e.start,l=t.length,c=0;c<l;c++){var h=t[c];switch(h.ltr){case"H":case"P":break;case"S":a+=h.len,r="S";break;case"N":s+=h.len,r="N";break;case"D":s+=h.len,r="D";break;case"I":a+=h.len;break;case"M":case"EQ":case"=":case"X":n="*"===e.seq?"*":e.seq.substr(a,h.len),i="*"===e.qual?"*":e.qual.slice(a,h.len),o.push({start:s,len:h.len,seq:n,qual:i,gapType:r}),a+=h.len,s+=h.len;break;default:console.log("Error processing cigar element: "+h.len+h.ltr)}}return o}(this,r.array)):this.mapped=!1,n.nextMatePosition&&(this.mate={chr:n.nextMatePosition.referenceFrame,position:parseInt(n.nextMatePosition.position),strand:!n.nextMatePosition.reverseStrand},this.info=n.info),e.BamUtils.setPairOrientation(this)},e.Ga4ghAlignment.prototype.isMapped=function(){return this.mapped},e.Ga4ghAlignment.prototype.isPaired=function(){return this.numberReads&&this.numberReads>1},e.Ga4ghAlignment.prototype.isProperPair=function(){return void 0===this.properPlacement||this.properPlacement},e.Ga4ghAlignment.prototype.isFirstOfPair=function(){return this.readNumber&&0===this.readNumber},e.Ga4ghAlignment.prototype.isSecondOfPair=function(){return this.readNumber&&1===this.readNumber},e.Ga4ghAlignment.prototype.isSecondary=function(){return this.secondaryAlignment},e.Ga4ghAlignment.prototype.isSupplementary=function(){return this.supplementaryAlignment},e.Ga4ghAlignment.prototype.isFailsVendorQualityCheck=function(){return this.failedVendorQualityChecks},e.Ga4ghAlignment.prototype.isDuplicate=function(){return this.duplicateFragment},e.Ga4ghAlignment.prototype.isMateMapped=function(){return this.mate},e.Ga4ghAlignment.prototype.mateStrand=function(){return this.mate&&this.mate.strand},e.Ga4ghAlignment.prototype.tags=function(){return this.info},e.Ga4ghAlignment.prototype.popupData=function(t){var n,i;for(var r in(i=[]).push({name:"Read Name",value:this.readName}),i.push("<hr>"),i.push({name:"Alignment Start",value:e.numberFormatter(1+this.start),borderTop:!0}),i.push({name:"Read Strand",value:!0===this.strand?"(+)":"(-)",borderTop:!0}),i.push({name:"Cigar",value:this.cigar}),i.push({name:"Mapped",value:o(this.isMapped())}),i.push({name:"Mapping Quality",value:this.mq}),i.push({name:"Secondary",value:o(this.isSecondary())}),i.push({name:"Supplementary",value:o(this.isSupplementary())}),i.push({name:"Duplicate",value:o(this.isDuplicate())}),i.push({name:"Failed QC",value:o(this.isFailsVendorQualityCheck())}),this.isPaired()&&(i.push("<hr>"),i.push({name:"First in Pair",value:!this.isSecondOfPair(),borderTop:!0}),i.push({name:"Mate is Mapped",value:o(this.isMateMapped())}),this.pairOrientation&&i.push({name:"Pair Orientation",value:this.pairOrientation}),this.isMateMapped()&&(i.push({name:"Mate Start",value:this.matePos}),i.push({name:"Mate Strand",value:this.mateStrand()?"(-)":"(+)"}),i.push({name:"Insert Size",value:this.fragmentLength}))),i.push("<hr>"),this.tags(),n=!0,this.tagDict)this.tagDict.hasOwnProperty(r)&&(n?(i.push({name:r,value:this.tagDict[r],borderTop:!0}),n=!1):i.push({name:r,value:this.tagDict[r]}));return i;function o(e){return e?"Yes":"No"}},e}((Ae=function(t){return t.WIGTrack=function(e){this.config=e,this.url=e.url,void 0===e.color&&(e.color="rgb(150,150,150)"),void 0===e.height&&(e.height=50),t.configTrack(this,e),"bigwig"===e.format?this.featureSource=new t.BWSource(e):"tdf"===e.format?this.featureSource=new t.TDFSource(e):this.featureSource=new t.FeatureSource(e),void 0!==e.max?this.dataRange={min:e.min||0,max:e.max}:this.autoscale=!0,this.windowFunction=e.windowFunction||"mean",this.paintAxis=t.paintAxis},t.WIGTrack.prototype.getFeatures=function(e,t,n,i){return this.featureSource.getFeatures(e,t,n,i,this.windowFunction)},t.WIGTrack.prototype.menuItemList=function(n){var i,r,o=this,a=[];return a.push(t.dataRangeMenuItem(n,this.trackView)),a.push({object:e((i=o.autoscale,r=[],r.push('<div id="datarange-autoscale">'),r.push(!0===i?'<i class="fa fa-check">':'<i class="fa fa-check fa-check-hidden">'),r.push("</i>"),r.push("Autoscale"),r.push("</div>"),r.join(""))),click:function(){var t=e(this).find("i");n.hide(),o.autoscale=!o.autoscale,!0===o.autoscale?t.removeClass("fa-check-hidden"):t.addClass("fa-check-hidden"),o.trackView.setDataRange(void 0,void 0,o.autoscale)}}),a},t.WIGTrack.prototype.getFileHeader=function(){var e=this;return"function"==typeof e.featureSource.getFileHeader?e.featureSource.getFileHeader().then(function(t){return t&&(t.name&&!e.config.name&&(e.name=t.name),t.color&&!e.config.color&&(e.color="rgb("+t.color+")")),t}):Promise.resolve(null)},t.WIGTrack.prototype.draw=function(e){var n,i,r,o,a,s,l,c=this,h=e.features,u=e.context,f=e.bpPerPixel,p=e.bpStart,d=e.pixelWidth,g=e.pixelHeight,m=p+d*f+1;if(this.currentFeatures=e.features,"string"==typeof c.color&&c.color.startsWith("rgb(")&&(o=t.Color.addAlpha(c.color,.1)),h&&h.length>0){if(c.autoscale||void 0===c.dataRange){var v=(a=h,s=0,l=-Number.MAX_VALUE,a.forEach(function(e){Number.isNaN(e.value)||(s=Math.min(s,e.value),l=Math.max(l,e.value))}),{min:s,max:l});n=c.config.min||v.min,i=v.max}else n=void 0===c.dataRange.min?0:c.dataRange.min,i=c.dataRange.max;if(void 0===c.dataRange&&(c.dataRange={}),c.dataRange.min=n,c.dataRange.max=i,i>n){if(r=i-n,h.forEach(function(e,o,a){var s,l,h,d,v,y;if(e.end<p)return;if(e.start>m)return;h=Math.floor((e.start-p)/f),y=Math.ceil((e.end-p)/f),d=Math.max(1,y-h),w=n,b=i,w>0&&b<0||w<0&&b>0?e.value<0?(s=i/r,l=-e.value/r):(s=(i-e.value)/r,l=e.value/r):n<0?(s=0,l=-e.value/r):(s=1-e.value/r,l=e.value/r);var w,b;v="function"==typeof c.color?c.color(e.value):c.color,t.graphics.fillRect(u,h,s*g,d,l*g,{fillStyle:v})}),n<0){var y=u.lineWidth;u.lineWidth=5;var w=i/(i-n)*e.pixelHeight;u.lineWidth=y}t.graphics.strokeLine(u,0,w,e.pixelWidth,w,{strokeStyle:o})}}},t.WIGTrack.prototype.popupData=function(e){if(!this.currentFeatures)return null;var n,i,r,o=e.genomicLocation,a=e.viewport.genomicState.referenceFrame;return(n=this.currentFeatures).length>0?(i=[],(r=function(e,t,n){var i,r,o,a=0,s=e.length-1,l=a+s>>1;for(;!c(e[l],t,n)&&a<s;)t<e[l].start?s=l-1:t>e[l].end&&(a=l+1),l=a+s>>1;{if(c(e[l],t,n)){if(c(i=e[l],t,0))return i;for(r=l;r-- >=0&&(c(e[r]),!n);){if(c(e[r],t,0))return e[r];for(o(e[r],t)<o(i,t)&&(i=e[r]),r=l;r++<e.length&&(c(e[r]),!n);){if(c(e[r],t,0))return e[r];o(e[r],t)<o(i,t)&&(i=e[r])}}return i}return void console.log(t+" not found!")}function c(e,t,n){return t>=e.start-n&&t<=e.end+n}function o(e,t){return Math.min(Math.abs(e.start-t),Math.abs(e.end-t))}}(n,o,2*a.bpPerPixel))&&(i.push({name:"Position:",value:t.numberFormatter(r.start+1)+"-"+t.numberFormatter(r.end)}),i.push({name:"Value:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",value:t.numberFormatter(r.value)})),i):void 0},t}((Ae=function(e){return e.UCSCServiceReader=function(e){this.config=e},e.UCSCServiceReader.prototype.readFeatures=function(t,n,i){var r=this.config.url+"&table="+this.config.tableName+"&chr="+t+"&start="+n+"&end="+i;return e.xhr.loadJson(r,this.config).then(function(e){return e?(e.forEach(function(e){e.hasOwnProperty("exonStarts")&&e.hasOwnProperty("exonEnds")&&e.hasOwnProperty("exonCount")&&e.hasOwnProperty("cdsStart")&&e.hasOwnProperty("cdsEnd")&&function(e){var t,n,i,r,o,a;t=e.exonCount,n=e.exonStarts.split(","),i=e.exonEnds.split(","),r=[];for(var s=0;s<t;s++){o=parseInt(n[s]),a=parseInt(i[s]);var l={start:o,end:a};(e.cdsStart>a||e.cdsEnd<e.cdsStart)&&(l.utr=!0),e.cdsStart>=o&&e.cdsStart<=a&&(l.cdStart=e.cdsStart),e.cdsEnd>=o&&e.cdsEnd<=a&&(l.cdEnd=e.cdsEnd),r.push(l)}e.exons=r}(e)}),e):null})},e}((Ae=((be=Ae||{}).loadTribbleIndex=function(e,t){var n=be.browser?be.browser.genome:null;return new Promise(function(i){function r(e){var t=e.getString(),i=0;n&&(t=n.getChromosomeName(t));for(var r=e.getInt(),o=e.getInt(),a=e.getInt(),s=(e.getInt(),e.getInt(),e.getLong()),l=new Array,c=0;c<o;c++){var h=e.getLong();l.push({min:s,max:h}),s=h,h>i&&(i=h)}return{chr:t,blocks:l,longestFeature:a,binWidth:r}}be.xhr.loadArrayBuffer(e,be.buildOptions(t)).then(function(e){if(e){var t={},n=new be.BinaryParser(new DataView(e));!function(e){e.getInt(),e.getInt();var t=e.getInt();if(e.getString(),e.getLong(),e.getLong(),e.getString(),e.getInt(),t<3&&(SEQUENCE_DICTIONARY_FLAG,SEQUENCE_DICTIONARY_FLAG),t>=3)for(var n=e.getInt();n-- >0;)e.getString(),e.getString()}(n);for(var o=n.getInt();o-- >0;){var a=r(n);t[a.chr]=a}i(new be.TribbleIndex(t))}else i(null)}).catch(function(e){console.log(e),i(null)})})},be.TribbleIndex=function(e){this.chrIndex=e},be.TribbleIndex.prototype.blocksForRange=function(e,t,n){var i=this.chrIndex[e];if(i){var r=i.blocks,o=i.longestFeature,a=i.binWidth,s=Math.max(t-o,0),l=Math.floor(s/a);if(l>=r.length)return[];var c=Math.min(Math.floor((n-1)/a),r.length-1),h=r[l].min,u=r[c].max;return 0==u-h?[]:[{minv:{block:h,offset:0},maxv:{block:u,offset:0}}]}return null},be))||{}))||{}))||{}))||{}))||{}),Ae=function(e){return e.genomeIdLUT=function(e){return{dm3:"dm3",mm10:"mm10",hg19:"hg19",hg38:"GRCh38"}[e]},e.loadGenome=function(t){var n,i,r=t.cytobandURL,a=t.aliasURL;return(i=new e.FastaSequence(t)).init().then(function(){i.chromosomeNames,i.chromosomes}).then(function(t){return r?function(t,n){{if(t.startsWith("data:")){var i=function(e){var t,n=e.split(","),i=n[0].split(":")[1],r=n[1];r=i.indexOf("base64")>=0?atob(r):decodeURI(r);t=new Uint8Array(r.length);for(var a=0;a<r.length;a++)t[a]=r.charCodeAt(a);var s=new o.Gunzip(t).decompress();return String.fromCharCode.apply(null,s)}(t);return Promise.resolve(r(i))}return e.xhr.loadString(t,e.buildOptions(n)).then(function(e){return r(e)})}function r(t){for(var n,i=[],r=0,o=t.splitLines(),a=o.length,s={},l=0;l<a;l++){var c=o[l].split("\t"),h=c[0];if(n||(n=h),h!=n&&(s[n]=i,i=[],n=h,r=0,0),5==c.length){var h=c[0],u=parseInt(c[1]),f=parseInt(c[2]),p=c[3],d=c[4];i[r++]=new e.Cytoband(u,f,p,d)}}return s}}(r,i.config):void 0}).then(function(t){return n=t,a?(r=a,o=i.config,e.xhr.loadString(r,e.buildOptions(o)).then(function(e){var t=e.splitLines(),n=[];return t.forEach(function(e){!e.startsWith("#")&e.length>0&&n.push(e.split("\t"))}),n})):void 0;var r,o}).then(function(r){return new e.Genome(t.id,i,n,r)})},e.Genome=function(t,n,i,r){this.id=t,this.sequence=n,this.chromosomeNames=n.chromosomeNames,this.chromosomes=n.chromosomes,this.ideograms=i,function(t){var n,i,r,o;t.wgChromosomeNames=[],t.ideograms?t.chromosomeNames.forEach(function(e){var n=t.ideograms[e];n&&n.length>0&&t.wgChromosomeNames.push(e)}):(i=Object.keys(t.chromosomes).map(function(e){return t.chromosomes[e].bpLength}),r=e.Math.mean(i),o=r/50,t.wgChromosomeNames=t.chromosomeNames.filter(function(e){return t.chromosomes[e].bpLength>o}));n=0,t.wgChromosomeNames.forEach(function(e){n+=t.chromosomes[e].bpLength}),t.chromosomes.all={name:"all",bpLength:n}}(this);var o={},a=this;this.chromosomeNames.forEach(function(e){var t=e.startsWith("chr")?e.substring(3):"chr"+e;o[t]=e,"chrM"===e&&(o.mt="chrM"),"MT"===e&&(o.chrm="MT"),o[e.toLowerCase()]=e}),r&&r.forEach(function(e){var t,n;for(n=0;n<e.length;n++)if(a.chromosomes[e[n]]){t=e[n];break}t&&e.forEach(function(e){e!==t&&(o[e.toLowerCase()]=t,o[e]=t)})}),this.chrAliasTable=o},e.Genome.prototype.getChromosomeName=function(e){var t=this.chrAliasTable[e.toLowerCase()];return t||e},e.Genome.prototype.getChromosome=function(e){return e=this.getChromosomeName(e),this.chromosomes[e]},e.Genome.prototype.getCytobands=function(e){return this.ideograms?this.ideograms[e]:null},e.Genome.prototype.getLongestChromosome=function(){var e,t,n=this.chromosomes;for(t in n){if(n.hasOwnProperty(t)){var i=n[t];(void 0===e||i.bpLength>e.bpLength)&&(e=i)}return e}},e.Genome.prototype.getChromosomes=function(){return this.chromosomes},e.Genome.prototype.getGenomeCoordinate=function(e,t){var n=this.getCumulativeOffset(e);if(void 0!==n)return n+t},e.Genome.prototype.getChromosomeCoordinate=function(e){var t,n,r,o,a;for(void 0===this.cumulativeOffsets&&computeCumulativeOffsets.call(this),r=0;r<this.wgChromosomeNames.length;r++){if(o=this.wgChromosomeNames[r],(a=this.cumulativeOffsets[o])>e)return{chr:t,position:e-n};t=o,n=a}return{chr:i.last(this.chromosomeNames),position:0}},e.Genome.prototype.getCumulativeOffset=function(e){var t=this,n=this.getChromosomeName(e);return void 0===this.cumulativeOffsets&&function(){var e={},n=0;t.wgChromosomeNames.forEach(function(i){e[i]=Math.floor(n);var r=t.getChromosome(i);n+=r.bpLength}),t.cumulativeOffsets=e}.call(this),this.cumulativeOffsets[n]},e.Genome.prototype.getGenomeLength=function(){var e;return e=i.last(this.wgChromosomeNames),this.getCumulativeOffset(e)+this.getChromosome(e).bpLength},e.Chromosome=function(e,t,n){this.name=e,this.order=t,this.bpLength=n},e.Cytoband=function(e,t,n,i){this.start=e,this.end=t,this.name=n,this.stain=0,"acen"==i?this.type="c":(this.type=i.charAt(1),"p"==this.type&&(this.stain=parseInt(i.substring(4))))},e.GenomicInterval=function(e,t,n,i){this.chr=e,this.start=t,this.end=n,this.features=i},e.GenomicInterval.prototype.contains=function(e,t,n){return this.chr==e&&this.start<=t&&this.end>=n},e.GenomicInterval.prototype.containsRange=function(e){return this.chr===e.chr&&this.start<=e.start&&this.end>=e.end},e.Genome.getKnownGenomes=function(){return e.Genome.KnownGenomes?Promise.resolve(e.Genome.KnownGenomes):e.xhr.loadJson("https://s3.amazonaws.com/igv.org.genomes/genomes.json",{}).then(function(t){var n={};return t.forEach(function(e){n[e.id]=e}),e.Genome.KnownGenomes=n,n})},e}((Ae=function(e){function t(e){var t,n;if(e.includes("/open?id=")){if(t=e.indexOf("/open?id=")+9,n=e.indexOf("&"),t>0&&n>t)return e.substring(t,n);if(t>0)return e.substring(t)}else if(e.includes("/file/d/"))return t=e.indexOf("/file/d/")+8,n=e.lastIndexOf("/"),e.substring(t,n)}return e.Google={isGoogleURL:function(e){return e.includes("googleapis")},translateGoogleCloudURL:function(e){var t,n,i,r,o,a;return t=e.indexOf("/",5),r=e.indexOf("?"),t<0?(console.log("Invalid gs url: "+e),e):(n=e.substring(5,t),o=r<0?e.substring(t+1):e.substring(t+1,r),i=encodeURIComponent(o),r>0&&(a=e.substring(r)),"https://www.googleapis.com/storage/v1/b/"+n+"/o/"+i+(a?a+"&alt=media":"?alt=media"))},addGoogleHeaders:function(t){t["Cache-Control"]="no-cache";var n=e.oauth.google.access_token;return n||"undefined"==typeof oauth||(n=oauth.google.access_token),n&&!t.hasOwnProperty("Authorization")&&(t.Authorization="Bearer "+n),t},addApiKey:function(t){var n=e.oauth.google.apiKey,i=t.includes("?")?"&":"?";return void 0===n||t.includes("key=")||n&&(t=t+i+"key="+n),t},driveDownloadURL:function(e){var n;return(n=t(e))?"https://www.googleapis.com/drive/v3/files/"+n+"?alt=media":e},getDriveFileInfo:function(n){var i="https://www.googleapis.com/drive/v2/files/"+t(n);return e.xhr.loadJson(i,e.buildOptions({}))}},e}((Ae=((xe=Ae||{}).Ga4ghVariantReader=function(e){this.config=e,this.url=e.url,this.variantSetId=e.variantSetId,this.callSetIds=e.callSetIds,this.includeCalls=void 0===e.includeCalls||e.includeCalls},xe.Ga4ghVariantReader.prototype.readHeader=function(){var e=this;if(e.header)return Promise.resolve(e.header);if(e.header={},!1===e.includeCalls)return Promise.resolve(e.header);var t=e.url+"/callsets/search";return xe.ga4ghSearch({url:t,fields:"nextPageToken,callSets(id,name)",body:{variantSetIds:Array.isArray(e.variantSetId)?e.variantSetId:[e.variantSetId],pageSize:"10000"},decode:function(t){if(e.callSetIds){var n=[],i=new Set;return e.callSetIds.forEach(function(e){i.add(e)}),t.callSets.forEach(function(e){i.has(e.id)&&n.push(e)}),n}return t.callSets}}).then(function(t){return e.header.callSets=t,e.header})},xe.Ga4ghVariantReader.prototype.readFeatures=function(e,t,n){var i=this;return i.readHeader().then(function(e){return new Promise(function(e,t){i.chrAliasTable?e(i.chrAliasTable):i.readMetadata().then(function(t){i.metadata=t.metadata,i.chrAliasTable={},t.referenceBounds&&xe.browser&&t.referenceBounds.forEach(function(e){var t=e.referenceName,n=xe.browser.genome.getChromosomeName(t);i.chrAliasTable[n]=t}),e(i.chrAliasTable)})})}).then(function(r){var o=r.hasOwnProperty(e)?r[e]:e,a=i.url+"/variants/search";return xe.ga4ghSearch({url:a,fields:i.includeCalls?void 0:"nextPageToken,variants(id,variantSetId,names,referenceName,start,end,referenceBases,alternateBases,quality,filter,info)",body:{variantSetIds:Array.isArray(i.variantSetId)?i.variantSetId:[i.variantSetId],callSetIds:i.callSetIds?i.callSetIds:void 0,referenceName:o,start:t.toString(),end:n.toString(),pageSize:"10000"},decode:function(e){var t,n=[];return e.variants.forEach(function(e){(t=xe.createGAVariant(e)).isRefBlock()||n.push(t)}),n}})})},xe.Ga4ghVariantReader.prototype.readMetadata=function(){return xe.ga4ghGet({url:this.url,entity:"variantsets",entityId:this.variantSetId})},xe))||{}))||{}),Ae=function(e){e.GtexFileReader=function(e){this.config=e,this.file=e.url,this.codec=this.file.endsWith(".bin")?n:t,this.cache={},this.binary=this.file.endsWith(".bin"),this.compressed=this.file.endsWith(".compressed.bin")},e.GtexFileReader.prototype.readFeatures=function(t,n,i){var r=this;return new Promise(function(n,i){var o,a,s,l=r.file,c=r.index;function h(t,n,o){var a=t[n];if(a){var s=a.blocks,c=s[s.length-1],h=c.startPos+c.size-s[0].startPos,f={start:s[0].startPos,size:h};e.xhr.loadArrayBuffer(l,{range:f,withCredentials:r.config.withCredentials}).then(function(t){if(t){var n=new DataView(t),i=new e.BinaryParser(n),r=[];for(i.offset;i.hasNext();){var a=p(i);r.push(a)}o(r)}else o(null)}).catch(i)}else o([]);var p=function(e){return new u(e.getString(),e.getString(),e.getInt(),e.getString(),e.getString(),e.getFloat())}}function u(e,t,n,i,r,o){this.snp=e,this.chr=t,this.position=n,this.start=n,this.end=n+1,this.geneId=i,this.geneName=r,this.pValue=o}c?h(c,t,n):(o=r.file,a=function(e){r.index=e,h(e,t,n)},s=e.browser?e.browser.genome:null,e.xhr.loadArrayBuffer(o,{range:{start:0,size:200},withCredentials:r.config.withCredentials}).then(function(t){var n=new DataView(t),i=new e.BinaryParser(n),l=(i.getInt(),i.getInt(),i.getLong()),c=i.getInt();e.xhr.loadArrayBuffer(o,{range:{start:l,size:c},withCredentials:r.config.withCredentials}).then(function(t){for(var n=new DataView(t),i=null,r=new e.BinaryParser(n),i={},o=r.getInt();o-- >0;){var l=r.getString();s&&(l=s.getChromosomeName(l));var c=r.getLong(),h=r.getInt(),u=new Array;u.push(new Block(c,h)),i[l]=new ChrIdx(l,u)}a(i)})})),u.prototype.description=function(){return"<b>snp</b>:&nbsp"+this.snp+"<br/><b>location</b>:&nbsp"+this.chr+":"+formatNumber(this.position+1)+"<br/><b>gene</b>:&nbsp"+this.geneName+"<br/><b>pValue</b>:&nbsp"+this.pValue+"<br/><b>mLogP</b>:&nbsp"+this.mLogP},Block=function(e,t){this.startPos=e,this.size=t},ChrIdx=function(e,t){this.chr=e,this.blocks=t}})};var t=function(e){var t=e[0],n=e[1],i=parseInt(e[2])-1,r=e[3],o=e[4],a=e[5],s=parseFloat(e[6]),l=parseFloat(e[7]);return new Eqtl(t,n,i,r,o,a,s,l)},n=function(e){var t=e.getString(),n=e.getString(),i=e.getInt(),r=e.getString(),o=e.getString(),a=e.getFloat();return new Eqtl(t,n,i,r,o,a)};return e}((Ae=function(e){e.GtexSelection=function(e,n){this.geneColors={},this.gene=null,this.snp=null,this.genesCount=0,e&&(this.gene=e.toUpperCase(),this.geneColors[this.gene]=t[this.genesCount++]),n&&(this.snp=n.toUpperCase())},e.GtexSelection.prototype.addGene=function(e){this.geneColors[e.toUpperCase()]||(this.geneColors[e.toUpperCase()]=t[this.genesCount++])},e.GtexSelection.prototype.colorForGene=function(e){return this.geneColors[e.toUpperCase()]};var t=new Array;return t.push("rgb(228,26,28)"),t.push("rgb(55,126,184)"),t.push("rgb(77,175,74)"),t.push("rgb(166,86,40)"),t.push("rgb(152,78,163)"),t.push("rgb(255,127,0)"),t.push("rgb(247,129,191)"),t.push("rgb(153,153,153)"),t.push("rgb(255,255,51)"),t.push("rgb(102, 194, 165"),t.push("rgb(252, 141, 98"),t.push("rgb(141, 160, 203"),t.push("rgb(231, 138, 195"),t.push("rgb(166, 216, 84"),t.push("rgb(255, 217, 47"),t.push("rgb(229, 196, 148"),t.push("rgb(179, 179, 179"),t.push("rgb( 141, 211, 199"),t.push("rgb(255, 255, 179"),t.push("rgb(190, 186, 218"),t.push("rgb(251, 128, 114"),t.push("rgb(128, 177, 211"),t.push("rgb(253, 180, 98"),t.push("rgb(179, 222, 105"),t.push("rgb(252, 205, 229"),t.push("rgb(217, 217, 217"),t.push("rgb(188, 128, 189"),t.push("rgb(204, 235, 197"),t.push("rgb(255, 237, 111"),e}((Ae=((ke=Ae||{}).EqtlTrack=function(e){var t=e.url,n=e.name;this.config=e,this.url=t,this.name=n,this.pValueField=e.pValueField||"pValue",this.geneField=e.geneField||"geneSymbol",this.snpField=e.snpField||"snp",this.autoscale=void 0===e.autoScale||e.autoScale,this.percentile=void 0===e.percentile?98:e.percentile,this.minLogP=e.minLogP||3.5,this.maxLogP=e.maxLogP||25,this.background=e.background,this.divider=e.divider||"rgb(225,225,225)",this.dotSize=e.dotSize||2,this.height=e.height||100,this.autoHeight=!1,this.disableButtons=e.disableButtons,this.visibilityWindow=e.visibilityWindow,this.featureSource=new ke.FeatureSource(e)},ke.EqtlTrack.prototype.paintAxis=function(e,t,n){var i=(this.maxLogP-this.minLogP)/n,r={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};ke.graphics.fillRect(e,0,0,t,n,{fillStyle:"rgb(255, 255, 255)"});for(var o=Math.ceil(10*(this.maxLogP-this.minLogP)/n),a=4;a<=this.maxLogP;a+=o){var s,l,c,h,u;s=(u=.85*t)-5,l=u,c=h=n-Math.round((a-this.minLogP)/i),ke.graphics.strokeLine(e,s,c,l,h,r),c>8&&ke.graphics.fillText(e,a,s-1,c+2,r)}r.textAlign="center",ke.graphics.fillText(e,"-log10(pvalue)",t/4,n/2,r,{rotate:{angle:-90}})},ke.EqtlTrack.prototype.getFeatures=function(e,t,n){return this.featureSource.getFeatures(e,t,n)},ke.EqtlTrack.prototype.draw=function(e){var t,n,i,r=this,o=e.features,a=e.context,s=e.bpPerPixel,l=e.bpStart,c=e.pixelWidth,h=e.pixelHeight,u=l+c*s+1,f=(r.maxLogP-r.minLogP)/h,p=e.genomicState.selection;if(this.background&&ke.graphics.fillRect(a,0,0,c,h,{fillStyle:this.background}),ke.graphics.strokeLine(a,0,h-1,c,h-1,{strokeStyle:this.divider}),a){var d=o.length;a.save(),r.maxLogP=(t=l,n=u,i=o.filter(function(e){return e.position>=t&&e.position<=n}).map(function(e){return-Math.log(e[r.pValueField])/Math.LN10}),ke.Math.percentile(i,r.percentile)),g(!1),g(!0),a.restore()}function g(e){var t,n,i,u,g,m,v,y,w,b=e?2*r.dotSize:r.dotSize;for(n=0;n<d;n++)if(t=o[n],!((i=Math.round(t.position-l+.5)/s)<0)){if(i>c)break;if(v=t.snp.toUpperCase(),y=t[r.geneField].toUpperCase(),m=p&&(p.snp===v||p.gene===y),!e||m){p&&p.snp===v&&p.addGene(y);var x=-Math.log(t[r.pValueField])/Math.LN10;x>=r.minLogP&&(x>r.maxLogP?(x=r.maxLogP,w=!0):w=!1,u=Math.max(0+b,h-Math.round((x-r.minLogP)/f)),t.px=i,t.py=u,e&&p?(g=p.colorForGene(y),ke.graphics.setProperties(a,{fillStyle:g,strokeStyle:"black"})):(g=w?"rgb(150, 150, 150)":"rgb(180, 180, 180)",ke.graphics.setProperties(a,{fillStyle:g,strokeStyle:g})),ke.graphics.fillCircle(a,i,u,b),ke.graphics.strokeCircle(a,i,u,b))}}}},ke.EqtlTrack.prototype.popupData=function(e){var t=e.genomicLocation,n=(e.x,e.y),i=e.viewport.genomicState.referenceFrame;if(this.featureSource.featureCache){var r=i.chrName,o=2*this.dotSize*i.bpPerPixel,a=this.featureSource.featureCache.queryFeatures(r,t-o,t+o),s=this.dotSize,l=this.name;if(a&&a.length>0){var c=[];return a.forEach(function(e){e.end>=t-o&&e.start<=t+o&&e.py-n<2*s&&(c.length>0&&c.push("<hr>"),c.push({name:"snp id",value:e.snp},{name:"gene id",value:e.geneId},{name:"gene name",value:e.geneName},{name:"p value",value:e.pValue},{name:"tissue",value:l}))}),c}}},ke))||{}))||{}),(Se=Ae||{}).GtexReader=function(e){this.config=e,this.url=e.url,this.tissueName=e.tissueName,this.indexed=!0},Se.GtexReader.prototype.readFeatures=function(e,t,n){var i=this,r=e.startsWith("chr")?e.substr(3):e,o=Math.floor(t),a=Math.ceil(n),s=this.url+"?chromosome="+r+"&start="+o+"&end="+a+"&tissueName="+this.tissueName;return new Promise(function(e,t){Se.xhr.loadJson(s,{withCredentials:i.config.withCredentials}).then(function(t){t&&t.singleTissueEqtl?(t.singleTissueEqtl.forEach(function(e){e.chr="chr"+e.chromosome,e.position=e.start,e.start=e.start-1,e.snp=e.snpId,e.geneName=e.geneSymbol,e.geneId=e.gencodeId,e.end=e.start}),e(t.singleTissueEqtl)):e(null)}).catch(t)})},Ae=Se,(Ce=Ae||{}).ImmVarReader=function(e){this.config=e,this.url=e.url,this.cellConditionId=e.cellConditionId,this.valueThreshold=e.valueThreshold?e.valueThreshold:.05},Ce.ImmVarReader.prototype.readFeatures=function(e,t,n){var i=this,r=this.url+"?chromosome="+e+"&start="+t+"&end="+n+"&cell_condition_id="+this.cellConditionId;return new Promise(function(e,t){Ce.xhr.loadJson(r,{withCredentials:i.config.withCredentials}).then(function(t){t?(t.eqtls.forEach(function(e){e.chr=e.chromosome,e.start=e.position,e.end=e.position+1}),e(t.eqtls)):e(null)}).catch(function(e){t(e)})})},Ae=Ce,Ae=function(e){function t(e){var t=this;return new Promise(function(n,i){var r=t.fragmentSitesCache[e];if(r)n(r);else if(t.fragmentSitesIndex){var o=t.fragmentSitesIndex[e];void 0!==o&&o.nSites>0&&readSites(o.position,o.nSites).then(function(i){t.fragmentSitesCache[e]=i,n(i)}).catch(i)}else n(void 0)})}function n(e,t,n,i,r){var o=r.getString();r.getInt();for(var a=r.getFloat(),l=(r.getFloat(),r.getFloat(),r.getFloat(),r.getInt()),c=new s(e,t,{unit:o,binSize:l},r.getInt(),r.getInt(),n,i),h=r.getInt(),u={};h-- >0;){var f=r.getInt(),p=r.getLong(),d=r.getInt();u[f]={filePosition:p,size:d}}c.blockIndexMap=u;var g=a/(e.size/l)/(t.size/l);return c.averageCount=g,c}function r(e,t,n,i,r){this.normType=e,this.unit=t,this.binSize=n,this.values=i,this.normFactors=r}function a(e,t,n,i,r){this.type=e,this.chrIdx=t,this.unit=n,this.binSize=i,this.data=r}function s(e,t,n,i,r,o,a){this.chr1=e,this.chr2=t,this.zoom=n,this.blockBinCount=i,this.blockColumnCount=r,this.chr1Sites=o,this.chr2Sites=a}function l(e,t,n){var r=this;this.chr1=e,this.chr2=t,this.bpZoomData=[],this.fragZoomData=[],i.each(n,function(e){"BP"===e.zoom.unit?r.bpZoomData.push(e):r.fragZoomData.push(e)})}return e.HiCReader=function(e){this.path=e.url,this.headPath=e.headURL||this.path,this.config=e,this.fragmentSitesCache={}},e.HiCReader.prototype.readHeader=function(){var t=this;return new Promise(function(n,i){e.xhr.loadArrayBuffer(t.path,e.buildOptions(t.config,{range:{start:0,size:64e3}})).then(function(i){if(i){var r=new e.BinaryParser(new DataView(i));t.magic=r.getString(),t.version=r.getInt(),t.masterIndexPos=r.getLong(),t.genomeId=r.getString(),t.attributes={};for(var o=r.getInt();o-- >0;)t.attributes[r.getString()]=r.getString();t.chromosomes=[];for(var a=r.getInt();a-- >0;)t.chromosomes.push({name:r.getString(),size:r.getInt()});t.bpResolutions=[];for(var s=r.getInt();s-- >0;)t.bpResolutions.push(r.getInt());t.fragResolutions=[];for(var l=r.getInt();l-- >0;)t.fragResolutions.push(r.getInt());if(l>0){t.sites=[];for(var c=r.getInt();c-- >0;)t.sites.push(r.getInt())}n(t)}else n(null)}).catch(function(e){i(e)})})},e.HiCReader.prototype.readFooter=function(t){var n=this,o={start:this.masterIndexPos,size:1e8};return new Promise(function(t,s){e.xhr.loadArrayBuffer(n.path,e.buildOptions(n.config,{range:o})).then(function(o){var s,l;if(o){var c=new e.BinaryParser(new DataView(o));c.getInt();n.masterIndex={};for(var h=c.getInt();h-- >0;)y=c.getString(),s=c.getLong(),l=c.getInt(),n.masterIndex[y]={start:s,size:l};for(n.expectedValueVectors={},h=c.getInt();h-- >0;){for(var u="NONE",f=c.getString(),p=c.getInt(),d=c.getInt(),g=[];d-- >0;)g.push(c.getDouble());for(var m=c.getInt(),v={};m-- >0;)v[c.getInt()]=c.getDouble();var y=f+"_"+p+"_"+u;n.expectedValueVectors[y]=new r(u,f,p,g,v)}if(n.version>=6){for(n.normalizedExpectedValueVectors={},h=c.getInt();h-- >0;){for(u=c.getString(),f=c.getString(),p=c.getInt(),d=c.getInt(),g=[];d-- >0;)g.push(c.getDouble());for(m=c.getInt(),v={};m-- >0;)v[c.getInt()]=c.getDouble();y=f+"_"+p+"_"+u;n.normalizedExpectedValueVectors[y]=new r(u,f,p,g,v)}for(n.normVectorIndex={},n.normalizationTypes=[],h=c.getInt();h-- >0;){u=c.getString();var w=c.getInt();f=c.getString(),p=c.getInt();var b=c.getLong(),x=c.getInt();y=a.getKey(u,w,f.binSize),!1===i.contains(n.normalizationTypes,u)&&n.normalizationTypes.push(u),n.normVectorIndex[y]={filePosition:b,sizeInByes:x}}}t(n)}else t(null)}).catch(function(e){s(e)})})},e.HiCReader.prototype.readMatrix=function(i){var r=this,o=r.masterIndex[i];return null==o&&fulfill(void 0),new Promise(function(i,a){e.xhr.loadArrayBuffer(r.path,e.buildOptions(r.config,{range:{start:o.start,size:o.size}})).then(function(o){if(o){var s=new e.BinaryParser(new DataView(o)),c=s.getInt(),h=s.getInt(),u=r.chromosomes[c],f=r.chromosomes[h],p=s.getInt(),d=[],g=t.call(r,u.name),m=t.call(r,f.name);Promise.all([g,m]).then(function(e){for(var t=e[0],r=e[1];p-- >0;){var o=n(u,f,t,r,s);d.push(o)}i(new l(c,h,d))}).catch(function(e){a(e)})}else i(null)}).catch(a)})},e.HiCReader.prototype.readBlock=function(t,n){var i,r,a=this,s=null,l=n.blockIndexMap;if(null!=l)s=l[t];return null==s?Promise.resolve(new Block):new Promise(function(n,l){e.xhr.loadArrayBuffer(a.path,e.buildOptions(a.config,{range:{start:s.filePosition,size:s.size}})).then(function(s){if(s){s=new o.Inflate(new Uint8Array(s)).decompress().buffer;var c=new e.BinaryParser(new DataView(s)),h=c.getInt(),u=[];if(a.version<7)for(i=0;i<h;i++){var f=c.getInt(),p=c.getInt(),d=c.getFloat();u.add(new ContactRecord(f,p,d))}else{var g=c.getInt(),m=c.getInt(),v=0==c.getByte(),y=c.getByte();if(1===y){var w=c.getShort();for(i=0;i<w;i++){p=m+c.getShort();var b=c.getShort();for(r=0;r<b;r++)f=g+c.getShort(),d=v?c.getShort():c.getFloat(),u.push(new ContactRecord(f,p,d))}}else if(2==y){var x=c.getInt(),k=c.getShort();for(i=0;i<x;i++){var S=i/k,C=g+(i-S*k),T=m+S;v?-32768!=(d=c.getShort())&&u.push(new ContactRecord(C,T,d)):(d=c.getFloat(),isNaN(d)||u.push(new ContactRecord(C,T,d)))}}else l("Unknown block type: "+y)}n(new Block(t,u))}else n(null)}).catch(l)})},a.getKey=function(e,t,n,i){return e+"_"+t+"_"+n+"_"+i},s.prototype.getKey=function(){return this.chr1.name+"_"+this.chr2.name+"_"+this.zoom.unit+"_"+this.zoom.binSize},l.prototype.getZoomData=function(e){var t,n="BP"===e.unit?this.bpZoomData:this.fragZoomData;for(t=0;t<n.length;t++){var i=n[t];if(e.binSize===i.zoom.binSize)return i}},ContactRecord=function(e,t,n){this.bin1=e,this.bin2=t,this.counts=n},Block=function(e,t){this.blockNumber=e,this.records=t},e}((Ae=function(e){var t="VARIANT",n="TRAIT";e.T2DVariantSource=function(e){this.config=e,this.url=e.url,this.trait=e.trait,this.dataset=e.dataset,this.pvalue=e.pvalue,void 0===e.valueThreshold&&(e.valueThreshold=.05),void 0===e.dataset?(this.queryJson=e.queryJson||a,this.jsonToVariants=e.jsonToVariants||s):(this.queryJson=e.queryJson||o,this.jsonToVariants=e.jsonToVariants||r)},e.T2DVariantSource.prototype.getFeatures=function(t,n,r){var o=this;return new Promise(function(a,s){if(o.cache&&o.cache.chr===t&&o.cache.end>r&&o.cache.start<n)a(o.cache.featuresBetween(n,r));else{var l=Math.max(r-n,1e7)/2,c=(r+n)/2,h=t.startsWith("chr")?t.substring(3):t,u=Math.max(0,c-l),f=c+l,p=o.config.proxy?o.config.proxy:o.url,d=o.queryJson(h,u,f,o.config);e.xhr.loadJson(p,{sendData:d,withCredentials:o.config.withCredentials}).then(function(n){var r;n?n.error_code?(e.presentAlert("Error querying trait "+o.trait+"  (error_code="+n.error_code+")",void 0),a(null)):((r=o.jsonToVariants(n,o.config)).sort(function(e,t){return e.POS-t.POS}),o.cache=new i(t,u,f,r),a(r)):a(null)}).catch(s)}})};var i=function(e,t,n,i){var r,o,a;for(this.chr=e,this.start=t,this.end=n,this.binSize=(n-t)/100,this.binIndeces=[0],this.features=i,a=0,r=0;r<i.length;r++)(o=Math.max(0,Math.floor((i[r].POS-this.start)/this.binSize)))>a&&(this.binIndeces.push(r),a=o)};function r(e,t){var n=[];return e.variants.forEach(function(e){var i={};e.forEach(function(e){for(var t in e)e.hasOwnProperty(t)&&("POS"===t&&(i.start=e[t]-1),i[t]=e[t])}),i.pvalue=i[t.pvalue][t.dataset][t.trait],i[t.pvalue]=void 0,n.push(i)}),n}function o(e,t,n,i){var r=i.trait,o=i.pvalue,a=i.dataset,s={passback:"x",entity:"variant",properties:{cproperty:["VAR_ID","DBSNP_ID","CHROM","POS"],orderBy:["CHROM"],dproperty:{},pproperty:JSON.parse('{"'+o+'": {"'+a+'": ["'+r+'"]}}')},filters:[{dataset_id:"x",phenotype:"x",operand:"CHROM",operator:"EQ",value:e,operand_type:"STRING"},{dataset_id:"x",phenotype:"x",operand:"POS",operator:"GTE",value:t,operand_type:"INTEGER"},{dataset_id:"x",phenotype:"x",operand:"POS",operator:"LTE",value:n,operand_type:"INTEGER"},{dataset_id:a,phenotype:r,operand:o,operator:"LT",value:i.valueThreshold,operand_type:"FLOAT"}]};return JSON.stringify(s)}function a(e,i,r,o){var a=o.url.includes("variant")?t:n,s=o.pvalue?o.pvalue:"PVALUE",l={user_group:"ui",filters:[{operand:"CHROM",operator:"EQ",value:e,filter_type:"STRING"},{operand:"POS",operator:"GT",value:i,filter_type:"FLOAT"},{operand:"POS",operator:"LT",value:r,filter_type:"FLOAT"},{operand:s,operator:"LTE",value:o.valueThreshold,filter_type:"FLOAT"}],columns:a===n?["CHROM","POS","DBSNP_ID","PVALUE","ZSCORE"]:["CHROM","POS",s,"DBSNP_ID"]};return a===n&&(l.trait=o.trait),o.proxy?"url="+o.url+"&data="+JSON.stringify(l):JSON.stringify(l)}function s(e,t){return e.variants.forEach(function(e){e.chr=e.CHROM,e.start=e.POS-1}),e.variants}return i.prototype.featuresBetween=function(e,t){var n=Math.max(0,Math.min(Math.floor((e-this.start)/this.binSize)-1,this.binIndeces.length-1)),i=Math.max(0,Math.min(Math.floor((t-this.start)/this.binSize),this.binIndeces.length-1));this.binIndeces[n],this.binIndeces[i];return this.features},e}((Ae=((Te=Ae||{}).GWASTrack=function(e){this.config=e,this.url=e.url,this.name=e.name,this.trait=e.trait,this.height=e.height||100,this.minLogP=e.minLogP||0,this.maxLogP=e.maxLogP||15,this.background=e.background,this.divider=e.divider||"rgb(225,225,225)",this.dotSize=e.dotSize||4,this.popoverWindow=void 0===e.popoverWindow?1e8:e.popoverWindow,this.description=e.description,this.proxy=e.proxy,this.portalURL=e.portalURL?e.portalURL:window.location.origin,this.variantURL=e.variantURL||"http://www.type2diabetesgenetics.org/variant/variantInfo/",this.traitURL=e.traitURL||"http://www.type2diabetesgenetics.org/trait/traitInfo/";var t=e.colorScale||{thresholds:[5e-8,5e-4,.5],colors:["rgb(255,50,50)","rgb(251,100,100)","rgb(251,170,170)","rgb(227,238,249)"]};this.pvalue=e.pvalue?e.pvalue:"PVALUE",this.colorScale=new Te.BinnedColorScale(t),e.format&&"gtexGWAS"===e.format?this.featureSource=new Te.FeatureSource(e):this.featureSource=new Te.T2DVariantSource(e)},Te.GWASTrack.prototype.getFeatures=function(e,t,n){return this.featureSource.getFeatures(e,t,n)},Te.GWASTrack.prototype.draw=function(e){var t,n,i,r,o,a,s,l,c,h=e.features,u=e.context,f=e.bpPerPixel,p=e.bpStart,d=e.pixelWidth,g=e.pixelHeight,m=p+d*f+1,v=(this.maxLogP-this.minLogP)/g,y=m-p<1e8;if(this.po=y?[]:void 0,this.background&&Te.graphics.fillRect(u,0,0,d,g,{fillStyle:this.background}),Te.graphics.strokeLine(u,0,g-1,d,g-1,{strokeStyle:this.divider}),h){i=h.length;for(var w=0;w<i;w++)if(!((n=(t=h[w]).start)<p)){if(n>m)break;(l=t.pvalue||t[this.pvalue])&&(s=this.colorScale.getColor(l),c=-Math.log(l)/2.302585092994046,r=f,o=Math.round((n-p)/r),a=Math.max(this.dotSize,g-Math.round((c-this.minLogP)/v)),s&&Te.graphics.setProperties(u,{fillStyle:s,strokeStyle:"black"}),Te.graphics.fillCircle(u,o,a,this.dotSize),y&&this.po.push({x:o,y:a,feature:t}))}}},Te.GWASTrack.prototype.paintAxis=function(e,t,n){var i=(this.maxLogP-this.minLogP)/n,r={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};Te.graphics.fillRect(e,0,0,t,n,{fillStyle:"rgb(255, 255, 255)"});for(var o=2;o<this.maxLogP;o+=2){var a=n-Math.round((o-this.minLogP)/i);Te.graphics.strokeLine(e,45,a-2,50,a-2,r),Te.graphics.fillText(e,o,44,a+2,r)}r.textAlign="center",Te.graphics.fillText(e,"-log10(pvalue)",t/2,n/2,r,{rotate:{angle:-90}})},Te.GWASTrack.prototype.popupData=function(e){e.genomicLocation;var t,n,i,r,o,a,s,l,c=e.x,h=e.y,u=(e.viewport.genomicState.referenceFrame,[]);if(this.po)for(t=0,n=this.po.length;t<n;t++)i=this.po[t],Math.abs(c-i.x)<this.dotSize&&Math.abs(h-i.y)<=this.dotSize&&(a=i.feature.CHROM||i.feature.chr,s=i.feature.POS||i.feature.start,l=i.feature[this.pvalue]||i.feature.pvalue,(r=i.feature.DBSNP_ID)&&(o=this.variantURL.startsWith("http")?this.variantURL:this.portalURL+"/"+this.variantURL,u.push("<a target='_blank' href='"+o+(o.endsWith("/")?"":"/")+r+"' >"+r+"</a>")),u.push(a+":"+s.toString()),u.push({name:"p-value",value:l}),i.feature.ZSCORE&&u.push({name:"z-score",value:i.feature.ZSCORE}),r&&(o=this.traitURL.startsWith("http")?this.traitURL:this.portalURL+"/"+this.traitURL,u.push("<a target='_blank' href='"+o+(o.endsWith("/")?"":"/")+r+"'>see all available statistics for this variant</a>")),t<n-1&&u.push("<p/>"));else u.push("Popover not available at this resolution.");return u},Te))||{}))||{}),Ae=function(t){function n(e){var t,n,i,r,o,a;if(o={},t=e.indexOf("?"),n=e.lastIndexOf("#"),t>=0)for(n<0&&(n=e.length),i=t+1;i<n;)(r=e.indexOf("&",i))<0&&(r=n),2===(a=e.substring(i,r).split("=",2)).length&&(o[a[0]]=a[1]),i=r+1;return o}return t.version="beta",t.createBrowser=function(r,o){var a,s,l,c,h,u,f,p,d,g,m,v,y,w,b,x,k,S,C;return t.browser&&t.removeBrowser(),void 0===o&&(o={}),function(e){void 0===e.encodeEnabled&&(e.encodeEnabled=!1);void 0===e.showLoadFileWidget&&(e.showLoadFileWidget=!1);void 0===e.minimumBases&&(e.minimumBases=40);void 0===e.showIdeogram&&(e.showIdeogram=!0);void 0===e.showCursorTrackingGuide&&(e.showCursorTrackingGuide=!1);void 0===e.showCenterGuide&&(e.showCenterGuide=!1);void 0===e.showKaryo&&(e.showKaryo=!1);void 0===e.trackLabelsVisible&&(e.trackLabelsVisible=!0);void 0===e.showControls&&(e.showControls=!0);void 0===e.showNavigation&&(e.showNavigation=!0);void 0===e.showRuler&&(e.showRuler=!0);void 0===e.showSequence&&(e.showSequence=!0);void 0===e.flanking&&(e.flanking=1e3);void 0===e.pairsSupported&&(e.pairsSupported=!0);void 0===e.type&&(e.type="IGV");e.tracks||(e.tracks=[]);e.showSequence&&e.tracks.push({type:"sequence",order:-Number.MAX_VALUE})}(o),c=1,(l=o).tracks&&l.tracks.forEach(function(e){void 0===e.order&&(e.order=c++)}),s=new t.Browser(o,e('<div class="igv-track-container-div">')[0]),e(r).append(s.$root),s.trackFileLoad=new t.TrackFileLoad,s.$root.append(s.trackFileLoad.$container),s.trackFileLoad.$container.hide(),x=s,!1!==(k=o).showCommandBar&&!1!==k.showControls&&(S=k.createControls?k.createControls(x,k):(h=x,u=k,p=e('<div id="igvControlDiv">'),u.showNavigation&&(g=e('<div class="igv-navbar">'),p.append(g),f=e('<div class="igv-logo">'),g.append(f),g.append(h.trackFileLoad.$presentationButton),!0===u.showLoadFileWidget?h.trackFileLoad.$presentationButton.show():h.trackFileLoad.$presentationButton.hide(),h.chromosomeSelectWidget=new t.ChromosomeSelectWidget(h,g),!0===u.showChromosomeWidget?h.chromosomeSelectWidget.$container.show():h.chromosomeSelectWidget.$container.hide(),m=e('<div class="igv-search-container">'),g.append(m),h.$searchInput=e('<input type="text" placeholder="Locus Search">'),m.append(h.$searchInput),h.$searchInput.change(function(t){h.search(e(this).val())}),v=e('<i class="fa fa-search">'),m.append(v),v.click(function(){h.search(h.$searchInput.val())}),h.$searchResults=e('<div class="igv-search-results">'),m.append(h.$searchResults.get(0)),h.$searchResultsTable=e("<table>"),h.$searchResults.append(h.$searchResultsTable.get(0)),h.$searchResults.hide(),h.windowSizePanel=new t.WindowSizePanel(g),w=g,(y=h).$zoomContainer=e('<div class="igv-zoom-widget">'),w.append(y.$zoomContainer),b=e('<i class="fa fa-minus-circle">'),y.$zoomContainer.append(b),b.on("click",function(){y.zoomOut()}),b=e('<i class="fa fa-plus-circle">'),y.$zoomContainer.append(b),b.on("click",function(){y.zoomIn()}),h.$cursorTrackingGuide=e('<div class="igv-cursor-tracking-guide">'),e(h.trackContainerDiv).append(h.$cursorTrackingGuide),!0===u.showCursorTrackingGuide?h.$cursorTrackingGuide.show():h.$cursorTrackingGuide.hide(),h.$cursorTrackingGuideToggle=t.makeToggleButton("cursor guide","cursor guide","showCursorTrackingGuide",function(){return h.$cursorTrackingGuide},void 0),g.append(h.$cursorTrackingGuideToggle),h.centerGuide=new t.CenterGuide(e(h.trackContainerDiv),u),g.append(h.centerGuide.$centerGuideToggle),h.$trackLabelToggle=t.makeToggleButton("track labels","track labels","trackLabelsVisible",function(){return e(h.trackContainerDiv).find(".igv-track-label")},void 0),g.append(h.$trackLabelToggle)),void 0===(d=e("#igvKaryoDiv")).get(0)&&(d=e('<div id="igvKaryoDiv" class="igv-karyo-div">'),p.append(d)),h.karyoPanel=new t.KaryoPanel(d,u),g.append(h.karyoPanel.$karyoPanelToggle),!1===u.showKaryo&&(h.karyoPanel.$karyoPanelToggle.hide(),d.hide()),p.get(0)),x.$root.append(e(S))),s.$content=e('<div class="igv-content-div">'),s.$root.append(s.$content),a=e('<div id="igv-content-header">'),s.$content.append(a),s.$content.append(s.trackContainerDiv),s.userFeedback=new t.UserFeedback(s.$content),s.userFeedback.hide(),t.popover=new t.Popover(s.$content),t.alert=new t.AlertDialog(s.$content,"igv-alert"),t.alert.hide(),t.dialog=new t.Dialog(s.$root,t.Dialog.dialogConstructor),t.dialog.hide(),t.dataRangeDialog=new t.DataRangeDialog(s.$root),t.dataRangeDialog.hide(),o.showNavigation||a.append(e('<div class="igv-logo-nonav">')),o.apiKey&&t.setApiKey(o.apiKey),o.oauthToken&&t.setOauthToken(o.oauthToken),t.Genome.getKnownGenomes().then(function(e){return function(){var e=n(window.location.href);{if(e.hasOwnProperty("igvSessionXML")){var i=decodeURIComponent(e.igvSessionXML);return t.xhr.loadString(i).then(function(e){return new t.XMLSession(e)})}return Promise.resolve(void 0)}}()}).then(function(e){e&&(void 0===(o=Object.assign(o,e)).tracks&&(o.tracks=[]),o.tracks.push({type:"sequence",order:-Number.MAX_VALUE})),function(e){e.genome?e.reference=n(e.genome):e.fastaURL?e.reference={fastaURL:e.fastaURL,cytobandURL:e.cytobandURL}:e.reference&&void 0!==e.reference.id&&void 0===e.reference.fastaURL&&(e.reference=n(e.reference.id));if(!e.reference||!e.reference.fastaURL)throw t.presentAlert("Fatal error:  reference must be defined",void 0),new Error("Fatal error:  reference must be defined");function n(e){var n=t.Genome.KnownGenomes[e];return n||t.presentAlert("Uknown genome id: "+e,void 0),n}}(o);var i,r=(i=n(window.location.href).locus)?decodeURIComponent(i):void 0;return r&&(o.locus=r),o}).then(function(e){return t.loadGenome(e.reference)}).then(function(e){return t.browser.genome=e,t.browser.genome.id=o.reference.id,!0===o.encodeEnabled&&t.browser.encodeTable.loadData(o.reference.id,void 0,void 0,void 0),t.browser.chromosomeSelectWidget.update(t.browser.genome),C=t.browser.viewportContainerWidth(),t.browser.getGenomicStateList(function(e){var n=[];e.locus?Array.isArray(e.locus)?n=e.locus:n.push(e.locus):t.browser.genome.hasOwnProperty("all")?n.push("all"):n.push(t.browser.genome.chromosomeNames[0]);return n}(o),C)}).then(function(e){var n;e.length>0?(t.browser.genomicStateList=e.map(function(n,i){return n.locusIndex=i,n.locusCount=e.length,n.referenceFrame=new t.ReferenceFrame(n.chromosome.name,n.start,(n.end-n.start)/(C/n.locusCount)),n}),t.browser.updateLocusSearchWidget(i.first(t.browser.genomicStateList)),t.browser.zoomWidgetLayout(),t.browser.toggleCenterGuide(t.browser.genomicStateList),t.browser.karyoPanel&&t.browser.karyoPanel.resize(),!0===o.showIdeogram&&(t.browser.ideoPanel=new t.IdeoPanel(a),t.browser.ideoPanel.repaint()),o.showRuler&&(t.browser.rulerTrack=new t.RulerTrack,t.browser.addTrack(t.browser.rulerTrack)),o.roi&&(t.browser.roi=[],o.roi.forEach(function(e){t.browser.roi.push(new t.ROI(e))})),o.tracks&&t.browser.loadTracksWithConfigList(o.tracks),t.browser.windowSizePanel.updateWithGenomicState(i.first(t.browser.genomicStateList))):(n="Unrecognized locus "+o.locus,t.presentAlert(n,void 0))}).catch(function(e){t.presentAlert(e,void 0),console.log(e)}),s},t.setApiKey=function(e){t.oauth.google.apiKey=e},t.setGoogleApiKey=function(e){t.oauth.google.apiKey=e},t.setOauthToken=function(e){t.oauth.google.access_token=e},t.setGoogleOauthToken=function(e){t.oauth.google.access_token=e},t.removeBrowser=function(){t.browser.$root.remove(),e(".igv-grid-container-dialog").remove()},t}((Ae=function(t){function n(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}t.createColorSwatchSelector=function(e,n){var i;i=[];for(var r=1;r>=.5;r-=.1)for(var o,a=0;a<1;a+=1/28)o="rgb("+t.Color.hsvToRgb(a,1,r).join(",")+")",i.push(o);i.pop(),i.push(t.Color.rgbColor(16,16,16)),i.forEach(function(i){var r;r=t.colorSwatch(i),e.append(r),r.click(function(){n(i)})})},t.colorSwatch=function(t){var n,i;return n=e("<div>",{class:"igv-color-swatch"}),i=e("<i>",{class:"fa fa-square fa-lg","aria-hidden":"true"}),n.append(i),i.css({color:t}),n},t.Color={rgbToHex:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(null!==t)return"rgb("+parseInt(t[1],16)+","+parseInt(t[2],16)+","+parseInt(t[3],16)+")"},hsvToRgb:function(e,t,n){var i,r,o,a=Math.floor(6*e),s=6*e-a,l=n*(1-t),c=n*(1-s*t),h=n*(1-(1-s)*t);switch(a%6){case 0:i=n,r=h,o=l;break;case 1:i=c,r=n,o=l;break;case 2:i=l,r=n,o=h;break;case 3:i=l,r=c,o=n;break;case 4:i=h,r=l,o=n;break;case 5:i=n,r=l,o=c}return[Math.floor(255*i),Math.floor(255*r),Math.floor(255*o)]},hslToRgb:function(e,t,i){var r,o,a;if(0===t)r=o=a=i;else{var s=i<.5?i*(1+t):i+t-i*t,l=2*i-s;r=n(l,s,e+1/3),o=n(l,s,e),a=n(l,s,e-1/3)}return[255*r,255*o,255*a]},rgbaColor:function(e,n,i,r){return"rgba("+(e=t.Math.clamp(e,0,255))+","+(n=t.Math.clamp(n,0,255))+","+(i=t.Math.clamp(i,0,255))+","+(r=t.Math.clamp(r,0,1))+")"},rgbColor:function(e,n,i){return"rgb("+(e=t.Math.clamp(e,0,255))+","+(n=t.Math.clamp(n,0,255))+","+(i=t.Math.clamp(i,0,255))+")"},greyScale:function(e){var n=t.Math.clamp(e,0,255);return"rgb("+n+","+n+","+n+")"},randomGrey:function(e,n){e=t.Math.clamp(e,0,255),n=t.Math.clamp(n,0,255);var i=Math.round(t.random(e,n)).toString(10);return"rgb("+i+","+i+","+i+")"},randomRGB:function(e,n){return e=t.Math.clamp(e,0,255),n=t.Math.clamp(n,0,255),"rgb("+Math.round(t.random(e,n)).toString(10)+","+Math.round(t.random(e,n)).toString(10)+","+Math.round(t.random(e,n)).toString(10)+")"},randomRGBConstantAlpha:function(e,n,i){return e=t.Math.clamp(e,0,255),n=t.Math.clamp(n,0,255),"rgba("+Math.round(t.random(e,n)).toString(10)+","+Math.round(t.random(e,n)).toString(10)+","+Math.round(t.random(e,n)).toString(10)+","+i+")"},addAlpha:function(e,n){var i=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e);return e.startsWith("rgba")?e:(i&&(e=t.Color.hexToRgb(e)),e.startsWith("rgb")?e.replace("rgb","rgba").replace(")",", "+n+")"):(console.log(e+" is not an rgb style string"),e))},getCompositeColor:function(e,t,n){return"rgb("+Math.floor(n*t[0]+(1-n)*e[0])+","+Math.floor(n*t[1]+(1-n)*e[1])+","+Math.floor(n*t[2]+(1-n)*e[2])+")"},createColorString:function(e){return e.includes(",")?e.startsWith("rgb")?e:"rgb("+e+")":void 0}},t.nucleotideColorComponents={A:[0,200,0],C:[0,0,200],T:[255,0,0],G:[209,113,5],a:[0,200,0],c:[0,0,200],t:[255,0,0],g:[209,113,5]},t.nucleotideColors={A:"rgb(  0, 200,   0)",C:"rgb(  0,   0, 200)",T:"rgb(255,   0,   0)",G:"rgb(209, 113,   5)",a:"rgb(  0, 200,   0)",c:"rgb(  0,   0, 200)",t:"rgb(255,   0,   0)",g:"rgb(209, 113,   5)"},t.BinnedColorScale=function(e){this.thresholds=e.thresholds,this.colors=e.colors},t.BinnedColorScale.prototype.getColor=function(e){var t,n=this.thresholds.length;for(t=0;t<n;t++)if(e<this.thresholds[t])return this.colors[t];return this.colors[this.colors.length-1]},t.GradientColorScale=function(e){this.scale=e,this.lowColor="rgb("+e.lowR+","+e.lowG+","+e.lowB+")",this.highColor="rgb("+e.highR+","+e.highG+","+e.highB+")",this.diff=e.high-e.low},t.GradientColorScale.prototype.getColor=function(e){var t,n=this.scale;return e<=n.low?this.lowColor:e>=n.high?this.highColor:(t=(e-n.low)/this.diff,"rgb("+Math.floor(n.lowR+t*(n.highR-n.lowR))+","+Math.floor(n.lowG+t*(n.highG-n.lowG))+","+Math.floor(n.lowB+t*(n.highB-n.lowB))+")")};var i={Set1:["rgb(228,26,28)","rgb(55,126,184)","rgb(77,175,74)","rgb(166,86,40)","rgb(152,78,163)","rgb(255,127,0)","rgb(247,129,191)","rgb(153,153,153)","rgb(255,255,51)"],Dark2:["rgb(27,158,119)","rgb(217,95,2)","rgb(117,112,179)","rgb(231,41,138)","rgb(102,166,30)","rgb(230,171,2)","rgb(166,118,29)","rgb(102,102,102)"],Set2:["rgb(102, 194,165)","rgb(252,141,98)","rgb(141,160,203)","rgb(231,138,195)","rgb(166,216,84)","rgb(255,217,47)","rgb(229,196,148)","rgb(179,179,179)"],Set3:["rgb(141,211,199)","rgb(255,255,179)","rgb(190,186,218)","rgb(251,128,114)","rgb(128,177,211)","rgb(253,180,98)","rgb(179,222,105)","rgb(252,205,229)","rgb(217,217,217)","rgb(188,128,189)","rgb(204,235,197)","rgb(255,237,111)"],Pastel1:["rgb(251,180,174)","rgb(179,205,227)","rgb(204,235,197)","rgb(222,203,228)","rgb(254,217,166)","rgb(255,255,204)","rgb(229,216,189)","rgb(253,218,236)"],Pastel2:["rgb(173,226,207)","rgb(253,205,172)","rgb(203,213,232)","rgb(244,202,228)","rgb(230,245,201)","rgb(255,242,174)","rgb(243,225,206)"],Accent:["rgb(127,201,127)","rgb(190,174,212)","rgb(253,192,134)","rgb(255,255,153)","rgb(56,108,176)","rgb(240,2,127)","rgb(191,91,23)"]};return t.PaletteColorTable=function(e){this.colors=i[e],Array.isArray(this.colors)||(this.colors=[]),this.colorTable={},this.nextIdx=0,this.colorGenerator=new RColor},t.PaletteColorTable.prototype.getColor=function(e){return this.colorTable.hasOwnProperty(e)||(this.nextIdx<this.colors.length?this.colorTable[e]=this.colors[this.nextIdx]:this.colorTable[e]=this.colorGenerator.get(),this.nextIdx++),this.colorTable[e]},RColor=function(){this.hue=Math.random(),this.goldenRatio=.618033988749895,this.hexwidth=2},RColor.prototype.hsvToRgb=function(e,t,n){var i=Math.floor(6*e),r=6*e-i,o=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),l=255,c=255,h=255;switch(i){case 0:l=n,c=s,h=o;break;case 1:l=a,c=n,h=o;break;case 2:l=o,c=n,h=s;break;case 3:l=o,c=a,h=n;break;case 4:l=s,c=o,h=n;break;case 5:l=n,c=o,h=a}return[Math.floor(256*l),Math.floor(256*c),Math.floor(256*h)]},RColor.prototype.padHex=function(e){return e.length>this.hexwidth?e:new Array(this.hexwidth-e.length+1).join("0")+e},RColor.prototype.get=function(e,t){this.hue+=this.goldenRatio,this.hue%=1,"number"!=typeof e&&(e=.5),"number"!=typeof t&&(t=.95);var n=this.hsvToRgb(this.hue,e,t);return"#"+this.padHex(n[0].toString(16))+this.padHex(n[1].toString(16))+this.padHex(n[2].toString(16))},t}((Ae=function(e){function t(e,t,n){var i,r=t.length;for(i=0;i<r;i++)t[i]=Math.round(t[i]),n[i]=Math.round(n[i]);for(e.beginPath(),e.moveTo(t[0],n[0]),i=1;i<r;i++)e.lineTo(t[i],n[i]);e.closePath()}return e.graphics={setProperties:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e[n]=i}},strokeLine:function(t,n,i,r,o,a){n=Math.floor(n)+.5,i=Math.floor(i)+.5,r=Math.floor(r)+.5,o=Math.floor(o)+.5,t.save(),a&&e.graphics.setProperties(t,a),t.beginPath(),t.moveTo(n,i),t.lineTo(r,o),t.stroke(),t.restore()},fillRect:function(t,n,i,r,o,a){n=Math.round(n),i=Math.round(i),a&&(t.save(),e.graphics.setProperties(t,a)),t.fillRect(n,i,r,o),a&&t.restore()},fillPolygon:function(n,i,r,o){n.save(),o&&e.graphics.setProperties(n,o),t(n,i,r),n.fill(),n.restore()},strokePolygon:function(n,i,r,o){n.save(),o&&e.graphics.setProperties(n,o),t(n,i,r),n.stroke(),n.restore()},fillText:function(t,n,i,r,o,a){if(o&&(t.save(),e.graphics.setProperties(t,o)),t.save(),t.translate(i,r),a)for(var s in a){var l=a[s];"translate"==s&&t.translate(l.x,l.y),"rotate"==s&&t.rotate(l.angle*Math.PI/180)}t.fillText(n,0,0),t.restore(),o&&t.restore()},strokeText:function(t,n,i,r,o,a){if(t.save(),o&&e.graphics.setProperties(t,o),t.translate(i,r),a)for(var s in a){var l=a[s];"translate"==s&&t.translate(l.x,l.y),"rotate"==s&&t.rotate(l.angle*Math.PI/180)}t.strokeText(n,0,0),t.restore()},strokeCircle:function(e,t,n,i){e.beginPath(),e.arc(t,n,i,0,2*Math.PI),e.stroke()},fillCircle:function(e,t,n,i){e.beginPath(),e.arc(t,n,i,0,2*Math.PI),e.fill()},drawArrowhead:function(e,t,n,i,r){e.save(),i||(i=5),r&&(e.lineWidth=r),e.beginPath(),e.moveTo(t,n-i/2),e.lineTo(t,n+i/2),e.lineTo(t+i,n),e.lineTo(t,n-i/2),e.closePath(),e.fill(),e.restore()},dashedLine:function(t,n,i,r,o,a,s){t.save(),n=Math.round(n),i=Math.round(i),r=Math.round(r),o=Math.round(o),a=Math.round(a),s&&e.graphics.setProperties(t,s),null==a&&(a=2),t.moveTo(n,i);for(var l=r-n,c=o-i,h=Math.floor(Math.sqrt(l*l+c*c)/a),u=l/h,f=c/h,p=0;p++<h;)n+=u,i+=f,t[p%2==0?"moveTo":"lineTo"](n,i);t[p%2==0?"moveTo":"lineTo"](r,o),t.restore()}},e}((Ae=((_e=Ae||{}).IdeoPanel=function(t){t.append(e('<div class="igv-ideogram-left-shim"></div>')),this.buildPanels(t)},_e.IdeoPanel.setWidth=function(e,t){var n;e.width(t),n=e.width()/e.outerWidth(),e.width(Math.floor(n*t))},_e.IdeoPanel.prototype.buildPanels=function(t){this.panels=i.map(_e.browser.genomicStateList,function(n){var i,r,o,a=_e.browser.viewportContainerWidth(),s={};return s.genomicState=n,s.$ideogram=e('<div class="igv-ideogram-content-div"></div>'),i=s.$ideogram,r=n.locusIndex,1!==(o=n.locusCount)&&r!==o-1&&i.addClass("igv-ideogram-content-div-border-right"),_e.IdeoPanel.setWidth(s.$ideogram,a/n.locusCount),t.append(s.$ideogram),s.$canvas=e("<canvas>"),s.$ideogram.append(s.$canvas),s.$canvas.attr("width",s.$ideogram.width()),s.$canvas.attr("height",s.$ideogram.height()),s.ctx=s.$canvas.get(0).getContext("2d"),s.ideograms={},s.$ideogram.on("click",function(e){_e.IdeoPanel.clickHandler(s,e)}),s})},_e.IdeoPanel.$empty=function(e){e.find(".igv-ideogram-content-div").remove()},_e.IdeoPanel.prototype.panelWithLocusIndex=function(e){var t=i.filter(this.panels,function(t){return e===t.genomicState.locusIndex});return i.first(t)},_e.IdeoPanel.prototype.resize=function(){var e=_e.browser.syntheticViewportContainerWidth();i.each(this.panels,function(t,n){var i=_e.browser.genomicStateList[n];t.$ideogram.width(Math.floor(e/i.locusCount)),t.$canvas.attr("width",t.$ideogram.width()),t.ideograms={}}),this.repaint()},_e.IdeoPanel.prototype.repaint=function(){i.each(this.panels,function(e){_e.IdeoPanel.repaintPanel(e)})},_e.IdeoPanel.repaintPanel=function(e){try{var t,n,i,r,o,a,s,l,c,h,u,f,p,d,g,m;if(u=e.genomicState.referenceFrame,!(_e.browser.genome&&u&&_e.browser.genome.getChromosome(u.chrName)))return;if(f=[],o=e.$canvas.width(),a=e.$canvas.height(),e.ctx.clearRect(0,0,o,a),"all"===u.chrName.toLowerCase())return;void 0===(t=e.ideograms[u.chrName])&&((t=document.createElement("canvas")).width=o,t.height=a,function(e,t,n){if(_e.browser.genome){var i=_e.browser.genome.getCytobands(u.chrName);if(i){var r=0+n/2,o=[],a=[],s=i.length;if(0==s)return;for(var l=i[s-1].end,c=t/l,h=-1,p=0;p<i.length;p++){var d=i[p],g=c*d.start,m=c*d.end;m>h&&("c"==d.type?("p"==d.name.charAt(0)?(o[0]=g,a[0]=n+0,o[1]=g,a[1]=0,o[2]=m,a[2]=r):(o[0]=m,a[0]=n+0,o[1]=m,a[1]=0,o[2]=g,a[2]=r),e.fillStyle="rgb(150, 0, 0)",e.strokeStyle="rgb(150, 0, 0)",e.polygon(o,a,1,0)):(e.fillStyle=v(f,d),e.fillRect(g,1,m-g,n-2)))}}e.strokeStyle="black",e.roundRect(1,1,t-2,n-2,(n-2)/2,0,1),h=m}}(t.getContext("2d"),t.width,t.height),e.ideograms[u.chrName]=t),e.ctx.drawImage(t,0,0),n=_e.browser.genome.getChromosome(u.chrName),l=Math.round(u.bpPerPixel*e.$ideogram.width()),h=u.start,l<n.bpLength&&(i=l/n.bpLength,r=h/n.bpLength,c=Math.floor(r*e.$canvas.width()),s=Math.floor(i*e.$canvas.width()),c=Math.max(0,c),c=Math.min(o-s,c),e.ctx.save(),e.ctx.strokeStyle="red",e.ctx.lineWidth=s<2?1:2,p=c+e.ctx.lineWidth/2,g=s<2?1:s-e.ctx.lineWidth,d=0+e.ctx.lineWidth/2,m=t.height-e.ctx.lineWidth,e.ctx.strokeRect(p,d,g,m),e.ctx.restore())}catch(e){console.log("Error painting ideogram: "+e.message)}function v(e,t){if("c"==t.type)return"rgb(150, 10, 10)";var n=t.stain,i=230;"p"==t.type&&(i=Math.floor(230-n/100*230));var r=e[i];return null==r&&(r="rgb("+i+","+i+","+i+")",e[i]=r),r}},_e.IdeoPanel.clickHandler=function(e,t){var n,i,r,o,a,s=e.genomicState,l=s.referenceFrame;(n=_e.translateMouseCoordinates(t,e.$ideogram.get(0)).x/e.$ideogram.width())-(r=l.bpPerPixel*e.$ideogram.width()/(i=_e.browser.genome.getChromosome(l.chrName)).bpLength)/2<0&&(n=r/2),n+r/2>1&&(n=1-r/2),o=Math.round((n-r/2)*i.bpLength),a=Math.round((n+r/2)*i.bpLength),l.start=Math.round((n-r/2)*i.bpLength),l.bpPerPixel=(a-o)/e.$ideogram.width(),_e.browser.updateLocusSearchWidget(s),_e.browser.repaintWithLocusIndex(e.genomicState.locusIndex)},_e))||{}))||{}))||{});CanvasRenderingContext2D.prototype.strokeLine=function(e,t,n,i,r){this.save(),this.beginPath(),r&&(this.lineWidth=r),this.moveTo(e,t),this.lineTo(n,i),this.stroke(),this.restore()},CanvasRenderingContext2D.prototype.drawArrowhead=function(e,t,n,i){this.save(),n||(n=5),i&&(this.lineWidth=i),this.beginPath(),this.moveTo(e,t-n/2),this.lineTo(e,t+n/2),this.lineTo(e+n,t),this.lineTo(e,t-n/2),this.closePath(),this.fill(),this.restore()},CanvasRenderingContext2D.prototype.roundRect=function(e,t,n,i,r,o,a){this.save(),void 0===a&&(a=!0),void 0===r&&(r=5),this.beginPath(),this.moveTo(e+r,t),this.lineTo(e+n-r,t),this.quadraticCurveTo(e+n,t,e+n,t+r),this.lineTo(e+n,t+i-r),this.quadraticCurveTo(e+n,t+i,e+n-r,t+i),this.lineTo(e+r,t+i),this.quadraticCurveTo(e,t+i,e,t+i-r),this.lineTo(e,t+r),this.quadraticCurveTo(e,t,e+r,t),this.closePath(),a&&this.stroke(),o&&this.fill(),this.restore()},CanvasRenderingContext2D.prototype.polygon=function(e,t,n,i){this.save(),void 0===i&&(i=!0),this.beginPath();var r=e.length;this.moveTo(e[0],t[0]);for(var o=1;o<r;o++)this.lineTo(e[o],t[o]);this.closePath(),i&&this.stroke(),n&&this.fill(),this.restore()},CanvasRenderingContext2D.prototype.eqTriangle=function(e,t,n){this.save();var i=e*(Math.sqrt(3)/2);this.beginPath(),this.moveTo(t,n-i/2),this.lineTo(t-e/2,n+i/2),this.lineTo(t+e/2,n+i/2),this.lineTo(t,n-i/2),this.closePath(),this.stroke(),this.fill(),this.restore()},void 0===String.prototype.startsWith&&(String.prototype.startsWith=function(e){return!(this.length<e.length)&&this.substr(0,e.length)==e}),void 0===String.prototype.endsWith&&(String.prototype.endsWith=function(e){return!(this.length<e.length)&&this.substr(this.length-e.length,e.length)==e}),void 0===String.prototype.includes&&(String.prototype.includes=function(e){return-1!=this.indexOf(e)}),void 0===String.prototype.splitLines&&Object.defineProperty(String.prototype,"splitLines",{value:function(){return this.split(/\r\n|\n|\r/gm)},enumerable:!1,configurable:!1}),void 0===Uint8Array.prototype.toText&&(Uint8Array.prototype.toText=function(){var e,t,n;for(n="",e=0,t=this.byteLength;e<t;e++)n+=String.fromCharCode(this[e]);return n});var Ie=Math.log(2);void 0===Math.log2&&(Math.log2=function(e){return Math.log(e)/Ie}),void 0===Function.prototype.bind&&(Function.prototype.bind=function(){var e=this,t=Array.prototype.slice.call(arguments),n=t.shift();return function(){return e.apply(n,t.concat(Array.prototype.slice.call(arguments)))}}),Date.now||(Date.now=function(){return(new Date).getTime()}),Object.keys||(Object.keys=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(r){if("object"!=typeof r&&("function"!=typeof r||null===r))throw new TypeError("Object.keys called on non-object");var o,a,s=[];for(o in r)e.call(r,o)&&s.push(o);if(t)for(a=0;a<i;a++)e.call(r,n[a])&&s.push(n[a]);return s}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var Re,Pe,Ee,Le,Me,De,Fe,Be,Ne,Oe;Ae=function(e){var t=2,n={};function i(e){var t=e.right;e.right=t.left,t.left!=n&&(t.left.parent=e),t.parent=e.parent,e.parent==n?this.root=t:e.parent.left==e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,o.call(this,e)}function r(e){var t=e.left;e.left=t.right,t.right!=n&&(t.right.parent=e),t.parent=e.parent,e.parent==n?this.root=t:e.parent.right==e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,o.call(this,e)}function o(e){for(;e!=n;){var t=e.left.max>e.right.max?e.left.max:e.right.max,i=e.interval.high;e.max=t>i?t:i;var r=e.left.min<e.right.min?e.left.min:e.right.min,o=e.interval.low;e.min=r<o?r:o,e=e.parent}}function a(e,t,n){this.low=e,this.high=t,this.value=n}return n.color=1,n.parent=n,n.left=n,n.right=n,e.IntervalTree=function(){this.root=n},e.IntervalTree.prototype.insert=function(e,o,s){var l=new function(e){this.parent=n,this.left=n,this.right=n,this.interval=e,this.color=t}(new a(e,o,s));for(this.treeInsert(l),l.color=t;l!=this.root&&l.parent.color==t;){var c;if(l.parent==l.parent.parent.left)(c=l.parent.parent.right).color==t?(l.parent.color=1,c.color=1,l.parent.parent.color=t,l=l.parent.parent):(l==l.parent.right&&(l=l.parent,i.call(this,l)),l.parent.color=1,l.parent.parent.color=t,r.call(this,l.parent.parent));else(c=l.parent.parent.left).color==t?(l.parent.color=1,c.color=1,l.parent.parent.color=t,l=l.parent.parent):(l==l.parent.left&&(l=l.parent,r.call(this,l)),l.parent.color=1,l.parent.parent.color=t,i.call(this,l.parent.parent))}this.root.color=1},e.IntervalTree.prototype.findOverlapping=function(e,t){var i=new a(e,t,0);if(this.root===n)return[];var r=function e(t,i,r){i.interval.overlaps(t)&&r.push(i.interval);i.left!=n&&i.left.max>=t.low&&e.call(this,t,i.left,r);i.right!=n&&i.right.min<=t.high&&e.call(this,t,i.right,r);return r}.call(this,i,this.root,[]);return r.length>1&&r.sort(function(e,t){return e.low-t.low}),r},e.IntervalTree.prototype.logIntervals=function(){!function e(t,i){var r="";for(var o=0;o<i;o++)r+=" ";console.log(r+t.interval.low+" "+t.interval.high);i+=5;t.left!=n&&e(t.left,i);t.right!=n&&e(t.right,i)}(this.root,0)},e.IntervalTree.prototype.mapIntervals=function(e){!function t(i){e(i.interval);i.left!=n&&t(i.left);i.right!=n&&t(i.right)}(this.root)},e.IntervalTree.prototype.treeInsert=function(e){for(var t=this.root,i=n;t!=n;)i=t,t=e.interval.low<=t.interval.low?t.left:t.right;e.parent=i,i==n?(this.root=e,e.left=e.right=n):e.interval.low<=i.interval.low?i.left=e:i.right=e,o.call(this,e)},a.prototype.equals=function(e){return!!e&&(this==e||this.low==otherInterval.low&&this.high==otherInterval.high)},a.prototype.compareTo=function(e){return this.low<e.low?-1:this.low>e.low?1:this.high<e.high?-1:this.high>e.high?1:0},a.prototype.overlaps=function(t){try{return this.low<=t.high&&t.low<=this.high}catch(t){e.presentAlert(t,void 0)}},e}((Ae=function(e){var t=0,n=1,r=2;function a(t,i){var a;try{return a=i===n?new o.Gunzip(new Uint8Array(t)).decompress():i===r?new Uint8Array(e.unbgzf(t)):new Uint8Array(t),(new TextDecoder).decode(a)}catch(e){consloe.log(e)}}e.xhr={},e.xhr.load=function(t,n){var r;if(t=(r=t).includes("//www.dropbox.com")?r.replace("//www.dropbox.com","//dl.dropboxusercontent.com"):r.includes("//drive.google.com")?e.Google.driveDownloadURL(r):r,(n=n||{}).oauthToken){var o=i.isFunction(n.oauthToken)?n.oauthToken():n.oauthToken;return o.then&&i.isFunction(o.then)?o.then(a):a(o)}return s(t,n);function a(e){return e&&(n.token=e),s(t,n)}function s(t,n){return new Promise(function(i,r){var o,a,s,l,c,h=new XMLHttpRequest,u=n.sendData||n.body,f=n.method||(u?"POST":"GET"),p=n.range,d=n.responseType,g=n.contentType,m=n.mimeType,v=n.headers||{},y=(0==navigator.vendor.indexOf("Apple")&&/\sSafari\//.test(navigator.userAgent),navigator.userAgent.indexOf("Chrome")>-1),w=n.withCredentials;if(t=t.startsWith("gs://")?e.Google.translateGoogleCloudURL(t):t,n.token&&(v.Authorization="Bearer "+n.token),(c=t).includes("googleapis")&&!c.includes("urlshortener")?(t=e.Google.addApiKey(t),v=v||{},e.Google.addGoogleHeaders(v)):n.oauth&&function(t){t["Cache-Control"]="no-cache";var n=e.oauth.google.access_token;n||"undefined"==typeof oauth||(n=oauth.google.access_token);n&&!t.hasOwnProperty("Authorization")&&(t.Authorization="Bearer "+n)}(v),!p||!y||t.indexOf("X-Amz-Signature")>-1||(t+=t.includes("?")?"&":"?",t+="someRandomSeed="+Math.random().toString(36)),h.open(f,t),p){var b=p.size?p.start+p.size-1:"";h.setRequestHeader("Range","bytes="+p.start+"-"+b)}if(g&&h.setRequestHeader("Content-Type",g),m&&h.overrideMimeType(m),d&&(h.responseType=d),v)for(o=Object.keys(v),l=0;l<o.length;l++)s=v[a=o[l]],h.setRequestHeader(a,s);!0===w&&(h.withCredentials=!0),h.onload=function(e){0==h.status||h.status>=200&&h.status<=300?p&&206!=h.status?x("ERROR: range-byte header was ignored for url: "+t):i(h.response):416===h.status?x("Unsatisfiable range"):x(h.status)},h.onerror=function(r){var o,a;o=t,a=window.location.origin,!o.startsWith(a)&&!n.crossDomainRetried&&e.browser&&e.browser.crossDomainProxy&&t!=e.browser.crossDomainProxy?(n.sendData="url="+t,n.crossDomainRetried=!0,e.xhr.load(e.browser.crossDomainProxy,n).then(i)):x("Error accessing resource: "+t+" Status: "+h.status)},h.ontimeout=function(e){x("Timed out")},h.onabort=function(e){console.log("Aborted"),r(e)};try{h.send(u)}catch(e){r(e)}function x(e){if(!r)throw new Error(e);r(new Error(e))}})}},e.xhr.loadArrayBuffer=function(t,n){return n=n||{},t instanceof File?(i=t,r=n,new Promise(function(e,t){var n,o,a;(n=new FileReader).onload=function(t){r.bgz||i.name.endsWith(".gz"),e(n.result)},n.onerror=function(e){console.log("reject uploading local file "+i.name),t(null,n)},r.range?(a=r.range.start+r.range.size-1,o=i.slice(r.range.start,a+1),n.readAsArrayBuffer(o)):n.readAsArrayBuffer(i)})):(n.responseType="arraybuffer",e.xhr.load(t,n));var i,r},e.xhr.loadJson=function(t,n){return"POST"==((n=n||{}).method||(n.sendData?"POST":"GET"))&&(n.contentType="application/json"),new Promise(function(i,r){e.xhr.load(t,n).then(function(e){i(e?JSON.parse(e):e)}).catch(r)})},e.xhr.loadString=function(i,o){return o=o||{},i instanceof File?(s=i,l=o,new Promise(function(e,i){var o=new FileReader;o.onload=function(i){var c,h;c=l.bgz?r:s.name.endsWith(".gz")?n:t,h=a(o.result,c),e(h)},o.onerror=function(e){console.log("reject uploading local file "+s.name),i(null,o)},o.readAsArrayBuffer(s)})):function(i,o){var s,l,c;void 0===o&&(o={});c=i.indexOf("?"),l=c>0?i.substring(0,c):i,s=o.bgz?r:l.endsWith(".gz")?n:t;return s===t?(o.mimeType="text/plain; charset=x-user-defined",e.xhr.load(i,o)):(o.responseType="arraybuffer",e.xhr.load(i,o).then(function(e){return a(e,s)}))}(i,o);var s,l};var s=window.document.location.href;if(!s.includes("localhost")&&!s.includes("127.0.0.1")){e.xhr.load("https://data.broadinstitute.org/igv/projects/current/counter_igvjs.php?version=0").then(function(e){console.log(e)}).catch(function(e){console.log(e)})}return e}((Ae=function(t){var n=this;t.genericContainer=function(t,n,i){var r,o,a;return r=e("<div>",{class:"igv-generic-container"}),t.append(r),n&&n.width&&r.width(n.width),n&&n.height&&r.height(n.height),n&&n.classes&&r.addClass(n.classes.join(" ")),o=e("<div>"),r.append(o),a=e("<i>",{class:"fa fa-times"}),o.append(a),a.on("click",function(e){i()}),r},t.makeDraggable=function(e,t){t.on("mousedown",function(i){i.preventDefault(),i.stopPropagation(),n.initX=e.position().left,n.initY=e.position().top,n.mousePressX=i.clientX,n.mousePressY=i.clientY,t.on("mousemove",function(t){t.preventDefault(),t.stopPropagation(),e.css({left:n.initX+t.clientX-n.mousePressX,top:n.initY+t.clientY-n.mousePressY})}),window.addEventListener("mouseup",function(){t.off("mousemove")},!1)})},t.getExtension=function(e){var n,i;if(void 0!==e.url)return(i=(n=(t.isFilePath(e.url)?e.url.name:e.url).toLowerCase()).indexOf("?"))>0&&(n=n.substr(0,i)),n.endsWith(".gz")?n=n.substr(0,n.length-3):(n.endsWith(".txt")||n.endsWith(".tab"))&&(n=n.substr(0,n.length-4)),(i=n.lastIndexOf("."))<0?n:n.substr(1+i)},t.filenameOrURLHasSuffix=function(e,t){return(e instanceof File?e.name:e).toLowerCase().endsWith(t)},t.isFilePath=function(e){return e instanceof File},t.makeToggleButton=function(n,i,r,o,a){var s=e('<div class="igv-nav-bar-toggle-button">');function l(e,t,n,i){e.removeClass("igv-nav-bar-toggle-button-on"),e.removeClass("igv-nav-bar-toggle-button-off"),!0===t?(e.addClass("igv-nav-bar-toggle-button-off"),e.text(i),a&&a()):(e.addClass("igv-nav-bar-toggle-button-on"),e.text(n))}return l(s,!0===t.browser.config[r],n,i),s.click(function(){var a=o();t.browser.config[r]=!t.browser.config[r],a.toggle(),l(e(this),a.is(":visible"),n,i)}),s},t.presentAlert=function(e,n){var r;console.error(e),r=e.message||e,i.hasOwnProperty(r)&&(r=i[r]),t.alert.$dialogLabel.text(r),t.alert.show(n),t.popover.hide()};var i={401:"Access unauthorized",403:"Access forbidden",404:"Not found"};return t.attachDialogCloseHandlerWithParent=function(t,n){var i=e("<div>"),r=e('<i class="fa fa-times">');i.append(r),t.append(i),r.hover(function(){r.removeClass("fa-times"),r.addClass("fa-times-circle"),r.css({color:"#222"})},function(){r.removeClass("fa-times-circle"),r.addClass("fa-times"),r.css({color:"#444"})}),r.click(n)},t.spinner=function(t){var n,i;return i=e('<i class="fa fa-spinner fa-spin">'),t&&i.css("font-size",t),(n=e('<div class="igv-spinner-container">')).append(i[0]),n[0]},t.getSpinnerObjectWithParentElement=function(t){return e(t).find("div.igv-spinner-container")},t.startSpinnerAtParentElement=function(e){var n=t.getSpinnerObjectWithParentElement(e);n&&n.show()},t.stopSpinnerAtParentElement=function(e){var n=t.getSpinnerObjectWithParentElement(e);n&&n.hide()},t.parseUri=function(e){for(var n=t.parseUri.options,i=n.parser[n.strictMode?"strict":"loose"].exec(e),r={},o=14;o--;)r[n.key[o]]=i[o]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,function(e,t,i){t&&(r[n.q.name][t]=i)}),r},t.parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},t.domElementRectAsString=function(e){return" x "+e.clientLeft+" y "+e.clientTop+" w "+e.clientWidth+" h "+e.clientHeight},t.isNumber=function(e){return""!==e&&(void 0!==e&&(!isNaN(parseFloat(e))&&isFinite(e)))},t.guid=function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)},t.random=function(e,t){return Math.random()*(t-e)+e},t.prettyBasePairNumber=function(e){var n,i,r;return e>1e7?(n=" mb",i=e/1e6,(r=Math.floor(i)).toString()+n):e>1e4?(n=" kb",i=e/1e3,r=Math.floor(i),t.numberFormatter(r)+n):t.numberFormatter(e)+" bp"},t.numberFormatter=function(e){var t=String(e).split(/[.,]/);return t[0].split("").reverse().reduce(function(e,t,n){return n%3==0?e+","+t:e+t}).split("").reverse().join("")+(t[1]?"."+t[1]:"")},t.numberUnFormatter=function(e){return e.split(",").join().replace(",","","g")},t.translateMouseCoordinates=function(t,n){var i,r=e(n);return i=e.event.fix(t),void 0===r.offset()&&console.log("igv.translateMouseCoordinates - $target.offset() is undefined."),{x:i.pageX-r.offset().left,y:i.pageY-r.offset().top}},t.formatPopoverText=function(e){var t='<table class="igv-popover-table">';return e.forEach(function(e){e.name?t+='<tr><td class="igv-popover-td"><div class="igv-popover-name-value"><span class="igv-popover-name">'+e.name+'</span><span class="igv-popover-value">'+e.value+"</span></div></td></tr>":t+="<tr><td>"+e.toString()+"</td></tr>"}),t+="</table>"},t.throttle=function(e,t,n){var i,r;return t||(t=200),function(){var o=n||this,a=+new Date,s=arguments;i&&a<i+t?(clearTimeout(r),r=setTimeout(function(){i=a,e.apply(o,s)},t)):(i=a,e.apply(o,s))}},t.splitStringRespectingQuotes=function(e,t){var n,i,r=[],o=e.length,a=0,s=!1;if(o>0)for(r[a]=e.charAt(0),n=1;n<o;n++)'"'===(i=e.charAt(n))?s=!s:s||i!==t?r[a]+=i:r[++a]="";return r},t.addAjaxExtensions=function(){e.ajaxTransport("+binary",function(e,t,n){return{send:function(t,n){var i=new XMLHttpRequest,r=e.url,o=e.type;e.data;if(i.addEventListener("load",function(){var t={};t[e.dataType]=i.response,n(i.status,i.statusText,t,i.getAllResponseHeaders())}),i.open(o,r),i.responseType="arraybuffer",e.headers)for(var a in e.headers)e.headers.hasOwnProperty(a)&&i.setRequestHeader(a,e.headers[a])},abort:function(){n.abort()}}})},t.isStringOrNumber=function(e){return!(!e.substring&&!e.toFixed)},t.constrainBBox=function(e,t){var n,i,r={},o={};return o.left=o.top=0,o.right=t.outerWidth(),o.bottom=t.outerHeight(),i=e.offset(),r.left=i.left-t.offset().left,r.top=i.top-t.offset().top,r.right=r.left+e.outerWidth(),r.bottom=r.top+e.outerHeight(),(n=r.bottom-o.bottom)>0&&(i.top-=n,r.top-=n,r.bottom-=n,(n=r.top-o.top)<0&&(i.top-=n)),i},t.log=function(e){t.enableLogging&&console&&console.log&&console.log(e)},t.buildOptions=function(e,t){var n={oauthToken:e.oauthToken,headers:e.headers,withCredentials:e.withCredentials};return Object.assign(n,t)},t}((Ae=function(e){function t(){this.content=[]}return e.Math={mean:function(e){var t,n=0,i=0;for(t=0;t<e.length;t++)isNaN(e[t])||(n+=e[t],i++);return i>0?n/i:0},meanAndStdev:function(e){var t,n,i=0,r=0,o=0;for(n=0;n<e.length;n++)t=e[n],isNaN(t)||(i+=t,r+=t*t,o++);return o>0?{mean:i/o,stdev:Math.sqrt(r-i*i/o)}:{mean:0,stdev:0}},percentile:function(e,n){if(0!==e.length){var i=Math.floor(e.length*((100-n)/100));return 0===i?(e.sort(function(e,t){return t-e}),e[i]):function(e,n){var i,r=new t;for(i=0;i<e.length;i++){var o=e[i];if(r.content.length<n||o>r.content[0]){if(r.content.length===n)r.pop();r.push(o)}}return r.content[0]}(e,i)}},clamp:function(e,t,n){return Math.min(Math.max(e,t),n)}},t.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),e},remove:function(e){for(var t=this.content.length,n=0;n<t;n++)if(this.content[n]==e){var i=this.content.pop();if(n==t-1)break;this.content[n]=i,this.bubbleUp(n),this.sinkDown(n);break}},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e],n=t;e>0;){var i=Math.floor((e+1)/2)-1,r=this.content[i];if(n>=r)break;this.content[i]=t,this.content[e]=r,e=i}},sinkDown:function(e){for(var t=this.content.length,n=this.content[e],i=n;;){var r=2*(e+1),o=r-1,a=null;if(o<t){var s=this.content[o],l=s;s<i&&(a=o)}if(r<t)this.content[r]<(null==a?i:l)&&(a=r);if(null==a)break;this.content[e]=this.content[a],this.content[a]=n,e=a}}},e}(Ae||{}))||{}))||{}))||{}),Pe=function(e){},(Re=Ae||{}).KaryoPanel=function(t,n){var i,r,o,a,s=this;this.$container=e('<div class="igv-karyo-div">'),t.append(this.$container),!0===n.showKaryo?this.$container.show():this.$container.hide(),this.$karyoPanelToggle=Re.makeToggleButton("Karyotype Panel","Karyotype Panel","showKaryo",function(){return s.$container},void 0),this.ideograms=null,Re.guichromosomes=[],i=e('<div class="igv-karyo-content-div"></div>')[0],this.$container.append(i),r=e('<canvas class="igv-karyo-canvas"></canvas>')[0],e(i).append(r),r.setAttribute("width",i.offsetWidth),r.setAttribute("height",i.offsetHeight),this.canvas=r,this.ctx=r.getContext("2d"),(a=document.createElement("canvas")).style.position="absolute",a.style.width="100px",a.style.height="20px",a.style.left="-2000px",a.setAttribute("width","100px"),a.setAttribute("height","20px"),o=a.getContext("2d"),i.appendChild(a),this.canvas.onmousemove=function(e){for(var t=Re.translateMouseCoordinates(e,r),n=t.x,i=t.y,s=!1,l=0;l<Re.guichromosomes.length;l++){var c=Re.guichromosomes[l];if(c.x<n&&c.right>n&&c.y<i&&c.bottom>i){var h=i-c.y,u=Math.round(c.size*h/c.h);a.style.left=Math.round(n+20)+"px",a.style.top=Math.round(i-5)+"px",o.clearRect(0,0,a.width,a.height),o.fillStyle="rgb(255,255,220)",o.fillRect(0,0,a.width,a.height),o.fillStyle="rgb(0,0,0)";var f=Math.round(u/1e6);o.fillText(c.name+" @ "+f+" MB",3,12),s=!0;break}}s||(a.style.left="-2000px")},this.canvas.onclick=function(e){var t=Re.translateMouseCoordinates(e,r),n=t.x,i=t.y;Re.navigateKaryo(n,i)}},Re.navigateKaryo=function(e,t){for(var n=0;n<Re.guichromosomes.length;n++){var i=Re.guichromosomes[n];if(i.x<e&&i.right>e&&i.y<t&&i.bottom>t){var r=t-i.y,o=Math.round(i.size*r/i.h);Pe("Going to position "+o),Re.browser.goto(i.name,o,void 0);break}}Re.browser.update()},Re.KaryoPanel.prototype.resize=function(){var e;void 0!==Re.browser.genomicStateList&&((e=this.canvas).setAttribute("width",e.clientWidth),e.setAttribute("height",e.clientHeight),Pe("Resize called: width="+e.clientWidth+"/"+e.clientHeight),this.ideograms=void 0,this.repaint())},Re.KaryoPanel.prototype.repaint=function(){var e,t,n,r,o,a;if(void 0!==this.canvasWidth&&void 0!==this.canvasHeight&&void 0!==Re.browser.genomicStateList&&(e=Re.browser.genome).ideograms&&(n=(t=i.first(Re.browser.genomicStateList)).referenceFrame,r=[],o=this.canvas.width,a=this.canvas.height,this.ctx.clearRect(0,0,o,a),e&&n&&e.chromosomes&&n.chrName)){var s=e.chromosomes,l=this.ideograms;if(s.length<1)Pe("No chromosomes yet, returning");else{var c=24,h=1;o<300&&(h=2);var u=Math.min(50,(o-20)/(c+2)*h),f=Math.min(20,u/2),p=25,d=(a-25)/h-p,g=e.getLongestChromosome(),m=e.getCytobands(g.name);if(m){var v=this,y=m[m.length-1].end;l&&null!=l||function(){(l=document.createElement("canvas")).width=o,l.height=a;var t=l.getContext("2d"),n=0,i=0,r=1,g=p;for(w in Re.guichromosomes=[],s){if(n>c)break;1==r&&2==h&&n+1>c/2&&(r=2,i=0,g=g+d+p),n++,i++;var m=e.getChromosome(w);"chrM"!=w||m.bpLength||(m.bpLength=16e3),m.x=i*u,m.y=g;var v=new Object;v.name=w,Re.guichromosomes.push(v),C(v,m.x,m.y,m,t,f,d,y)}this.ideograms=l,Pe("============= PROCESSING "+Re.browser.trackViews.length+" TRACKS");for(var b=0,x=0;x<Re.browser.trackViews.length;x++){var k=Re.browser.trackViews[x],S=k.track;if(S.getSummary&&S.loadSummary){Pe("Found track with summary: "+S.name);var T=S;window.source=S,T.loadSummary("chr1",0,1e6,function(e){if(e)for(w in n=0,s){var i=Re.guichromosomes[n];n++,i&&i.size&&_(T,w,0,i.size,i,t,b)}}),b++}}}.call(this),this.ctx.drawImage(l,0,0),this.ctx.save();var w=n.chrName;this.genome&&(w=this.genome.getChromosomeName(w));var b=Re.browser.genome.getChromosome(w);if(b){var x=g.bpLength/d,k=b.y-3+Math.round(n.start/x),S=Math.max(3,Re.browser.viewportContainerWidth()/t.locusCount*n.bpPerPixel/x);this.ctx.strokeStyle="rgb(150, 0, 0)",this.ctx.lineWidth=2,this.ctx.strokeRect(b.x-3,k,f+6,S+6),this.ctx.restore()}else Pe("Could not find chromosome "+w)}}}function C(t,n,i,r,o,a,s,l){if(e&&r){var c=e.getCytobands(r.name);if(c){var h=n+a/2,u=[],f=[],p=c.length,d=s/l;t.x=n,t.y=i,t.w=a,t.right=n+a;var g=0,m=-1;if(p>0?(g=c[p-1].end,t.h=d*g,t.size=g):(m=i+5,t.h=5,t.size=5/d),t.longest=l,t.bottom=i+t.h,p>0)for(var v=0;v<c.length;v++){var y=c[v],w=d*y.start+i,b=d*y.end+i;if(b>m)if("c"==y.type)"p"==y.name.charAt(0)?(f[0]=w,u[0]=a+n,f[1]=w,u[1]=n,f[2]=b,u[2]=h):(f[0]=b,u[0]=a+n,f[1]=b,u[1]=n,f[2]=w,u[2]=h),o.fillStyle="rgb(220, 150, 100)",o.strokeStyle="rgb(150, 0, 0)",o.polygon(u,f,1,0);else{var x=b-w;o.fillStyle=T(y),o.fillRect(n,w,a,x)}m=b}}o.fillStyle=null,o.lineWidth=1,o.strokeStyle="darkgray";var k=a/2;o.roundRect(n,i-k/2,a,m-i+k,a/2,0,1),o.font="bold 10px Arial",o.fillStyle="rgb(0, 0, 0)";var S=r.name;S.length>3&&(S=S.substring(3)),o.fillText(S,n+a/2-3*S.length,i-10)}}function T(e){if("c"==e.type)return"rgb(150, 10, 10)";var t=e.stain,n=230;"p"==e.type&&(n=Math.floor(230-t/100*230));var i=r[n];return null==i&&(i="rgb("+n+","+n+","+n+")",r[n]=i),i}function _(t,n,i,r,o,a,s){t.getSummary(n,i,r,function(n){n&&(n.length,function(t,n,i,r,o,a,s,l,c,h){if(e&&i&&n&&0!=n.length)for(var u=l/c,f=0;f<n.length;f++){var p=n[f],d="rgb(0,0,150)",g=p.score;t.getColor&&(d=t.getColor(g));var m=u*p.start+o,v=u*p.end+o,y=Math.max(.01,v-m);a.fillStyle=d,a.fillRect(r+s+2*h+1,m,1,y)}}(t,n,o,o.x,o.y,a,f,d,y,s),v.repaint())})}},Ae=Re,(Ee=Ae||{}).oauth={google:{}},Ae=Ee,(Le=Ae||{}).isBlank=function(e){return!e.match(/\S+/g)},Le.isComment=function(e){return 0==e.indexOf("#")},Le.getQueryValue=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?void 0:t[1]},Ae=Le,Ae=function(e){function t(e,t,n){var i,r;return i=Math.round((e.start-t)/n),(r=Math.round((e.end-t)/n)-i)<3&&(r=3,i-=1),{x:i,width:r}}return e.ROI=function(t){this.config=t,this.name=t.name,this.roiSource=new e.FeatureSource(t),this.color=t.color||"rgba(68, 134, 247, 0.25)"},e.ROI.prototype.getFeatures=function(e,t,n){return this.roiSource.getFeatures(e,t,n)},e.ROI.prototype.draw=function(n){var i,r,o,a;if(a=n.features){i=n.bpStart+(n.pixelWidth*n.bpPerPixel+1);for(var s=0,l=a.length;s<l;s++)if(!((r=a[s]).end<n.bpStart)){if(r.start>i)break;o=t(r,n.bpStart,n.bpPerPixel),e.graphics.fillRect(n.context,o.x,0,o.width,n.pixelHeight,{fillStyle:this.color})}}},e}((Ae=((Me=Ae||{}).ReferenceFrame=function(e,t,n){this.chrName=e,this.start=t,this.bpPerPixel=n},Me.ReferenceFrame.prototype.set=function(e){this.chrName=e.chrName,this.start=e.start,this.bpPerPixel=e.bpPerPixel},Me.ReferenceFrame.prototype.toPixels=function(e){return e/this.bpPerPixel},Me.ReferenceFrame.prototype.toBP=function(e){return this.bpPerPixel*e},Me.ReferenceFrame.prototype.shiftPixels=function(e){this.start+=e*this.bpPerPixel},Me.ReferenceFrame.prototype.description=function(){return"ReferenceFrame "+this.chrName+" "+Me.numberFormatter(Math.floor(this.start))+" bpp "+this.bpPerPixel},Me))||{}),Ae=function(t){var n,r,o,a,s,l,c,h;function u(e,n){var i,s,l;return i=a[r[n]],s=o[r[n]],l=Math.round(e/s),t.numberFormatter(l)+" "+i}return 50,n=[1e8,5e7,1e7,5e6,1e6,5e5,1e5,5e4,1e4,5e3,1e3,500,100,50,10].reverse(),r=i.map(n,function(e){return e.toString()}),(l={})[1e8.toString()]=1e6,l[5e7.toString()]=1e6,l[1e7.toString()]=1e6,l[5e6.toString()]=1e6,l[1e6.toString()]=1e6,l[5e5.toString()]=1e3,l[1e5.toString()]=1e3,l[5e4.toString()]=1e3,l[1e4.toString()]=1e3,l[5e3.toString()]=1e3,l[1e3.toString()]=1e3,l[500..toString()]=1,l[100..toString()]=1,l[50..toString()]=1,l[10..toString()]=1,o=l,(c={})[1e8.toString()]="mb",c[5e7.toString()]="mb",c[1e7.toString()]="mb",c[5e6.toString()]="mb",c[1e6.toString()]="mb",c[5e5.toString()]="kb",c[1e5.toString()]="kb",c[5e4.toString()]="kb",c[1e4.toString()]="kb",c[5e3.toString()]="kb",c[1e3.toString()]="kb",c[500..toString()]="",c[100..toString()]="",c[50..toString()]="",c[10..toString()]="",a=c,h={},i.each(n,function(e){h[e.toString()]=e}),s=h,t.RulerTrack=function(){this.height=40,this.name="",this.id="ruler",this.disableButtons=!0,this.ignoreTrackMenu=!0,this.order=-Number.MAX_VALUE,this.supportsWholeGenome=!0},t.RulerTrack.prototype.createRulerSweeper=function(e,n,i,r){void 0===this.rulerSweepers&&(this.rulerSweepers={}),this.rulerSweepers[r.locusIndex.toString()]=new t.RulerSweeper(e,n,i,r)},t.RulerTrack.prototype.locusLabelWithGenomicState=function(n){var i;return(i=e('<div class = "igv-viewport-content-ruler-div">')).text(n.locusSearchString),i.data("referenceFrame",JSON.parse(JSON.stringify(n.referenceFrame))),i.click(function(i){n.referenceFrame.set(e(this).data("referenceFrame")),t.browser.selectMultiLocusPanelWithGenomicState(n)}),i},t.RulerTrack.prototype.getFeatures=function(e,t,n){return Promise.resolve([])},t.RulerTrack.prototype.draw=function(e){var n,o,a,l,c,h,f,p,d,g,m,v,y,w,b,x,k,S,C,T,_,A,I,R;if(o=this.rulerSweepers[e.genomicState.locusIndex.toString()],"all"===e.referenceFrame.chrName.toLowerCase())o.$viewportContent.find("canvas").hide(),o.$viewportContent.find(".igv-whole-genome-container").show(),o.disableMouseHandlers();else{o.$viewportContent.find(".igv-whole-genome-container").hide(),o.$viewportContent.find("canvas").show(),o.addMouseHandlers(),I=e.viewport.$viewport.find(".igv-viewport-content-ruler-div"),R=e.genomicState,I.text(R.locusSearchString),a=0;for(var P=0;P<i.size(r);P++)if((l=e.referenceFrame.toPixels(s[r[P]]))>50){a=P;break}for(2,6,v=e.bpStart+e.referenceFrame.toBP(e.pixelWidth),v=Math.min(e.genomicState.chromosome.bpLength,v),m=e.context.measureText(u(v,a)).width,n=0,f=0,c=e.bpStart;n<e.pixelWidth;n+=l,f++,c+=s[r[a]])(0==f%2||m<l)&&(h=u(c,a),d={x:Math.round(n),y:this.height-8},g={width:e.context.measureText(h).width,height:2},T=d,A=void 0,S=(_=g).width/2,C=_.height/2,A={width:S,height:C},y=T.x-A.width,w=T.y-A.height,b=_.width,x=_.height,k=void 0,(k={origin:{},size:{}}).origin.x=y,k.origin.y=w,k.size.width=b,k.size.height=x,p=k,t.graphics.fillText(e.context,h,Math.round(n-p.size.width/2),this.height-8)),t.graphics.strokeLine(e.context,Math.round(n),this.height-6,Math.round(n),this.height-2);t.graphics.strokeLine(e.context,0,this.height-2,e.pixelWidth,this.height-2)}},t}((Ae=function(t){function n(e){return this.genomicState.referenceFrame.start+e*this.genomicState.referenceFrame.bpPerPixel}function r(t,n){var i;return i=e.event.fix(t),void 0===n.offset()&&console.log("igv.translateMouseCoordinates - $target.offset() is undefined."),{x:i.pageX-n.offset().left,y:i.pageY-n.offset().top}}return t.RulerSweeper=function(t,n,i,r){this.viewport=t,this.$viewport=n,this.$viewportContent=i,this.genomicState=r,this.$rulerSweeper=e('<div class="igv-ruler-sweeper-div">'),this.$viewportContent.append(this.$rulerSweeper),this.wholeGenomeLayout(this.$viewportContent.find(".igv-whole-genome-container")),this.mouseHandlers={document:{down:"mousedown.rulersweeper."+this.genomicState.locusIndex,move:"mousemove.rulersweeper."+this.genomicState.locusIndex,up:"mouseup.rulersweeper."+this.genomicState.locusIndex},viewport:{down:"mousedown.rulersweeper.viewport."+this.genomicState.locusIndex}},this.addMouseHandlers()},t.RulerSweeper.prototype.wholeGenomeLayout=function(n){var r,o,a,s,l,c,h,u=this;a=i.last(t.browser.genome.wgChromosomeNames),s=t.browser.genome.getChromosome(a),o=Math.floor(s.bpLength/1e3)+t.browser.genome.getCumulativeOffset(a),r=this.$viewport.width(),l=0,i.each(t.browser.genome.wgChromosomeNames,function(a){var s,f;(f=t.browser.genome.getChromosome(a).bpLength/o)*r<1?l+=f:(c=e("<div>"),n.append(c),s=Math.floor(f*r),c.width(s),h=e("<span>"),c.append(h),h.text(a),c.on("click",function(e){var n,r;u.$viewportContent.find(".igv-whole-genome-container").hide(),u.$viewportContent.find("canvas").show(),1===u.genomicState.locusCount?n=a:((r=i.map(t.browser.genomicStateList,function(e){return e.locusSearchString}))[u.genomicState.locusIndex]=a,n=r.join(" ")),t.browser.search(n)}))}),l*=r,(l=Math.floor(l))>=1&&(c=e("<div>"),n.append(c),c.width(l),h=e("<span>"),c.append(h),h.text("-"))},t.RulerSweeper.prototype.disableMouseHandlers=function(){e(document).off(this.mouseHandlers.document.down),e(document).off(this.mouseHandlers.document.move),e(document).off(this.mouseHandlers.document.up),this.$viewport.off(this.mouseHandlers.viewport.down)},t.RulerSweeper.prototype.addMouseHandlers=function(){var i,o,a,s,l,c,h=this;this.disableMouseHandlers(),i=o=a=void 0,e(document).on(this.mouseHandlers.document.down,function(e){o=!0,a=r(e,h.$viewport).x,!0===i&&(h.$rulerSweeper.show(),l=1,s=a,h.$rulerSweeper.css({left:s+"px"}),h.$rulerSweeper.width(l))}),e(document).on(this.mouseHandlers.document.move,t.throttle(function(e){var t;i&&o&&(t=r(e,h.$viewport).x,t=Math.min(t,h.$viewport.width()),t=Math.max(t,0),c=t-a,l=Math.abs(c),h.$rulerSweeper.width(l),c<0&&(s=a+c,h.$rulerSweeper.css({left:s+"px"})))},10)),e(document).on(this.mouseHandlers.document.up,function(e){var r;!0===i&&!0===o&&(i=o=void 0,h.$rulerSweeper.hide(),(r={}).start=n.call(h,s),r.end=n.call(h,s+l),l>1&&(t.Browser.validateLocusExtent(t.browser.genome.getChromosome(h.genomicState.referenceFrame.chrName),r),h.viewport.goto(h.genomicState.referenceFrame.chrName,r.start,r.end)))}),this.$viewport.on(this.mouseHandlers.viewport.down,function(e){i=!0})},t}((Ae=((De=Ae||{}).ROISource=function(e){this.config=e||{},this.sourceType=void 0===e.sourceType?"file":e.sourceType,this.reader=new De.FeatureFileReader(e),this.visibilityWindow=e.visibilityWindow},De.ROISource.prototype.getRegions=function(e,t,n){var i=this;return new Promise(function(r,o){var a;a=new De.GenomicInterval(e,t,n),i.reader.readFeatures(e,a.start,a.end).then(function(e){r(e)}).catch(o)})},De))||{}))||{}),Fe=Ae||{},(Be=function(){this.attributes={},this.plinkLoaded=!1}).prototype.loadPlinkFile=function(e,t){var n=this;return t||(t={}),new Promise(function(i,r){var o=Fe.buildOptions(t);Fe.xhr.loadString(e,o).then(function(e){e.splitLines().forEach(function(e){var t=e.split(" ");n.attributes[t[1]]={familyId:t[0],fatherId:t[2],motherId:t[3],sex:t[4],phenotype:t[5]}}),n.plinkLoaded=!0,i(n.attributes)}).catch(r)})},Be.prototype.getAttributes=function(e){return this.attributes[e]},Be.prototype.getAttributeNames=function(){return this.hasAttributes()?Object.keys(this.attributes[Object.keys(this.attributes)[0]]):[]},Be.prototype.hasAttributes=function(){return Object.keys(this.attributes).length>0},Fe.sampleInformation=new Be,Ae=Fe,(Ne=Ae||{}).SequenceTrack=function(e){this.config=e,this.name="",this.id="sequence",this.sequenceType=e.sequenceType||"dna",this.height=25,this.disableButtons=!1,this.order=e.order||-Number.MAX_VALUE,this.ignoreTrackMenu=!1,this.supportsWholeGenome=!1,this.removable=!1,this.reversed=!1,this.frameTranslate=!1,this.complement={A:"T",C:"G",G:"C",T:"A"},this.translationDict={TTT:"F",TTC:"F",TTA:"L",TTG:"L",CTT:"L",CTC:"L",CTA:"L",CTG:"L",ATT:"I",ATC:"I",ATA:"I",ATG:"M",GTT:"V",GTC:"V",GTA:"V",GTG:"V",TCT:"S",TCC:"S",TCA:"S",TCG:"S",CCT:"P",CCC:"P",CCA:"P",CCG:"P",ACT:"T",ACC:"T",ACA:"T",ACG:"T",GCT:"A",GCC:"A",GCA:"A",GCG:"A",TAT:"Y",TAC:"Y",TAA:"STOP",TAG:"STOP",CAT:"H",CAC:"H",CAA:"Q",CAG:"Q",AAT:"N",AAC:"N",AAA:"K",AAG:"K",GAT:"D",GAC:"D",GAA:"E",GAG:"E",TGT:"C",TGC:"C",TGA:"STOP",TGG:"W",CGT:"R",CGC:"R",CGA:"R",CGG:"R",AGT:"S",AGC:"S",AGA:"R",AGG:"R",GGT:"G",GGC:"G",GGA:"G",GGG:"G"}},Ne.SequenceTrack.prototype.menuItemList=function(e){var t=this;return[{name:t.reversed?"Forward":"Reverse",click:function(){t.reversed=!t.reversed,e.hide(),Ne.browser.update()}},{name:t.frameTranslate?"Close Translation":"Three-frame Translate",click:function(){t.frameTranslate=!t.frameTranslate,e.hide(),t.frameTranslate?(t.trackView.viewports[0].canvas.height=115,t.trackView.setTrackHeight(115)):(t.trackView.viewports[0].canvas.height=25,t.trackView.setTrackHeight(25))}}]},Ne.SequenceTrack.prototype.translateSequence=function(e){var t=[[],[],[]],n=this;return[0,1,2].forEach(function(i){for(var r,o,a=i;e.length-a>=3;)r={},o=e.slice(a,a+3),n.reversed&&(o=o.split("").reverse().join("")),r.codons=o,r.aminoA=n.translationDict[o],t[i].push(r),r=null,a+=3}),t},Ne.SequenceTrack.prototype.getFeatures=function(e,t,n,i){return new Promise(function(r,o){i&&i>1?r(null):Ne.browser.genome.sequence.getSequence(e,t,n).then(r).catch(o)})},Ne.SequenceTrack.prototype.draw=function(e){var t,n,i,r,o,a,s,l,c,h,u,f,p=this,d=e.features,g=e.context,m=e.bpPerPixel,v=e.bpStart,y=v+e.pixelWidth*m+1;if(d){for(t=d.length,n=1/m,r=v;r<=y;r++)(o=r-v)<t&&(a=d[o],this.reversed&&(a=this.complement[a.toUpperCase()]),s=Math.floor(o*n),l=Math.floor((o+1)*n),c=Math.round((s+l)/2),(h=this.color?this.color:"dna"===this.sequenceType?Ne.nucleotideColors[a]:"rgb(0, 0, 150)")||(h="gray"),m>.1?Ne.graphics.fillRect(g,s,5,l-s,10,{fillStyle:h}):Ne.graphics.strokeText(g,a,c-g.measureText(a).width/2,15,{strokeStyle:h}));this.frameTranslate&&(u=this.reversed?(u=d.split("").map(function(e){return p.complement[e]})).join(""):d,i=15,this.translateSequence(u).forEach(function(e,t){var r=t;i=0===t?i+10:i+30,e.forEach(function(e,t){var o=t+r+2*t;h=t%2==0?"rgb(160,160,160)":"rgb(224,224,224)",s=Math.floor(o*n),l=Math.floor((o+3)*n),c=Math.round((s+l)/2),e.aminoA.indexOf("STOP")>-1?(h="rgb(255, 0, 0)",f="STOP"):f=e.aminoA,"M"===e.aminoA&&(h="rgb(0, 153, 0)",f="START"),Ne.graphics.fillRect(g,s,i,l-s,25,{fillStyle:h}),m<=.1&&Ne.graphics.strokeText(g,f,c-g.measureText(f).width/2,i+15)})}))}},Ae=Ne,(Oe=Ae||{}).XMLSession=function(e){var t,n,i,r,o,a,s,l,c=this;t=new DOMParser,n=t.parseFromString(e,"text/xml"),!(r=n.getElementsByTagName("Session"))||r.length,o=r.item(0),a=o.getAttribute("genome"),s=o.getAttribute("locus"),l=o.getAttribute("ucscID"),Oe.Genome.KnownGenomes.hasOwnProperty(a)?c.reference={id:a}:c.reference={fastaURL:a},s&&(c.locus=s),l&&(c.reference.id=l),i=n.getElementsByTagName("Resource"),c.tracks=[];var h={};function u(e,t){var n,i,r,o,a,s,l,c,h;t.name=e.getAttribute("name"),(n=e.getAttribute("color"))&&(t.color="rgb("+n+")"),o=e.getAttribute("altColor"),n&&(t.altColor="rgb("+o+")"),(i=e.getAttribute("height"))&&(t.height=parseInt(i)),(r=e.getAttribute("autoScale"))&&(t.autoScale="true"===r),(l=e.getAttribute("windowFunction"))&&(t.windowFunction=l),(c=e.getAttribute("visibilityWindow")||e.getAttribute("featureVisibilityWindow"))&&(t.visibilityWindow=c),(h=e.getAttribute("indexed"))&&(t.indexed="true"===h),(s=e.getElementsByTagName("DataRange")).length>0&&(a=s.item(0),r||(t.min=parseInt(a.getAttribute("minimum")),t.max=parseInt(a.getAttribute("maximum"))),t.logScale="LOG"===a.getAttribute("type"))}Array.from(i).forEach(function(e,t){e={url:e.getAttribute("path"),indexURL:e.getAttribute("index"),order:t},c.tracks.push(e),h[e.url]=e}),(i=n.getElementsByTagName("Track"))&&i.length>0&&(c.tracks=[],Array.from(i).forEach(function(e){var t,n,i,r;(i=e.getElementsByTagName("Track"))&&i.length>0?(u(e,r={type:"merged",tracks:[]}),c.tracks.push(r),Array.from(i).forEach(function(e){var t,n;e.processed=!0,t=e.getAttribute("id"),(n=h[t])&&(r.tracks.push(n),u(e,n),n.autoscale=!1,r.height=n.height)})):e.processed||(t=e.getAttribute("id"),(n=h[t])&&(c.tracks.push(n),u(e,n)))}))},Ae=Oe;Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"undefined"==typeof Set&&(Set=function(){this.data={},this.add.apply(this,arguments)},Set.prototype={add:function(){for(var e,t=0;t<arguments.length;t++)if(e=arguments[t],Array.isArray(e)||this._isPseudoArray(e))for(var n=0;n<e.length;n++)this._add(e[n]);else if(e instanceof Set){var i=this;e.each(function(e,t){i._add(t,e)})}else this._add(e);return this},addAll:function(e){if(Array.isArray(e)||this._isPseudoArray(e))for(var t=0;t<e.length;t++)this._add(e[t]);else if(e instanceof Set){var n=this;e.each(function(e,t){n._add(t,e)})}return this},_add:function(e,t){return void 0===t&&(t=e),this.data[this._makeKey(e)]=t,this},_getKey:function(e){return e},_makeKey:function(e){return e},_removeItem:function(e){delete this.data[this._getKey(e)]},_isPseudoArray:function(e){return!1},delete:function(e){for(var t,n=0;n<arguments.length;n++)if(t=arguments[n],Array.isArray(t)||this._isPseudoArray(t))for(var i=0;i<t.length;i++)this._removeItem(t[i]);else this._removeItem(t);return this},has:function(e){return e=this._makeKey(e),Object.prototype.hasOwnProperty.call(this.data,e)},hasAll:function(e){var t=this.makeNew.apply(this,arguments),n=this;return t.every(function(e,t){return n.has(t)})},makeSet:function(e){return e instanceof Set?e:this.makeNew.apply(this,arguments)},equals:function(e){return e=this.makeSet(e),this.isSubset(e)&&this.isSuperset(e)},isEmpty:function(){for(var e in this.data)if(this.has(e))return!1;return!0},size:function(){var e=0;for(var t in this.data)this.has(t)&&e++;return e},keys:function(){var e=[];return this.each(function(t){e.push(t)}),e},clear:function(){return this.data={},this},makeNew:function(){var e=new this.constructor;return arguments.length&&e.add.apply(e,arguments),e},union:function(e){e=this.makeSet(e);var t=this.makeNew(this);return t.add(e),t},intersection:function(e){e=this.makeSet(e);var t=this.makeNew();return this.each(function(n,i){e.has(i)&&t._add(i,n)}),t},difference:function(e){e=this.makeSet(e);var t=this.makeNew();return this.each(function(n,i){e.has(i)||t._add(i,n)}),t},notInBoth:function(e){return e=this.makeSet(e),this.difference(e).add(e.difference(this))},isSubset:function(e){return e=this.makeSet(e),this.eachReturn(function(t,n){if(!e.has(n))return!1})},isSuperset:function(e){e=this.makeSet(e);var t=this;return e.eachReturn(function(e,n){if(!t.has(n))return!1})},each:function(e){return this.eachReturn(e),this},eachReturn:function(e){for(var t in this.data)if(this.has(t)&&!1===e.call(this,this.data[t],t))return!1;return!0},filter:function(e){var t=this.makeNew();return this.each(function(n,i){!0===e.call(this,i)&&t._add(i,n)}),t},map:function(e){var t=this.makeNew();return this.each(function(n,i){void 0!==e.call(this,i)&&t._add(i,n)}),t},some:function(e){var t=!1;return this.eachReturn(function(n){if(!0===e.call(this,n))return t=!0,!1}),t},every:function(e){return this.eachReturn(e)}},Set.prototype.constructor=Set);var He,ze,$e,Ge,Ue,We,Ve,qe,je,Xe,Ke;Ae=function(e){e.TDFSource=function(t){this.windowFunction=t.windowFunction||"mean",this.reader=new e.TDFReader(t)},e.TDFSource.prototype.getFeatures=function(n,i,r,o){var a=this,s=new e.GenomicInterval(n,i,r);return"all"===n.toLowerCase()?Promise.resolve([]):(s.bpPerPixel=o,(a.rootGroup?Promise.resolve(a.rootGroup):a.reader.readRootGroup().then(function(e){return a.rootGroup=e,e})).then(function(i){var r,s,l,c,h=(s=n,l=o,c=e.browser.genome.getChromosome(s).bpLength,Math.ceil(Math.log(Math.max(0,c/(700*l)))/t)),u=a.reader.chrAliasTable[n],f=a.reader.maxZoom;return void 0===u&&(u=n),void 0===f&&(f=-1),r=h>f?"raw":a.windowFunction,a.reader.readDataset(u,r,h)}).then(function(e){if(null==e)return[];var t=e.tileWidth,n=Math.floor(i/t),o=Math.floor(r/t);return a.reader.readTiles(e.tiles.slice(n,o+1),1)}).then(function(e){var t=[];return e.forEach(function(e){switch(e.type){case"bed":!function(e,t,n,i,r,o){var a,s=e.nPositions,l=e.start,c=e.end,h=e.data[0];for(a=0;a<s;a++){var u=l[a],f=c[a];if(!(f<n)){if(u>i)break;o.push({chr:t,start:u,end:f,value:h[a]})}}}(e,n,i,r,0,t);break;case"variableStep":!function(e,t,n,i,r,o){var a,s=e.nPositions,l=e.start,c=e.span,h=e.data[0];for(a=0;a<s;a++){var u=l[a],f=u+c;if(!(f<n)){if(u>i)break;o.push({chr:t,start:u,end:f,value:h[a]})}}}(e,n,i,r,0,t);break;case"fixedStep":!function(e,t,n,i,r,o){var a,s=e.nPositions,l=e.start,c=e.span,h=e.data[0];for(a=0;a<s;a++){var u=l+c;if(l>i)break;u>=n&&(Number.isNaN(h[a])||o.push({chr:t,start:l,end:u,value:h[a]})),l=u}}(e,n,i,r,0,t);break;default:return void reject("Unknown tile type: "+e.type)}}),t.sort(function(e,t){return e.start-t.start}),t}))};var t=Math.log(2);return e}((Ae=function(e){function t(e,t){var n,i,r=e.getInt(),o=e.getInt(),a=e.getFloat(),s=r,l=t;for(n=[];l-- >0;){for(s=r,i=[];s-- >0;)i.push(e.getFloat());n.push(i)}return{type:"fixedStep",start:o,span:a,data:n,nTracks:t,nPositions:r}}function n(e,t){for(var n,i,r=e.getInt(),o=e.getFloat(),a=e.getInt(),s=a,l=t,c=[];s-- >0;)c.push(e.getInt());e.getInt();for(n=[];l-- >0;){for(s=a,i=[];s-- >0;)i.push(e.getFloat());n.push(i)}return{type:"variableStep",tileStart:r,span:o,start:c,data:n,nTracks:t,nPositions:a}}function i(e,t,n){var i,r,o,a,s,l,c,h,u;for(l=i=e.getInt(),r=[];l-- >0;)r.push(e.getInt());for(l=i,o=[];l-- >0;)o.push(e.getInt());e.getInt();for(a=[],c=t;c-- >0;){for(h=i,u=[];h-- >0;)u.push(e.getFloat());a.push(u)}if("bedWithName"===n)for(l=i,s=[];l-- >0;)s.push(e.getString());return{type:n,start:r,end:o,data:a,name:s,nTracks:t,nPositions:i}}return e.TDFReader=function(e){this.config=e,this.path=e.url,this.groupCache={},this.datasetCache={}},e.TDFReader.prototype.readHeader=function(){var t=this;return void 0!==this.magic?Promise.resolve(this):e.xhr.loadArrayBuffer(t.path,e.buildOptions(t.config,{range:{start:0,size:64e3}})).then(function(n){var i=new e.BinaryParser(new DataView(n));t.magic=i.getInt(),t.version=i.getInt(),t.indexPos=i.getLong(),t.indexSize=i.getInt();i.getInt();if(t.version>=2){var r=i.getInt();for(t.windowFunctions=[];r-- >0;)t.windowFunctions.push(i.getString())}t.trackType=i.getString(),t.trackLine=i.getString();var o=i.getInt();for(t.trackNames=[];o-- >0;)t.trackNames.push(i.getString());return t.genomeID=i.getString(),t.flags=i.getInt(),t.compressed=0!=(1&t.flags),e.xhr.loadArrayBuffer(t.path,e.buildOptions(t.config,{range:{start:t.indexPos,size:t.indexSize}}))}).then(function(n){var i=new e.BinaryParser(new DataView(n));t.datasetIndex={};for(var r=i.getInt();r-- >0;){var o=i.getString(),a=i.getLong(),s=i.getInt();t.datasetIndex[o]={position:a,size:s}}for(t.groupIndex={},r=i.getInt();r-- >0;)o=i.getString(),a=i.getLong(),s=i.getInt(),t.groupIndex[o]={position:a,size:s};return t})},e.TDFReader.prototype.readDataset=function(t,n,i){var r,o,a=this;return o=t+"_"+n+"_"+i,a.datasetCache[o]?Promise.resolve(a.datasetCache[o]):a.readHeader().then(function(o){var s,l=a.version<2?"":"/"+n,c="all"===t.toLowerCase()||void 0===i?"0":i.toString();return r="raw"===n?"/"+t+"/raw":"/"+t+"/z"+c+l,void 0===(s=a.datasetIndex[r])?void 0:e.xhr.loadArrayBuffer(a.path,e.buildOptions(a.config,{range:{start:s.position,size:s.size}}))}).then(function(t){if(t){for(var n=new e.BinaryParser(new DataView(t)),i=n.getInt(),s={};i-- >0;)s[n.getString()]=n.getString();for(var l=n.getString(),c=n.getFloat(),h=n.getInt(),u=[];h-- >0;)u.push({position:n.getLong(),size:n.getInt()});var f={name:r,attributes:s,dataType:l,tileWidth:c,tiles:u};return a.datasetCache[o]=f,f}})},e.TDFReader.prototype.readRootGroup=function(){var t=this,n=this.groupCache["/"];return n?Promise.resolve(n):t.readGroup("/").then(function(n){var i=e.browser.genome,r=n.chromosomes,o=n.maxZoom;return o&&(t.maxZoom=Number(o)),t.chrAliasTable={},r&&r.split(",").forEach(function(e){var n=i.getChromosomeName(e);t.chrAliasTable[n]=e}),n})},e.TDFReader.prototype.readGroup=function(t){var n,i=this;return(n=i.groupCache[t])?Promise.resolve(n):i.readHeader().then(function(n){var r=i.groupIndex[t];return void 0===r?void 0:e.xhr.loadArrayBuffer(i.path,e.buildOptions(i.config,{range:{start:r.position,size:r.size}}))}).then(function(n){if(n){for(var r=new e.BinaryParser(new DataView(n)),o=r.getInt(),a={name:t};o-- >0;)a[r.getString()]=r.getString();return i.groupCache[t]=a,a}})},e.TDFReader.prototype.readTiles=function(r,a){var s=this;if(r.sort(function(e,t){return e.position-t.position}),0===(r=r.filter(function(e){return e.size>0})).length)return Promise.resolve([]);var l=r[0],c=r[r.length-1],h=l.position,u=c.position+c.size-h;return e.xhr.loadArrayBuffer(s.path,e.buildOptions(s.config,{range:{start:h,size:u}})).then(function(l){var c=[];return r.forEach(function(r){var u=r.position-h,f=r.size;if(f>0){var p;if(s.compressed)p=new o.Inflate(new Uint8Array(l,u,f)).decompress().buffer;else p=l.slice(u,u+f);var d,g=new e.BinaryParser(new DataView(p)),m=g.getString();switch(m){case"fixedStep":d=t(g,a);break;case"variableStep":d=n(g,a);break;case"bed":case"bedWithName":d=i(g,a,m);break;default:throw"Unknown tile type: "+m}c.push(d)}}),c})},e.TDFReader.prototype.readTile=function(r,a){var s=this;return e.xhr.loadArrayBuffer(s.path,e.buildOptions(s.config,{range:{start:r.position,size:r.size}})).then(function(r){s.compressed&&(r=new o.Inflate(new Uint8Array(r)).decompress().buffer);var l=new e.BinaryParser(new DataView(r)),c=l.getString();switch(c){case"fixedStep":return t(l,a);case"variableStep":return n(l,a);case"bed":case"bedWithName":return i(l,a,c);default:throw"Unknown tile type: "+c}})},e}((Ae=((He=Ae||{}).SVG=function(){this.svg="",this.contents=[]},He.SVG.prototype.setProperties=function(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];"font-family"===n?t+="font-family:"+i+";":"font-size"===n?t+="font-size:"+i+";":"fillStyle"==n?t+="fill:"+i+";":"fill"===n?t+="fill:"+i+";":"strokeStyle"==n?t+="stroke:"+i+";":"stroke"===n?t+="stroke:"+i+";":"stroke-width"===n?t+="stroke-width:"+i+";":console.log("Unknown property: "+n)}return t},He.SVG.prototype.setTransforms=function(e,t,n){var i="";for(var r in e){if(e.hasOwnProperty(r)){var o=e[r];"rotate"===r?(i+="rotate("+o.angle,i+=","+t,i+=","+n,i+=")"):"translate"===r?(i+="translate("+o[t],"y"in o&&(i+=","+o.y),i+=")"):console.log("Unknown transform: "+r)}i+=" "}return i},He.SVG.prototype.clearRect=function(e,t,n,i){},He.SVG.prototype.strokeLine=function(e,t,n,i,r,o){var a="";a+='<line x1="'+e+'" y1="'+t+'" x2="'+n+'" y2="'+i+'"',r&&(a+=' style="'+this.setProperties(r)+'"'),o&&(a+=' transform="'+this.setTransforms(o,e,t)+'"'),a+="/>",this.contents.push(a)},He.SVG.prototype.fillRect=function(e,t,n,i,r,o){var a="";a+='<rect x="'+e+'" y="'+t,a+='" width="'+n+'" height="'+i+'"',r&&(a+=' style="'+this.setProperties(r)+'"'),o&&(a+=' transform="'+this.setTransforms(o,e,t)+'"'),a+="/>",this.contents.push(a)},He.SVG.prototype.fillRectWithCenter=function(e,t,n,i,r,o){var a="";a+='<rect x="'+(e-n/2)+'" y="'+(t-i/2),a+='" width="'+n+'" height="'+i+'"',r&&(a+=' style="'+this.setProperties(r)+'"'),o&&(a+=' transform="'+this.setTransforms(o,e,t)+'"'),a+="/>",this.contents.push(a)},He.SVG.prototype.fillPolygon=function(e,t,n,i){var r="";r+='<polygon points="';for(var o=0;o<e.length;o++)r+=" "+e[o]+","+t[o];r+='"',n&&(r+=' style="'+this.setProperties(n)+'"'),i&&(r+=' transform="'+this.setTransforms(i,e,t)+'"'),r+="/>",this.contents.push(r)},He.SVG.prototype.fillText=function(e,t,n,i,r){var o="";o+='<text x="'+t+'" y="'+n+'"',i&&(o+=' style="'+this.setProperties(i)+'"'),r&&(o+=' transform="'+this.setTransforms(r,t,n)+'"'),o+=">",o+=e,o+="</text>",this.contents.push(o)},He.SVG.prototype.strokeText=function(e,t,n,i,r){var o="";o+='<text x="'+t+'" y="'+n+'"',i&&(o+=' style="'+this.setProperties(i)+'"'),r&&(o+=' transform="'+this.setTransforms(r,t,n)+'"'),o+=">",o+=e,o+="</text>",this.contents.push(o)},He.SVG.prototype.strokeCircle=function(e,t,n,i,r){var o="";o+='<circle cx="'+e+'" cy="'+t+'" r="'+n+'" stroke="black" fill-opacity="0.0"/>',this.contents.push(o)},He.SVG.prototype.string=function(){var e="";e+='<svg width="100%" height="100%" version="1.1" xmlns="http://www.w3.org/2000/svg">';for(var t=0;t<this.contents.length;t++)e+="\n"+this.contents[t];return e+="</svg>"},He.SVG.prototype.innerString=function(){for(var e="",t=0;t<this.contents.length;t++)e+="\n"+this.contents[t];return e},He))||{}))||{}),Ae=function(t){function n(t){var n=0;return t.forEach(function(t){var i=e(t.contentDiv).height();n=Math.max(i,n)}),n}return t.TrackView=function(n,i,r){var o,a,s,l=this;this.browser=n,a=e('<div class="igv-track-div">'),this.trackDiv=a.get(0),i.append(a),this.track=r,r.trackView=this,this.track instanceof t.RulerTrack&&(this.trackDiv.dataset.rulerTrack="rulerTrack"),r.height&&(this.trackDiv.style.height=r.height+"px"),this.appendLeftHandGutterDivToTrackDiv(e(this.trackDiv)),this.$viewportContainer=e('<div class="igv-viewport-container igv-viewport-container-shim">'),e(this.trackDiv).append(this.$viewportContainer),this.viewports=[],n.genomicStateList.forEach(function(n,i){l.viewports.push(new t.Viewport(l,l.$viewportContainer,n)),l.track instanceof t.RulerTrack&&l.track.createRulerSweeper(l.viewports[i],l.viewports[i].$viewport,e(l.viewports[i].contentDiv),n)}),this.configureViewportContainer(this.$viewportContainer,this.viewports),(o=this.createRightHandGutter())&&e(this.trackDiv).append(o),this.attachDragWidget(),t.doProvideColoSwatchWidget(this.track)&&(s={width:698,classes:["igv-position-absolute"]},this.$colorpicker_container=t.genericContainer(a,s,function(){l.$colorpicker_container.toggle()}),t.createColorSwatchSelector(this.$colorpicker_container,function(e){l.setColor(e)}),this.$colorpicker_container.draggable({handle:this.$colorpicker_container.find("div:first-child").get(0)}),this.$colorpicker_container.hide())},t.TrackView.prototype.configureViewportContainer=function(e,n){return"hidden"===e.css("overflow-y")&&(this.scrollbar=new t.TrackScrollbar(e,n),e.append(this.scrollbar.$outerScroll)),e},t.TrackScrollbar=function(t,i){var r,o=this;function a(e){e.preventDefault(),l(e.pageY-r),e.stopPropagation()}function s(t){e(window).off("mousemove .igv",null,a),e(window).off("mouseup .igv",null,s)}function l(t){var r,a,s,l,c;l=o.$outerScroll.height(),c=o.$innerScroll.height(),r=Math.min(Math.max(0,t),l-c),s=n(i),a=-Math.round(r*(s/o.$viewportContainer.height())),o.$innerScroll.css("top",r+"px"),i.forEach(function(t){e(t.contentDiv).css("top",a+"px")})}n(i),this.$outerScroll=e('<div class="igv-scrollbar-outer-div">'),this.$innerScroll=e("<div>"),this.$outerScroll.append(this.$innerScroll),this.$viewportContainer=t,this.viewports=i,this.$innerScroll.mousedown(function(t){t.preventDefault(),r=t.pageY-e(this).position().top,e(window).on("mousemove .igv",null,null,a),e(window).on("mouseup .igv",null,null,s),t.stopPropagation()}),this.$innerScroll.click(function(e){e.stopPropagation()}),this.$outerScroll.click(function(e){l(e.offsetY-o.$innerScroll.height()/2),e.stopPropagation()})},t.TrackScrollbar.prototype.update=function(){var e,t,i;e=this.$viewportContainer.height(),t=n(this.viewports),i=Math.round(e/t*e),t>e?(this.$outerScroll.show(),this.$innerScroll.height(i)):this.$outerScroll.hide()},t.TrackView.prototype.attachDragWidget=function(){var n=this;n.$trackDragScrim=e('<div class="igv-track-drag-scrim">'),n.$viewportContainer.append(n.$trackDragScrim),n.$trackDragScrim.hide(),n.$trackManipulationHandle=e('<div class="igv-track-manipulation-handle">'),e(n.trackDiv).append(n.$trackManipulationHandle),n.$trackManipulationHandle.mousedown(function(e){e.preventDefault(),n.isMouseDown=!0,t.browser.dragTrackView=n}),n.$trackManipulationHandle.mouseup(function(e){n.isMouseDown=void 0}),n.$trackManipulationHandle.mouseenter(function(e){n.isMouseIn=!0,t.browser.dragTargetTrackView=n,void 0===t.browser.dragTrackView?n.$trackDragScrim.show():n===t.browser.dragTrackView&&n.$trackDragScrim.show(),t.browser.dragTargetTrackView&&t.browser.dragTrackView&&t.browser.dragTargetTrackView!==t.browser.dragTrackView&&(t.browser.dragTargetTrackView.track.order<t.browser.dragTrackView.track.order?(t.browser.dragTrackView.track.order=t.browser.dragTargetTrackView.track.order,t.browser.dragTargetTrackView.track.order=1+t.browser.dragTrackView.track.order):(t.browser.dragTrackView.track.order=t.browser.dragTargetTrackView.track.order,t.browser.dragTargetTrackView.track.order=t.browser.dragTrackView.track.order-1),t.browser.reorderTracks())}),n.$trackManipulationHandle.mouseleave(function(e){n.isMouseIn=void 0,t.browser.dragTargetTrackView=void 0,n!==t.browser.dragTrackView&&n.$trackDragScrim.hide()})},t.TrackView.prototype.appendLeftHandGutterDivToTrackDiv=function(n){var i,r,o,a,s=this;this.track.paintAxis&&(i=e('<div class="igv-left-hand-gutter">'),n.append(i[0]),r=e('<canvas class ="igv-track-control-canvas">'),o=i.outerWidth(),a=i.outerHeight(),r.attr("width",o),r.attr("height",a),i.append(r[0]),this.controlCanvas=r[0],this.controlCtx=this.controlCanvas.getContext("2d"),this.track.dataRange&&(i.click(function(e){t.dataRangeDialog.configureWithTrackView(s),t.dataRangeDialog.show()}),i.addClass("igv-clickable")),this.leftHandGutter=i[0])},t.TrackView.prototype.createRightHandGutter=function(){var n,i=this;if(!this.track.ignoreTrackMenu)return(n=e('<i class="fa fa-gear">')).click(function(e){t.popover.presentTrackGearMenu(e.pageX,e.pageY,i)}),this.rightHandGutter=e('<div class="igv-right-hand-gutter">')[0],e(this.rightHandGutter).append(n),this.rightHandGutter},t.TrackView.prototype.setContentHeightForViewport=function(e,t){e.setContentHeight(t),this.scrollbar&&this.scrollbar.update()},t.TrackView.prototype.dataRange=function(){return this.track.dataRange?this.track.dataRange:void 0},t.TrackView.prototype.setDataRange=function(e,t,n){void 0!==e&&(this.track.dataRange.min=e),void 0!==t&&(this.track.dataRange.max=t),this.track.autoscale=n,this.update()},t.TrackView.prototype.setColor=function(e){this.track.color=e,this.update()},t.TrackView.prototype.setTrackHeight=function(t,n){this.track.minHeight&&(t=Math.max(this.track.minHeight,t)),this.track.maxHeight&&(t=Math.min(this.track.maxHeight,t)),this.track.height=t,e(this.trackDiv).height(t),this.track.paintAxis&&(e(this.controlCanvas).height(t),this.controlCanvas.setAttribute("height",e(this.trackDiv).height())),void 0!==n&&!0!==n||this.update()},t.TrackView.prototype.isLoading=function(){var e;return e=!1,this.viewports.forEach(function(t){!1===e&&(e=t.isLoading())}),e},t.TrackView.prototype.resize=function(){this.viewports.forEach(function(e){e.resize()}),this.scrollbar&&this.scrollbar.update()},t.TrackView.prototype.update=function(){this.viewports.forEach(function(e){e.update()}),this.scrollbar&&this.scrollbar.update()},t.TrackView.prototype.repaint=function(){this.viewports.forEach(function(e){e.repaint()})},t}((Ae=function(t){function n(t){e("#file_input_ok").hide(),e("#file_input_cancel").hide(),t.$file_input.show(),t.$file_input_blurb.show(),t.$file_input_container.show(),t.file=void 0,t.indexFile=void 0,t.$or.show(),t.$url_input_container.show(),e("#url_input_ok").hide(),e("#url_input_cancel").hide(),t.$url_input.show(),t.$url_input.val(void 0),t.$url_input_feedback.hide(),t.$index_url_input.show(),t.$index_url_input.val(void 0),t.$index_url_input_feedback.hide(),t.$warning.hide(),t.$container.hide()}return t.TrackFileLoad=function(){var i,r,o,a=this;this.$container=e('<div class="igv-drag-drop-container">'),function(i,r){var o,a,s;i.$drag_drop_surface=e('<div class="igv-drag-drop-surface">'),r.append(i.$drag_drop_surface),i.$drag_drop_surface.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){e(".igv-drag-drop-container").addClass("is-dragover")}).on("dragleave dragend drop",function(){e(".igv-drag-drop-container").removeClass("is-dragover")}).on("drop",function(e){i.loadLocalFiles(e.originalEvent.dataTransfer.files)}),i.$file_input_container=e('<div class="igv-drag-drop-file-input">'),i.$drag_drop_surface.append(i.$file_input_container),i.$file_input=e('<input id="igv-track-file-input" class="igv-track-file-input-css" type="file" name="files[]" data-multiple-caption="{count} files selected" multiple="">'),i.$file_input_container.append(i.$file_input),i.$file_input.on("change",function(e){i.loadLocalFiles(e.target.files)}),f=i.$file_input_container,p="Choose file(s)",d="igv-track-file-input",g="load-file-blurb",m=e("<label>"),f.append(m),m.attr("for",d),m.attr("id",g),(v=e("<strong>")).text(p),m.append(v),(o=e('<span class="igv-drag-drop-surface-blurb">')).text(" or drop file(s) here"),m.append(o),i.$file_input_blurb=i.$file_input_container.find("#load-file-blurb"),a=e('<div id="file_input_ok" class="igv-drag-drop-ok">'),i.$drag_drop_surface.append(a),a.text("ok"),a.hide(),a.on("click",function(e){var r;r=t.getExtension({url:i.file}),void 0===i.indexFile&&!1===t.TrackFileLoad.keyToIndexExtension[r].optional?i.warnWithMessage("ERROR. "+r+" files require an index file."):void 0===i.indexFile&&!0===t.TrackFileLoad.keyToIndexExtension[r].optional?(t.browser.loadTrack({url:i.file,indexURL:void 0,indexed:!1}),n(i)):(t.browser.loadTrack({url:i.file,indexURL:i.indexFile}),n(i))}),s=e('<div id="file_input_cancel" class="igv-drag-drop-cancel">'),i.$drag_drop_surface.append(s),s.text("cancel"),s.hide(),s.on("click",function(e){n(i)}),l=i,c=i.$drag_drop_surface,l.$url_input_container=e('<div class="igv-drag-and-drop-url-input-container">'),c.append(l.$url_input_container),l.$or=e("<div>"),l.$url_input_container.append(l.$or),l.$or.text("or"),l.$url_input=e('<input class="igv-drag-and-drop-url-input" placeholder="enter data file URL">'),l.$url_input_container.append(l.$url_input),l.$url_input.on("change",function(i){var r;r=e(this).val(),t.TrackFileLoad.isIndexFile(r)?(l.warnWithMessage("Error. Must enter data URL."),e(this).val(void 0)):!1===t.TrackFileLoad.isIndexable(r)?(t.browser.loadTrack({url:r,indexed:!1}),e(this).val(void 0),n(l)):(l.$file_input_container.hide(),l.$or.hide(),l.$url_input_feedback.text(r.split("/").pop()),l.$url_input_feedback.show(),e(this).hide(),h.show(),u.show())}),l.$url_input_feedback=e('<div class="igv-drag-and-drop-url-input-feedback" >'),l.$url_input_container.append(l.$url_input_feedback),l.$url_input_feedback.hide(),l.$index_url_input=e('<input class="igv-drag-and-drop-url-input" placeholder="enter associated index file URL">'),l.$url_input_container.append(l.$index_url_input),l.$index_url_input.on("change",function(n){var i;i=e(this).val(),!1===t.TrackFileLoad.isIndexFile(i)?(l.warnWithMessage("ERROR. Must enter index URL."),e(this).val(void 0)):(l.$index_url_input_feedback.text(i.split("/").pop()),l.$index_url_input_feedback.show(),e(this).hide())}),l.$index_url_input_feedback=e('<div class="igv-drag-and-drop-url-input-feedback" >'),l.$url_input_container.append(l.$index_url_input_feedback),l.$index_url_input_feedback.hide(),h=e('<div  id="url_input_ok" class="igv-drag-drop-ok">'),l.$url_input_container.append(h),h.text("ok"),h.hide(),h.on("click",function(e){var i,r,o,a;i=""===l.$url_input.val()?void 0:l.$url_input.val(),r=""===l.$index_url_input.val()?void 0:l.$index_url_input.val(),o=t.getExtension({url:i}),a=t.TrackFileLoad.keyToIndexExtension[o]?o:"any",void 0===r&&!1===t.TrackFileLoad.keyToIndexExtension[a].optional?l.warnWithMessage("ERROR. A "+o+" data URL requires an associated index URL."):void 0===i?l.warnWithMessage("ERROR. A data URL must be entered."):void 0===r&&!0===t.TrackFileLoad.keyToIndexExtension[a].optional?(t.browser.loadTrack({url:i,indexURL:void 0,indexed:!1}),n(l)):(t.browser.loadTrack({url:i,indexURL:r}),n(l))}),u=e('<div  id="url_input_cancel" class="igv-drag-drop-cancel">'),l.$url_input_container.append(u),u.text("cancel"),u.hide(),u.on("click",function(e){n(l)});var l,c,h,u;var f,p,d,g,m,v}(this,this.$container),this.$warning=(i=e('<div class="igv-drag-drop-warning">'),r=e('<div id="warning-message">'),i.append(r),r=e('<div id="warning-dismiss">'),i.append(r),o=e('<i class="fa fa-times-circle">'),r.append(o),o.on("click",function(){i.hide()}),i.hide(),i),this.$container.append(this.$warning),this.$container.append(e('<div class="igv-drag-drop-shim">')),this.$container.append(function(){var t,i;function r(){i.removeClass("fa-times-circle"),i.addClass("fa-times")}return(i=e('<i class="fa">')).hover(function(){i.removeClass("fa-times"),i.addClass("fa-times-circle")},r),i.on("click",function(){r(),n(a)}),(t=e('<div class="igv-drag-and-drop-close-container">')).append(i),r(),t}()),this.$presentationButton=e('<div class="igv-drag-and-drop-presentation-button">'),this.$presentationButton.text("Load Track"),this.$presentationButton.on("click",function(){a.$container.is(":visible")?n(a):a.$container.show()})},t.TrackFileLoad.prototype.warnWithMessage=function(e){this.$warning.find("#warning-message").text(e),this.$warning.show()},t.TrackFileLoad.keyToIndexExtension={bam:{extension:"bai",optional:!1},any:{extension:"idx",optional:!0},gz:{extension:"tbi",optional:!0}},t.TrackFileLoad.indexExtensionToKey=i.invert(i.mapObject(t.TrackFileLoad.keyToIndexExtension,function(e){return e.extension})),t.TrackFileLoad.isIndexFile=function(e){var n;return n=t.getExtension({url:e}),i.contains(i.keys(t.TrackFileLoad.indexExtensionToKey),n)},t.TrackFileLoad.isIndexable=function(e){var n;return!t.TrackFileLoad.isIndexFile(e)&&("wig"!==(n=t.getExtension({url:e}))&&"seg"!==n)},t.TrackFileLoad.prototype.loadLocalFiles=function(e){var r,o,a,s,l,c,h,u,f,p,d,g,m,v,y,w,b,x,k,S,C,T,_,A,I,R,P,E;m=e,v=i.filter(m,function(e){return!t.TrackFileLoad.isIndexFile(e)}),r=i.size(v)>0?(y={},i.each(v,function(e){var n,r,o,a;n=e.name.split("."),"gz"===i.last(n)&&n.pop(),n.pop(),r=n.join("."),o=t.getExtension({url:e}),a=i.contains(i.keys(t.TrackFileLoad.keyToIndexExtension),o)?o:"any",y[r]={file:e,extension:o,indexExtensionLookup:a}}),y):void 0,w=e,b=i.filter(w,function(e){return t.TrackFileLoad.isIndexFile(e)}),o=i.size(b)>0?(x={},i.each(b,function(e){var t,n;t=e.name.slice(0,-4).split("."),i.size(t)>1?(t.pop(),n=t.join(".")):n=t,x[n]=e}),x):void 0,void 0===r&&void 0===o?this.warnWithMessage("ERROR: No data or index file(s) provided."):void 0===o?(u=[],i.each(r,function(e,n){!1===t.TrackFileLoad.keyToIndexExtension[e.indexExtensionLookup].optional&&u.push(n)}),f=i.difference(i.keys(r),u),(c=i.size(f)>0?i.pick(r,f):void 0)&&(a=i.map(i.pluck(c,"file"),function(e){return{url:e,indexed:!1}}),t.browser.loadTracksWithConfigList(a)),i.size(u)>0?(p=i.map(u,function(e){return r[e].file.name}).join(" and "),this.warnWithMessage("ERROR: "+p+" require an associated index file.")):n(this)):void 0===r?(d=i.map(o,function(e){return e.name}).join(" and "),d+=" require an associated data file.",this.warnWithMessage("ERROR: "+d)):(A=r,I=o,R=[],i.each(A,function(e,n){var i=void 0!==I;!1===t.TrackFileLoad.keyToIndexExtension[e.indexExtensionLookup].optional&&i&&void 0===I[n]&&R.push(n)}),E="",l=i.size(R)>0?(P=i.map(R,function(e){return A[e].file.name}),E=P.join(" and "),{missing:R,blurb:E+=" require an associated index file."}):void 0,k=r,S=o,C=[],i.each(S,function(e,t){void 0===k[t]&&C.push(t)}),_="",s=i.size(C)>0?(T=i.map(C,function(e){return S[e].name}),_=T.join(" and "),{missing:C,blurb:_+=" require an associated data file."}):void 0,p=void 0,d=l?l.blurb:void 0,g=s?s.blurb:void 0,d&&g?p=d+" "+g:d?p=d:g&&(p=g),f=l?i.difference(i.keys(r),l.missing):i.keys(r),c=i.size(f)>0?i.pick(r,f):void 0,f=s?i.difference(i.keys(o),s.missing):i.keys(o),h=i.size(f)>0?i.pick(o,f):void 0,c&&(a=i.map(i.keys(c),function(e){return h&&h[e]?{url:c[e].file,indexURL:h[e]}:{url:c[e].file,indexed:!1}}),t.browser.loadTracksWithConfigList(a)),p?this.warnWithMessage("ERROR: "+p):n(this))},t}((Ae=(ze=Ae||{},$e=new Set(["narrowpeak","broadpeak","peaks","bedgraph","wig","gff3","gff","gtf","aneu","fusionjuncspan","refflat","seg","bed","vcf","bb","bigbed","bw","bigwig","bam","tdf","refgene","genepred","genepredext"]),ze.getFormat=function(e){return void 0===ze.browser||void 0===ze.browser.formats?void 0:ze.browser.formats[e]},ze.createTrack=function(e){switch(void 0===e.type?"unknown_type":e.type.toLowerCase()){case"gwas":return new ze.GWASTrack(e);case"annotation":case"genes":case"fusionjuncspan":case"snp":return new ze.FeatureTrack(e);case"variant":return new ze.VariantTrack(e);case"alignment":return new ze.BAMTrack(e);case"data":case"wig":return new ze.WIGTrack(e);case"sequence":return new ze.SequenceTrack(e);case"eqtl":return new ze.EqtlTrack(e);case"seg":return new ze.SegTrack(e);case"aneu":return new ze.AneuTrack(e);case"merged":return new ze.MergedTrack(e);default:return}},ze.inferTrackTypes=function(e){var t;(t=e).featureType&&(t.type=t.type||t.featureType,t.featureType=void 0),"bed"===t.type?(t.type="annotation",t.format=t.format||"bed"):"bam"===t.type?(t.type="alignment",t.format="bam"):"vcf"===t.type?(t.type="variant",t.format="vcf"):"t2d"===t.type?t.type="gwas":"FusionJuncSpan"===t.type&&(t.format="fusionjuncspan"),void 0===e.sourceType&&e.url&&(e.sourceType="file"),"file"===e.sourceType&&void 0===e.format&&function(e){var t,n,i;if(e.format)e.format=e.format.toLowerCase();else if((t=(ze.isFilePath(e.url)?e.url.name:e.url).toLowerCase()).endsWith("refgene.txt.gz")||t.endsWith("refgene.txt"))e.format="refgene";else switch((n=t.indexOf("?"))>0&&(t=t.substr(0,n)),t.endsWith(".gz")&&(t=t.substr(0,t.length-3)),(t.endsWith(".txt")||t.endsWith(".tab"))&&(t=t.substr(0,t.length-4)),(i=(n=t.lastIndexOf("."))<0?t:t.substr(n+1)).toLowerCase()){case"bw":e.format="bigwig";break;case"bb":e.format="bigbed";default:$e.has(i)&&(e.format=i)}}(e),void 0===e.type&&function(e){if(!e.type&&void 0!==e.format)switch(e.format.toLowerCase()){case"bw":case"bigwig":case"wig":case"bedgraph":case"tdf":e.type="wig";break;case"vcf":e.type="variant";break;case"seg":e.type="seg";break;case"bam":e.type="alignment";break;default:e.type="annotation"}}(e)},ze.configTrack=function(e,t){e.config=t,e.url=t.url,t.name=t.name||t.label,t.name?e.name=t.name:ze.isFilePath(t.url)?e.name=t.url.name:e.name=t.url,e.id=t.id||e.name,e.order=t.order,e.color=t.color||ze.browser.constants.defaultColor||"rgb(0,0,150)",e.removable=void 0===t.removable||t.removable,e.height=t.height||100,void 0===t.autoHeight&&(t.autoHeight=t.autoheight),e.autoHeight=void 0===t.autoHeight?void 0===t.height:t.autoHeight,e.minHeight=t.minHeight||Math.min(50,e.height),e.maxHeight=t.maxHeight||Math.max(500,e.height),t.visibilityWindow&&(e.visibilityWindow=t.visibilityWindow),void 0===e.type&&(e.type=t.type)},ze.setTrackLabel=function(e,t){var n=i.first(e.trackView.viewports);e.name=t,n.$viewport.find(".igv-track-label").html(e.name),e.trackView&&e.trackView.repaint()},ze.inferIndexPath=function(e,t){var n;if(e instanceof File)throw new Error("Cannot infer an index path for a local File.  Please select explicitly");return e.includes("?")?(n=e.indexOf("?"),e.substring(0,n)+"."+t+e.substring(n)):e+"."+t},ze.paintAxis=function(e,t,n){var i,r,o,a,s,l,c,h={font:"normal 10px Arial",textAlign:"right",strokeStyle:"black"};function u(e){return 0===e?"0":Math.abs(e)>=10?e.toFixed():Math.abs(e)>=1?e.toFixed(1):e.toFixed(2)}void 0!==this.dataRange&&void 0!==this.dataRange.max&&void 0!==this.dataRange.min&&(ze.graphics.fillRect(e,0,0,t,n,{fillStyle:"rgb(255, 255, 255)"}),i=(c=.95*t)-8,s={x:r=c,y:o=a=.01*n},ze.graphics.strokeLine(e,i,o,r,a,h),ze.graphics.fillText(e,u(this.dataRange.max),i+4,o+12,h),l={x:r,y:o=a=.99*n},ze.graphics.strokeLine(e,i,o,r,a,h),ze.graphics.fillText(e,u(this.dataRange.min),i+4,o-4,h),ze.graphics.strokeLine(e,s.x,s.y,l.x,l.y,h))},ze.trackPopupMenuItemList=function(e,t,n,i,r){var o,a;return o={popover:e,viewport:t,genomicState:t.genomicState,genomicLocation:n,x:i,y:r},a=[],"function"==typeof t.trackView.track.popupMenuItemList&&(a=ze.trackMenuItemListHelper(t.trackView.track.popupMenuItemList(o))),a},ze.trackMenuItemList=function(e,t){var n,i=[];return"sequence"!==t.track.config.type&&(i.push(ze.trackMenuItem(e,t,"Set track name",function(){return"Track Name"},t.track.name,function(){var e;e=""===(e=ze.dialog.$dialogInput.val().trim())||void 0===e?"untitled":e,ze.setTrackLabel(t.track,e),t.update()},void 0)),i.push(ze.trackMenuItem(e,t,"Set track height",function(){return"Track Height"},t.trackDiv.clientHeight,function(){var e=parseFloat(ze.dialog.$dialogInput.val(),10);void 0!==e&&(void 0!==t.track.minHeight&&t.track.minHeight>e&&(t.track.minHeight=e),void 0!==t.track.maxHeight&&t.track.maxHeight<e&&(t.track.minHeight=e),t.setTrackHeight(e),t.track.autoHeight=!1)},void 0))),ze.doProvideColoSwatchWidget(t.track)&&i.push(ze.colorPickerMenuItem(e,t)),n=[],t.track.menuItemList&&(n=i.concat(ze.trackMenuItemListHelper(t.track.menuItemList(e)))),!1!==t.track.removable&&n.push(ze.trackMenuItem(e,t,"Remove track",function(){return'<div class="igv-dialog-label-centered">Remove '+t.track.name+"</div>"},void 0,function(){e.hide(),t.browser.removeTrack(t.track)},!0)),n},ze.doProvideColoSwatchWidget=function(e){return e instanceof ze.BAMTrack||e instanceof ze.FeatureTrack||e instanceof ze.VariantTrack||e instanceof ze.WIGTrack},ze.trackMenuItemListHelper=function(t){var n=[];return i.size(t)>0&&(n=i.map(t,function(t,n){var i;return t.name?(i=e("<div>")).text(t.name):i=t.object,0===n&&i.addClass("igv-track-menu-border-top"),t.click&&i.click(t.click),{object:i,init:t.init||void 0}})),n},ze.trackMenuItem=function(t,n,i,r,o,a,s){var l,c;return l=e("<div>"),!0===s&&l.addClass("igv-track-menu-border-top"),l.text(i),c=function(){var i=e(n.trackDiv);ze.dialog.configure(r,o,a,void 0,void 0),ze.dialog.show(i),t.hide()},l.click(c),{object:l,init:void 0}},ze.dataRangeMenuItem=function(t,n){var i,r;return(i=e("<div>")).text("Set data range"),r=function(){ze.dataRangeDialog.configureWithTrackView(n),ze.dataRangeDialog.show(),t.hide()},i.click(r),{object:i,init:void 0}},ze.colorPickerMenuItem=function(t,n){var i;return(i=e("<div>")).text("Set track color"),i.click(function(){n.$colorpicker_container.toggle(),t.hide()}),{object:i}},ze))||{}))||{}),(Ge=Ae||{}).AlertDialog=function(t,n){var i,r,o=this;this.$parent=t,this.$container=e("<div>",{id:n,class:"igv-grid-container-alert-dialog"}),t.append(this.$container),i=e('<div class="igv-grid-header">'),r=e('<div class="igv-grid-header-blurb">'),i.append(r),Ge.attachDialogCloseHandlerWithParent(i,function(){o.hide()}),this.$container.append(i),this.$container.append(this.alertTextContainer()),this.$container.append(this.rowOfOk())},Ge.AlertDialog.prototype.alertTextContainer=function(){var t;return t=e('<div class="igv-grid-rect">'),this.$dialogLabel=e("<div>",{class:"igv-col igv-col-4-4 igv-alert-dialog-text"}),t.append(this.$dialogLabel),t},Ge.AlertDialog.prototype.rowOfOk=function(){var t,n,i=this;return t=e('<div class="igv-grid-rect">'),n=e('<div class="igv-col igv-col-1-4">'),t.append(n),n=e('<div class="igv-col igv-col-2-4">'),this.$ok=e('<div class="igv-col-filler-ok-button">'),this.$ok.text("OK"),this.$ok.unbind(),this.$ok.click(function(){i.hide()}),n.append(this.$ok),t.append(n),t},Ge.AlertDialog.prototype.hide=function(){this.$container.hasClass("igv-grid-container-dialog")&&this.$container.offset({left:0,top:0}),this.$container.hide()},Ge.AlertDialog.prototype.show=function(e){var t,n;t={left:((n=e||this.$parent).width()-this.$container.width())/2,top:(n.height()-this.$container.height())/2},this.$container.css(t),this.$container.show()},Ae=Ge,(Ue=Ae||{}).CenterGuide=function(t,n){var i=this;this.$container=e('<div class="igv-center-guide igv-center-guide-thin">'),t.append(this.$container),!0===n.showCenterGuide?this.$container.show():this.$container.hide(),this.$centerGuideToggle=Ue.makeToggleButton("center line","center line","showCenterGuide",function(){return i.$container},function(){i.repaint()})},Ue.CenterGuide.prototype.repaint=function(){var e,t,n,i,r,o,a,s;void 0!==Ue.browser.genomicStateList&&(1/(s=Ue.browser.genomicStateList[0].referenceFrame).bpPerPixel>1?(e=(a=Ue.browser.syntheticViewportContainerBBox()).position,t=.5*a.width,i=e.left+t-.5*(n=s.toPixels(1)),r=Math.round(i).toString()+"px",o=Math.round(n).toString()+"px",this.$container.css({left:r,width:o}),this.$container.removeClass("igv-center-guide-thin"),this.$container.addClass("igv-center-guide-wide")):(this.$container.css({left:"50%",width:"1px"}),this.$container.removeClass("igv-center-guide-wide"),this.$container.addClass("igv-center-guide-thin")))},Ue.CenterGuide.prototype.resize=function(){this.repaint()},Ae=Ue,(We=Ae||{}).ChromosomeSelectWidget=function(t,n){this.$container=e("<div>",{class:"igv-chromosome-select-widget-container"}),n.append(this.$container),this.$select=e("<select>",{name:"chromosome-select-widget"}),this.$container.append(this.$select),this.$select.on("change",function(){t.search(e(this).val())})},We.ChromosomeSelectWidget.prototype.update=function(t){var n,r=this;this.$select.empty(),(n=t.chromosomeNames.slice()).unshift("all"),i.each(n,function(t){var n;n=e("<option>",{value:t}),r.$select.append(n),n.text(t)})},Ae=We,(Ve=Ae||{}).DataRangeDialog=function(t){var n,i,r,o,a,s,l,c=this;this.container=e('<div class="igv-grid-container-dialog">'),t.append(this.container),this.header=e('<div class="igv-grid-header">'),this.container.append(this.header),this.headerBlurb=e('<div class="igv-grid-header-blurb">'),this.header.append(this.headerBlurb),Ve.attachDialogCloseHandlerWithParent(this.header,function(){c.hide()}),c.container.append((r=e('<div class="igv-grid-rect">'),n=e('<div class="igv-grid-dialog">'),i=e('<div class="spacer10">'),n.append(i),i=e('<div class="igv-col igv-col-3-8">'),c.minLabel=e('<div class="igv-data-range-input-label">'),c.minLabel.text("Minimum"),i.append(c.minLabel),n.append(i),i=e('<div class="igv-col igv-col-3-8">'),c.minInput=e('<input class="igv-data-range-input" type="text" value="125">'),i.append(c.minInput),n.append(i),r.append(n),n=e('<div class="igv-grid-dialog">'),i=e('<div class="igv-col igv-col-3-8">'),c.maxLabel=e('<div class="igv-data-range-input-label">'),c.maxLabel.text("Maximum"),i.append(c.maxLabel),n.append(i),i=e('<div class="igv-col igv-col-3-8">'),c.maxInput=e('<input class="igv-data-range-input" type="text" value="250">'),i.append(c.maxInput),n.append(i),r.append(n),r)),c.container.append((a=e('<div class="igv-grid-dialog">'),s=e('<div class="igv-col igv-col-1-8">'),a.append(s),s=e('<div class="igv-col igv-col-3-8">'),c.ok=e('<div class="igv-col-filler-ok-button">'),c.ok.text("OK"),s.append(c.ok),a.append(s),s=e('<div class="igv-col igv-col-3-8">'),(l=e('<div class="igv-col-filler-cancel-button">')).text("Cancel"),l.click(function(){c.hide()}),s.append(l),a.append(s),s=e('<div class="igv-col igv-col-1-8">'),a.append(s),(o=e('<div class="igv-grid-rect">')).append(a),o)),this.container.draggable({handle:this.header.get(0)})},Ve.DataRangeDialog.prototype.configureWithTrackView=function(t){var n,i,r,o=this;this.trackView=t,(n=this.trackView.dataRange())?(i=n.min,r=n.max):(i=0,r=100),this.minInput.val(i),this.maxInput.val(r),this.ok.unbind(),this.ok.click(function(){i=parseFloat(o.minInput.val()),r=parseFloat(o.maxInput.val()),isNaN(i)||isNaN(r)?Ve.presentAlert("Must input numeric values",void 0):(!0===t.track.autoscale&&e("#datarange-autoscale").trigger("click"),t.setDataRange(i,r,!1)),o.hide()})},Ve.DataRangeDialog.prototype.hide=function(){this.container.offset({left:0,top:0}),this.container.hide()},Ve.DataRangeDialog.prototype.show=function(){var t=e("body").scrollTop(),n=e(this.trackView.trackDiv).offset(),i=e(this.trackView.trackDiv).outerWidth();e(this.trackView.trackDiv).outerHeight(),this.container.show(),this.container.offset({left:i-300,top:n.top+t}),this.container.offset(Ve.constrainBBox(this.container,e(Ve.browser.trackContainerDiv)))},Ae=Ve,Ae=function(t){function n(e,n){var i,r,o,a=n.genomicState.referenceFrame;if(r=t.translateMouseCoordinates(e,n.canvas),void 0!==(i=Math.floor(a.start+a.toBP(r.x)))&&null!==n.tile)return o=Math.round(a.toPixels(n.tile.startBP-a.start)),{genomicLocation:i,x:r.x-o,y:r.y}}function r(t,n,i){var r,o,a=t,s=e(window).width(),l=(e(window).height(),t),c=n;return r=l-=i.$parent.offset().left,a+(o={x:l,y:c-=i.$parent.offset().top,width:i.$popover.outerWidth(),height:i.$popover.outerHeight()}).width>s&&(r=l-o.width),{left:r+"px",top:c+"px"}}return t.Popover=function(e){this.$parent=this.initializationHelper(e)},t.Popover.prototype.initializationHelper=function(n){var i,r=this;return this.$popover=e('<div class="igv-popover">'),n.append(this.$popover),i=e('<div class="igv-popover-header">'),this.$popover.append(i),t.attachDialogCloseHandlerWithParent(i,function(){r.hide()}),this.$popoverContent=e("<div>"),this.$popover.append(this.$popoverContent),this.$popover.draggable({handle:i.get(0)}),n},t.Popover.prototype.hide=function(){this.$popover.hide()},t.Popover.prototype.presentTrackGearMenu=function(n,o,a){var s,l;l=t.trackMenuItemList(this,a),i.size(l)>0&&(this.$popoverContent.empty(),this.$popoverContent.removeClass("igv-popover-track-popup-content"),s=e('<div class="igv-track-menu-container">'),this.$popoverContent.append(s),i.each(l,function(e){e.init&&e.init(),s.append(e.object)}),this.$popover.css(r(n,o,this)),this.$popover.show(),this.$popover.offset(t.constrainBBox(this.$popover,e(t.browser.trackContainerDiv))))},t.Popover.prototype.presentTrackPopupMenu=function(o,a){var s,l,c;a.trackView.track;void 0!==(s=n(o,a))&&(c=t.trackPopupMenuItemList(this,a,s.genomicLocation,s.x,s.y),i.size(c)>0&&(this.$popoverContent.empty(),this.$popoverContent.removeClass("igv-popover-track-popup-content"),l=e('<div class="igv-track-menu-container">'),this.$popoverContent.append(l),i.each(c,function(e){l.append(e.object)}),this.$popover.css(r(o.pageX,o.pageY,this)),this.$popover.show()))},t.Popover.prototype.presentTrackPopup=function(e,r){var o,a,s,l,c,h=r.trackView.track;r.genomicState.referenceFrame;void 0!==(o=n(e,r))&&(c={popover:this,viewport:r,genomicLocation:o.genomicLocation,x:o.x,y:o.y},a=h.popupData(c),void 0===(s=t.browser.fireEvent("trackclick",[h,a]))?i.size(a)>0&&(l=t.formatPopoverText(a)):"string"==typeof s&&(l=s),this.presentContent(e.pageX,e.pageY,l))},t.Popover.prototype.presentContent=function(t,n,i){var o;void 0!==i&&(this.$popoverContent.empty(),this.$popoverContent.addClass("igv-popover-track-popup-content"),o=e('<div class="igv-track-menu-container">'),this.$popoverContent.append(o),this.$popoverContent.html(i),this.$popover.css(r(t,n,this)),this.$popover.show())},t}((Ae=((qe=Ae||{}).Dialog=function(t,n){var i,r,o=this;this.$container=e('<div class="igv-grid-container-dialog">'),t.append(this.$container[0]),i=e('<div class="igv-grid-header">'),r=e('<div class="igv-grid-header-blurb">'),i.append(r[0]),this.$container.append(i[0]),n(this),this.$container.draggable({handle:i.get(0)}),qe.attachDialogCloseHandlerWithParent(i,function(){o.hide()})},qe.Dialog.dialogConstructor=function(e){e.$container.append(e.rowOfLabel()[0]),e.$container.append(e.rowOfInput()[0]),e.$container.append(e.rowOfOkCancel()[0])},qe.Dialog.prototype.rowOfOk=function(){var t,n,i,r;return n=e('<div class="igv-grid-dialog">'),i=e('<div class="igv-col igv-col-1-4">'),n.append(i[0]),i=e('<div class="igv-col igv-col-2-4">'),(r=e('<div class="igv-col-filler-ok-button">')).text("OK"),this.$ok=r,i.append(r[0]),n.append(i[0]),(t=e('<div class="igv-grid-rect">')).append(n[0]),t},qe.Dialog.prototype.rowOfOkCancel=function(){var t,n,i,r,o=this;return n=e('<div class="igv-grid-dialog">'),i=e('<div class="igv-col igv-col-1-8">'),n.append(i[0]),i=e('<div class="igv-col igv-col-3-8">'),(r=e('<div class="igv-col-filler-ok-button">')).text("OK"),this.$ok=r,i.append(r[0]),n.append(i[0]),i=e('<div class="igv-col igv-col-3-8">'),(r=e('<div class="igv-col-filler-cancel-button">')).text("Cancel"),r.click(function(){o.$dialogInput.val(void 0),o.hide()}),i.append(r[0]),n.append(i[0]),i=e('<div class="igv-col igv-col-1-8">'),n.append(i[0]),(t=e('<div class="igv-grid-rect">')).append(n[0]),t},qe.Dialog.prototype.rowOfLabel=function(){var t,n,i;return n=e('<div class="igv-grid-dialog">'),i=e('<div class="igv-col igv-col-4-4">'),this.$dialogLabel=e('<div class="igv-user-input-label">'),i.append(this.$dialogLabel[0]),n.append(i[0]),(t=e('<div class="igv-grid-rect">')).append(n[0]),t},qe.Dialog.prototype.rowOfInput=function(){var t,n,i;return n=e('<div class="igv-grid-dialog">'),i=e('<div class="igv-col igv-col-4-4">'),this.$dialogInput=e('<input class="igv-user-input-dialog" type="text" value="#000000">'),i.append(this.$dialogInput[0]),n.append(i[0]),(t=e('<div class="igv-grid-rect">')).append(n[0]),t},qe.Dialog.prototype.configure=function(e,t,n){var i=this;e?(i.$dialogLabel.html(e()),i.$dialogLabel.show()):i.$dialogLabel.hide(),void 0!==t?(i.$dialogInput.val(t),i.$dialogInput.unbind(),i.$dialogInput.change(function(){n&&n(),i.hide()}),i.$dialogInput.show()):i.$dialogInput.hide(),i.$ok.unbind(),i.$ok.click(function(){n&&n(),i.hide()})},qe.Dialog.prototype.hide=function(){this.$container.hasClass("igv-grid-container-dialog")&&this.$container.offset({left:0,top:0}),this.$container.hide()},qe.Dialog.prototype.show=function(t){var n,i,r;n=e("body").scrollTop(),this.$container.hasClass("igv-grid-container-dialog")&&(i=t.offset().top+n,r=t.outerWidth()-300,this.$container.offset({left:r,top:i})),this.$container.show()},qe))||{}),(je=Ae||{}).TrackMenuPopupDialog=function(t,n,i,r,o,a){var s,l,c,h=this;c='<div id="dialog-form" title="DIALOG_LABEL"><p class="validateTips"></p><form><fieldset><input type="text" name="name" id="name" value="INPUT_VALUE"></fieldset></form></div>',s=new RegExp("DIALOG_LABEL","g"),c=c.replace(s,n),l=new RegExp("INPUT_VALUE","g"),c=c.replace(l,i),e("body").append(e.parseHTML(c)),this.dialogForm=e("#dialog-form"),this.form=this.dialogForm.find("form"),this.name=e("#name"),this.tips=e(".validateTips"),this.dialogForm.dialog({autoOpen:!1,width:o||320,height:a||256,modal:!0,buttons:{ok:r,cancel:function(){h.dialogForm.dialog("close")}},close:function(){h.form[0].reset(),h.dialogForm.remove(),h.dialogForm=void 0,t&&t.hide()}}),this.form.on("submit",function(t){t.preventDefault(),e("#users").find(" tbody").append("<tr><td>"+h.name.val()+"</td></tr>"),h.dialogForm.dialog("close")})},je.TrackMenuPopupDialog.prototype.updateTips=function(e){var t=this;this.tips.text(e).addClass("ui-state-highlight"),setTimeout(function(){t.tips.removeClass("ui-state-highlight",1500)},500)},Ae=je,Ae=function(t){t.Viewport=function(n,r,o){var a,s,l,c,h,u,f,p=this;this.trackView=n,this.id=i.uniqueId("viewport_"),this.genomicState=o,this.$viewport=e('<div class="igv-viewport-div">'),r.append(this.$viewport),this.$viewport.data("viewport",this.id),this.$viewport.data("locusindex",this.genomicState.locusIndex),function(e,t,n){if(1===n||t===n-1)return;e.addClass("igv-viewport-div-border-right")}(this.$viewport,this.genomicState.locusIndex,t.browser.genomicStateList.length),this.setWidth(t.browser.viewportContainerWidth()/this.genomicState.locusCount),this.contentDiv=e('<div class="igv-viewport-content-div">')[0],this.$viewport.append(this.contentDiv),n.track instanceof t.SequenceTrack&&this.$viewport.addClass("igv-viewport-sequence"),n.track instanceof t.RulerTrack&&(h=e("<div>",{class:"igv-whole-genome-container"}),e(this.contentDiv).append(h),h.hide()),this.genomicState.locusCount>1&&n.track instanceof t.RulerTrack&&(this.$viewport.addClass("igv-viewport-ruler"),this.$close=e('<div class="igv-viewport-fa-close">'),this.$closeButton=e('<i class="fa fa-times-circle">'),this.$close.append(this.$closeButton),this.$close.click(function(e){t.browser.closeMultiLocusPanelWithGenomicState(p.genomicState)}),this.$viewport.append(this.$close)),this.canvas=e("<canvas>")[0],e(this.contentDiv).append(this.canvas),this.canvas.setAttribute("width",this.contentDiv.clientWidth),this.canvas.setAttribute("height",this.contentDiv.clientHeight),this.ctx=this.canvas.getContext("2d"),this.genomicState.locusCount>1&&n.track instanceof t.RulerTrack&&e(this.contentDiv).append(t.browser.rulerTrack.locusLabelWithGenomicState(this.genomicState)),void 0===n.track.visibilityWindow&&n.track.supportsWholeGenome||(p.$zoomInNotice=((f=e("<div>")).text("Zoom in to see features"),(u=e('<div class="zoom-in-notice-container">')).append(f),u.hide(),u),e(this.contentDiv).append(p.$zoomInNotice)),n.track.name&&0===this.genomicState.locusIndex&&(a="function"==typeof n.track.description?n.track.description():n.track.description||n.track.name,(s=e('<div class="igv-track-label">')).html(n.track.name),s.click(function(e){p.popover.presentContent(e.pageX,e.pageY,a)}),this.$viewport.append(s),t.browser.$trackLabelToggle.hasClass("igv-nav-bar-toggle-button-on")&&s.hide()),n.track instanceof t.RulerTrack||(this.addMouseHandlers(),(c=this.$viewport.height())>32&&(c=32),(l=e('<div class="igv-viewport-spinner">')).css({"font-size":c+"px"}),l.append(e('<i class="fa fa-spinner fa-spin fa-fw">')),this.$viewport.append(l),this.stopSpinner(),this.popover=new t.Popover(t.browser.$content))},t.Viewport.prototype.setWidth=function(e){var t;this.$viewport.width(e),t=this.$viewport.width()/this.$viewport.outerWidth(),this.$viewport.width(Math.floor(t*e))},t.Viewport.prototype.goto=function(e,n,i){t.popover&&t.popover.hide(),this.genomicState.referenceFrame.bpPerPixel=(Math.round(i)-Math.round(n))/this.$viewport.width(),this.genomicState.referenceFrame.start=Math.round(n),t.browser.updateWithLocusIndex(this.genomicState.locusIndex)},t.Viewport.prototype.startSpinner=function(){var e=this.$viewport.find(".fa-spinner");e.addClass("fa-spin"),e.show()},t.Viewport.prototype.stopSpinner=function(){var e=this.$viewport.find(".fa-spinner");e.hide(),e.removeClass("fa-spin")},t.Viewport.prototype.resize=function(){var e=t.browser.viewportContainerWidth()/this.genomicState.locusCount;e>0&&(this.setWidth(e),this.canvas.style.width=this.$viewport.width()+"px",this.canvas.setAttribute("width",this.$viewport.width()),this.update())},t.Viewport.prototype.update=function(){this.tile&&(this.tile.invalidate=!0),this.repaint()},t.Viewport.prototype.repaint=function(){var i,o,a,s,l,c,h,u,f,p=this,d=p.genomicState,g=d.referenceFrame;if(function(){return t.browser&&t.browser.genomicStateList&&t.browser.genomicStateList[p.genomicState.locusIndex].referenceFrame}.call(this)){if(this.$zoomInNotice&&void 0!==this.trackView.track.visibilityWindow&&this.trackView.track.visibilityWindow>0){if(g.bpPerPixel*this.$viewport.width()>this.trackView.track.visibilityWindow||"all"===g.chrName.toLowerCase()&&!this.trackView.track.supportsWholeGenome)return this.tile=null,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),p.stopSpinner(),void this.$zoomInNotice.show();this.$zoomInNotice.hide()}if(l=g.chrName,c=g.start,h=c+g.toBP(this.canvas.width),this.paintImage(l,c,h,g.bpPerPixel),!this.tile||this.tile.invalidate||!this.tile.containsRange(l,c,h,g.bpPerPixel)){var m=t.browser.genome.getChromosome(l).bpLength;if(i=3*this.canvas.width,o=g.toBP(i),a=Math.floor(Math.max(0,g.start-o/3)),s=Math.ceil(Math.min(m,a+o)),i=(s-a)/g.bpPerPixel,p.loading&&p.loading.start===a&&p.loading.end===s)return;p.loading={start:a,end:s},p.startSpinner(),function(e,t,n,i){var o=this;{if(o.cachedFeatures&&o.cachedFeatures.containsRange(e,t,n,i))return Promise.resolve(o.cachedFeatures.features);if("function"==typeof o.trackView.track.getFeatures)return o.trackView.track.getFeatures(e,t,n,i).then(function(a){return o.cachedFeatures=new r(e,t,n,i,a),a}).catch(function(e){console.log(e)});Promise.resolve(void 0)}}.call(p,g.chrName,a,s,g.bpPerPixel).then(function(n){var r,o,l,c,h;return p.loading=void 0,p.stopSpinner(),n&&"function"==typeof p.trackView.track.computePixelHeight&&(r=p.trackView.track.computePixelHeight(n))!==e(p.contentDiv).height()&&p.trackView.setContentHeightForViewport(p,r),(f=document.createElement("canvas")).width=i,f.height=p.canvas.height,u={features:n,context:f.getContext("2d"),pixelWidth:f.width,pixelHeight:f.height,bpStart:a,bpEnd:s,bpPerPixel:g.bpPerPixel,referenceFrame:g,genomicState:d,selection:p.selection,viewport:p,viewportWidth:p.$viewport.width(),viewportContainerX:d.referenceFrame.toPixels(d.referenceFrame.start-a),viewportContainerWidth:t.browser.viewportContainerWidth()},n&&(u.features=n,p.trackView.track.draw(u),"function"==typeof(h=p.trackView).track.paintAxis&&h.controlCanvas.width>0&&h.controlCanvas.height>0&&(l=p.trackView,(c=document.createElement("canvas")).width=l.controlCanvas.width,c.height=l.controlCanvas.height,l.track.paintAxis(c.getContext("2d"),c.width,c.height),l.controlCtx.drawImage(c,0,0))),t.browser.roi?(o=[],t.browser.roi.forEach(function(e){o.push(e.getFeatures(g.chrName,a,s))}),Promise.all(o)):void 0}).then(function(e){var n,i;if(e)for(n=0,i=e.length;n<i;n++)u.features=e[n],t.browser.roi[n].draw(u)}).then(function(e){p.tile=new n(g.chrName,a,s,g.bpPerPixel,f),p.paintImage(l,c,h,g.bpPerPixel)}).catch(function(e){console.error(e),p.stopSpinner(),p.loading=!1,t.presentAlert(e,void 0)})}}},t.Viewport.prototype.setContentHeight=function(t){t=Math.min(t,32e3),this.trackView.track.minHeight&&(t=Math.max(this.trackView.track.minHeight,t)),this.trackView.track.autoHeight&&function(t,n){(1===this.genomicState.locusCount||t>e(this.trackView.trackDiv).height())&&(this.trackView.track.minHeight&&(t=Math.max(this.trackView.track.minHeight,t)),this.trackView.track.maxHeight&&(t=Math.min(this.trackView.track.maxHeight,t)),console.log("set trackView height "+this.trackView.track.id+" locus index "+this.genomicState.locusIndex+" requested / current "+t+" / "+e(this.trackView.trackDiv).height()),this.trackView.track.height=t,e(this.trackView.trackDiv).height(t),this.trackView.track.paintAxis&&(e(this.trackView.controlCanvas).height(t),this.trackView.controlCanvas.setAttribute("height",t)),this.$viewport.height(t),void 0!==n&&!0!==n||this.update())}.call(this,t,!1),e(this.contentDiv).height(t),e(this.canvas).height(t),this.canvas.setAttribute("height",t),this.trackView.track.paintAxis&&(e(this.trackView.controlCanvas).height(t),this.trackView.controlCanvas.setAttribute("height",t))},t.Viewport.prototype.paintImage=function(e,t,n,i){var r,o,a,s,l,c,h=this.tile;if(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),h&&h.containsRange(e,t,n,i))this.xOffset=Math.round((h.startBP-t)/h.bpPerPixel),this.ctx.drawImage(h.image,this.xOffset,0),this.ctx.save(),this.ctx.restore();else if(h&&h.overlapsRange(e,t,n)){var u;(u=Math.round((t-h.startBP)/h.bpPerPixel))>0?(r=u,o=0):(r=0,o=-u),l=h.image.width,i===h.bpPerPixel?s=l:(a=i/h.bpPerPixel,s=Math.round(a*l)),c=h.image.height,this.ctx.drawImage(h.image,r,0,s,c,o,0,l,c),this.ctx.save(),this.ctx.restore()}},t.Viewport.prototype.isLoading=function(){return!(void 0===this.loading)},t.Viewport.prototype.addMouseHandlers=function(){var n,r,o,a,s,l,c,h,u=this;function f(e){e.preventDefault(),!0===o&&(t.browser.fireEvent("trackdragend"),o=!1),r=!1,s=a=void 0,n=void 0}n=a=s=void 0,r=o=!1,this.$viewport.on("mousedown.viewport.pan",function(e){var i;e.preventDefault(),t.popover&&t.popover.hide(),r=!0,i=t.translateMouseCoordinates(e,u.$viewport.get(0)),s=a=i.x,n=u.genomicState.referenceFrame}),this.$viewport.on("mousemove.viewport.pan",t.throttle(function(e){var l,c;if(e.preventDefault(),l=t.translateMouseCoordinates(e,u.$viewport.get(0)),n&&!0===r){if(s&&Math.abs(l.x-s)>t.browser.constants.dragThreshold){if(t.browser.loadInProgress())return;o=!0,n.shiftPixels(a-l.x),n.start=Math.max(0,n.start),c=t.browser.genome.getChromosome(n.chrName).bpLength-u.$viewport.width()*n.bpPerPixel,n.start>c&&(n.start=c),t.browser.updateLocusSearchWidget(i.first(t.browser.genomicStateList)),t.browser.repaintWithLocusIndex(u.genomicState.locusIndex),t.browser.fireEvent("trackdrag")}a=l.x}},10)),this.$viewport.on("mouseup.viewport.pan",f),this.$viewport.on("mouseleave.viewport.pan",f),e(u.canvas).on("mousedown.viewport.canvas",function(e){e.preventDefault(),l=t.translateMouseCoordinates(e,u.canvas).x,console.log("canvas x "+l)}),c=0,e(u.canvas).on("click.viewport.canvas",function(e){var n,i,r,o,a,s,f,p;e.preventDefault(),console.log("click.viewport.canvas"),n=t.translateMouseCoordinates(e,u.canvas).x,i=u.genomicState.referenceFrame,r=Math.floor(i.start+i.toBP(n)),(o=Date.now())-c<t.browser.constants.doubleClickDelay?(h&&(window.clearTimeout(h),h=void 0),t.browser.minimumBasesExtent()>Math.floor(u.$viewport.width()*i.bpPerPixel/2)||(a=Math.round(i.start+n*i.bpPerPixel),"all"===i.chrName.toLowerCase()?(p=t.browser.genome.getChromosomeCoordinate(a).chr,1===u.genomicState.locusCount?s=p:((f=t.browser.genomicStateList.map(function(e){return e.locusSearchString}))[u.genomicState.locusIndex]=p,s=f.join(" ")),t.browser.search(s)):(i.bpPerPixel/=2,i.start=Math.round((a+i.start)/2),t.browser.updateWithLocusIndex(u.genomicState.locusIndex)))):e.shiftKey&&"function"==typeof u.trackView.track.shiftClick?u.trackView.track.shiftClick(r,e):e.altKey?u.popover.presentTrackPopupMenu(e,u):Math.abs(n-l)<=t.browser.constants.dragThreshold&&u.trackView.track.popupData&&(h=window.setTimeout(function(){u.popover.presentTrackPopup(e,u),l=void 0,h=void 0},t.browser.constants.doubleClickDelay)),l=void 0,c=o})},t.Viewport.viewportWidthAtLocusIndex=function(e){return t.Viewport.viewportsWithLocusIndex(e)[0].$viewport.width()},t.Viewport.viewportsWithLocusIndex=function(e){var n=[];return t.browser.trackViews.forEach(function(t){t.viewports.forEach(function(t){e===t.genomicState.locusIndex&&n.push(t)})}),n},t.Viewport.viewportWithID=function(e){var n=void 0;return t.browser.trackViews.forEach(function(t){void 0===n&&t.viewports.forEach(function(t){e===t.id&&(n=t)})}),n};var n=function(e,t,n,i,r){this.chr=e,this.startBP=t,this.endBP=n,this.bpPerPixel=i,this.image=r};n.prototype.containsRange=function(e,t,n,i){return this.bpPerPixel===i&&t>=this.startBP&&n<=this.endBP&&e===this.chr},n.prototype.overlapsRange=function(e,t,n){return this.chr===e&&n>=this.startBP&&t<=this.endBP};var r=function(e,t,n,i,r){this.chr=e,this.startBP=t,this.endBP=n,this.bpPerPixel=i,this.features=r};return r.prototype.containsRange=function(e,t,n,i){return this.bpPerPixel===i&&t>=this.startBP&&n<=this.endBP&&e===this.chr},t}((Ae=function(e){function t(e){var t,n={genotypeIndex:-1,fields:e};for(t=0;t<e.length;t++)"GT"===e[t]&&(n.genotypeIndex=t);return n}return e.VcfParser=function(e){this.type=e},e.VcfParser.prototype.parseHeader=function(t){var n,i,r,o,a,s,l,c,h,u={};if(!(r=(n=e.getDataWrapper(t)).nextLine()).startsWith("##fileformat"))throw new Error("Invalid VCF file: missing fileformat line");for(u.version=r.substr(13);(r=n.nextLine())&&r.startsWith("#");)if(a=null,s={},r.startsWith("##")){if(r.startsWith("##INFO")||r.startsWith("##FILTER")||r.startsWith("##FORMAT")){if(l=r.indexOf("<"),c=r.lastIndexOf(">"),!(l>2&&c>0)){console.log("Malformed VCF header line: "+r);continue}u[h=r.substring(2,l-1)]||(u[h]={}),(i=e.splitStringRespectingQuotes(r.substring(l+1,c-1),",")).forEach(function(e){var t=e.split("=");t.length>1&&("ID"===t[0]?a=t[1]:s[t[0]]=t[1])}),a&&(u[h][a]=s)}}else if(r.startsWith("#CHROM")&&(i=r.split("\t")).length>8)for(u.callSets=[],o=9;o<i.length;o++)u.callSets.push({id:o,name:i[o]});return this.header=u,u},e.VcfParser.prototype.parseFeatures=function(n){var i,r,o,a,s,l,c,h=[],u=this.header.callSets;for(i=e.getDataWrapper(n);r=i.nextLine();)if(!r.startsWith("#")&&(a=r.split("\t")).length>=8){if((o=e.createVCFVariant(a)).isRefBlock())continue;if(o.header=this.header,h.push(o),a.length>9)for(s=t(a[8].split(":")),o.calls={},l=9;l<a.length;l++){c=a[l];var f=u[l-9],p={callSetName:f.name,info:{}};o.calls[f.id]=p,c.split(":").forEach(function(e,t){switch(t){case s.genotypeIndex:p.genotype=[],e.split(/[\|\/]/).forEach(function(e){p.genotype.push(parseInt(e))});break;default:p.info[s.fields[t]]=e}})}}return h},e}((Ae=function(t){var n=1e5,r="ASC",o=["rgb(150,150,150)","rgb(255,0,0)","rgb(255,255,0)","rgb(0,0,255)","rgb(0,255,0)","rgb(128,0,128)"];function a(){var e=0,t=this.callSets;return Object.keys(t).forEach(function(n){t[n]&&(e+=t[n].length)}),e}function s(e,t,n){return n=n<=0?0:1,e.genotype[n]>0?t.alleles[e.genotype[n]-1]:t.referenceBases}function l(e,t,n){var i="DESC"===n?1:-1;Object.keys(e).forEach(function(n){e[n].sort(function(e,n){var r=isNaN(t.calls[e.id].genotype[0]),o=isNaN(t.calls[n.id].genotype[0]);if(r&&o)return 0;if(r)return 1;if(o)return-1;var a=s(t.calls[e.id],t,0),l=s(t.calls[e.id],t,1),c=s(t.calls[n.id],t,0),h=s(t.calls[n.id],t,1),u=Math.max(c.length,h.length)-Math.max(a.length,l.length);return 0===u&&(u=Math.min(c.length,h.length)-Math.min(a.length,l.length)),i*u})})}return t.VariantTrack=function(e){this.visibilityWindow=void 0===e.visibilityWindow?"compute":e.visibilityWindow,t.configTrack(this,e),this.displayMode=e.displayMode||"EXPANDED",this.labelDisplayMode=e.labelDisplayMode,this.variantHeight=e.variantHeight||10,this.squishedCallHeight=e.squishedCallHeight||1,this.expandedCallHeight=e.expandedCallHeight||10,this.expandedVGap=void 0!==e.expandedVGap?e.expandedVGap:2,this.squishedVGap=void 0!==e.squishedVGap?e.squishedVGap:1,this.expandedGroupGap=e.expandedGroupGap||10,this.squishedGroupGap=e.squishedGroupGap||5,this.featureHeight=e.featureHeight||14,this.featureSource=new t.FeatureSource(e),this.homrefColor=e.homrefColor||"rgb(200, 200, 200)",this.homvarColor=e.homvarColor||"rgb(17,248,254)",this.hetvarColor=e.hetvarColor||"rgb(34,12,253)",this.nRows=1,this.groupBy="NONE"},t.VariantTrack.prototype.getFileHeader=function(){var e=this;return"function"==typeof e.featureSource.getFileHeader?e.featureSource.getFileHeader().then(function(t){return t&&(t.name&&!e.config.name&&(e.name=t.name),t.color&&!e.config.color&&(e.color="rgb("+t.color+")"),e.callSets={},e.callSetGroups=["NONE"],e.callSets.NONE=t.callSets,t.features||"compute"!==e.visibilityWindow||function(){if(this.callSets){var e=a.call(this);this.visibilityWindow=e<10?n:1e3+2500/e*40}else this.visibilityWindow=n;this.featureSource.visibilityWindow=this.visibilityWindow}.call(e)),t}):Promise.resolve(null)},t.VariantTrack.prototype.getFeatures=function(e,t,n){return this.featureSource.getFeatures(e,t,n)},t.VariantTrack.prototype.computePixelHeight=function(e){var t,n,i=this.callSets,r=i?a.call(this):0,o="EXPANDED"===this.displayMode?this.expandedCallHeight:this.squishedCallHeight,s="EXPANDED"===this.displayMode?this.expandedVGap:this.squishedVGap,l="EXPANDED"===this.displayMode?this.expandedGroupGap:this.squishedGroupGap,c=Object.keys(i).length*l;if("COLLAPSED"===this.displayMode)return this.nRows=1,10+this.variantHeight;var h=0;return e&&"function"==typeof e.forEach&&e.forEach(function(e){e.row&&e.row>h&&(h=e.row)}),n=10+(t=h+1)*(this.variantHeight+s),this.nRows=t,n+s+c+r*(o+s)},t.VariantTrack.prototype.draw=function(e){var n,i,r,l,c,h,u,f,p,d,g,m,v,y,w,b,x,k,S,C,T,_,A=e.features,I=e.context,R=e.bpPerPixel,P=e.bpStart,E=e.pixelWidth,L=e.pixelHeight,M=P+E*R+1,D="EXPANDED"===this.displayMode?this.expandedCallHeight:this.squishedCallHeight,F="EXPANDED"===this.displayMode?this.expandedVGap:this.squishedVGap,B="EXPANDED"===this.displayMode?this.expandedGroupGap:this.squishedGroupGap;if(this.variantBandHeight=10+this.nRows*(this.variantHeight+F),w=this.callSets,b=a.call(this),t.graphics.fillRect(I,0,0,E,L,{fillStyle:"rgb(255, 255, 255)"}),w&&b>0&&"COLLAPSED"!==this.displayMode&&t.graphics.strokeLine(I,0,this.variantBandHeight,E,this.variantBandHeight,{strokeStyle:"rgb(224,224,224) "}),A){for(h=0,_=A.length;h<_;h++)if(!((u=A[h]).end<P)){if(u.start>M)break;if(l=10+("COLLAPSED"===this.displayMode?0:u.row*(this.variantHeight+F)),c=this.variantHeight,n=Math.round((u.start-P)/R),i=Math.round((u.end-P)/R),(r=Math.max(1,i-n))<3?(r=3,n-=1):r>5&&(n+=1,r-=2),"str"===u.type?I.fillStyle=O(u):I.fillStyle=this.color,I.fillRect(n,l,r,c),b>0&&u.calls&&"COLLAPSED"!==this.displayMode)for(c=D,"str"===u.type&&(S=new t.GradientColorScale({low:u.minAltLength,lowR:135,lowG:206,lowB:250,high:u.referenceBases.length,highR:150,highG:150,highB:150}),C=new t.GradientColorScale({low:u.referenceBases.length,lowR:150,lowG:150,lowB:150,high:u.maxAltLength,highR:255,highG:69,highB:0})),T=0,d=0;d<this.callSetGroups.length;d++)for(m=w[this.callSetGroups[d]],g=0;g<m.length;g++)p=m[g],(f=u.calls[p.id])&&(l=this.variantBandHeight+F+(T+u.row)*(c+F)+d*B,"str"===u.type?isNaN(f.genotype[0])?I.strokeStyle="#B0B0B0":(x=s(f,u,0),k=s(f,u,1),I.fillStyle=N(x),I.fillRect(n,l,r,c/2),I.fillStyle=N(k),I.fillRect(n,l+c/2,r,c/2),"EXPANDED"===this.displayMode&&(I.beginPath(),I.moveTo(n,l+c/2),I.lineTo(n+r,l+c/2),I.strokeStyle="#000",I.stroke())):(y=v=!0,f.genotype.forEach(function(e){0!=e&&(v=!1),0==e&&(y=!1)}),I.fillStyle=v?this.homrefColor:y?this.homvarColor:this.hetvarColor,I.fillRect(n,l,r,c))),T++}}else console.log("No feature list");function N(e){return e.length<u.referenceBases.length?S.getColor(e.length):e.length>u.referenceBases.length?C.getColor(e.length):"rgb(150,150,150)"}function O(e){var t,n=0;return e.info.PERIOD&&(t=parseInt(e.info.PERIOD),n=Math.max(0,Math.min(t,o.length-1))),o[n]}},t.VariantTrack.prototype.altClick=function(e,t,n){var i=t.chrName,o=Math.floor(2*t.bpPerPixel),a=this.featureSource.featureCache.queryFeatures(i,e-o,e+o),s=this;this.callSets&&a&&a.length>0&&a.forEach(function(t){t.start<=e+o&&t.end>e-o&&(l(s.callSets,t,r),r="ASC"===r?"DESC":"ASC",s.trackView.update())})},t.VariantTrack.prototype.popupData=function(e){var n=e.genomicLocation,i=(e.x,e.y),r=e.viewport.genomicState.referenceFrame;if(this.featureSource.featureCache){var o,a=r.chrName,l=Math.floor(2*r.bpPerPixel),c=this.featureSource.featureCache.queryFeatures(a,n-l,n+l),h="EXPANDED"===this.displayMode?this.expandedVGap:this.squishedVGap,u="EXPANDED"===this.displayMode?this.expandedGroupGap:this.squishedGroupGap,f=[],p=this;return c&&c.length>0&&c.forEach(function(e){var r,a,c,d,g;if(e.start<=n+l&&e.end>n-l)if(f.length>0&&f.push("<HR>"),"COLLAPSED"==p.displayMode)Array.prototype.push.apply(f,e.popupData(n,p.type));else if(i<=p.variantBandHeight)r=Math.floor((i-10)/(p.variantHeight+h)),e.row===r&&Array.prototype.push.apply(f,e.popupData(n),p.type);else if((c=p.callSets)&&e.calls){a="SQUISHED"===p.displayMode?p.squishedCallHeight:p.expandedCallHeight;var m=0;for(o=0;o<p.callSetGroups.length;o++){var v=p.callSetGroups[o],y=c[v].length;if(i<=p.variantBandHeight+h+(m+y)*(a+h)+o*u){r=Math.floor((i-(p.variantBandHeight+h+m*(a+h)+o*u))/(a+h));break}m+=y}r>=0&&(d=c[v][r],g=e.calls[d.id],Array.prototype.push.apply(f,function(e,n){var i,r,o,a="",l="",c="";if("str"===n.type){var h=n.info,u=h.AC?h.AC.split(","):void 0;if(!isNaN(e.genotype[0]))for(r=0;r<e.genotype.length;r++){o=s(e,n,r),a+=o,l+=(o.length/h.PERIOD).toString();var f=0===e.genotype[r]?h.REFAC:u[e.genotype[r]-1];c+=(parseInt(f)/parseInt(h.AN)).toFixed(3),r<e.genotype.length-1&&(a+=" | ",l+=" | ",c+=" | ")}}else e.genotype.forEach(function(e){a+=0===e?n.referenceBases:n.alternateBases[e-1]});i=[],void 0!==e.callSetName&&i.push({name:"Name",value:e.callSetName});i.push({name:"Genotype",value:a}),l&&i.push({name:"Repeats",value:l});c&&i.push({name:"Allele Fraction",value:c});void 0!==e.phaseset&&i.push({name:"Phase set",value:e.phaseset});void 0!==e.genotypeLikelihood&&i.push({name:"genotypeLikelihood",value:e.genotypeLikelihood.toString()});var p=t.sampleInformation.getAttributes(e.callSetName);p&&Object.keys(p).forEach(function(e){var t=e.replace(/([A-Z])/g," $1");t=t.charAt(0).toUpperCase()+t.slice(1),i.push({name:t,value:p[e]})});var d=Object.keys(e.info);d.length&&i.push("<hr>");return d.forEach(function(t){i.push({name:t,value:e.info[t]})}),i}(g,e)))}}),f}},t.VariantTrack.prototype.popupMenuItemList=function(e){var n=[],i=this;"NONE"!==this.groupBy&&t.sampleInformation.hasAttributes()&&n.push({name:"Sort groups",click:function(){try{i.callSetGroups.sort(function(e,t){return e-t})}catch(e){i.callSetGroups.sort()}i.trackView.update(),e.popover.hide()}});var o=e.viewport.genomicState.referenceFrame,a=e.genomicLocation,s=o.chrName,c=Math.floor(2*o.bpPerPixel),h=this.featureSource.featureCache.queryFeatures(s,a-c,a+c);return this.callSets&&h&&h.length>0&&h.forEach(function(t){t.start<=a+c&&t.end>a-c&&"str"===t.type&&n.push({name:"Sort by allele length",click:function(){l(i.callSets,t,r),r="ASC"===r?"DESC":"ASC",i.trackView.update(),e.popover.hide()}})}),n},t.VariantTrack.prototype.groupCallSets=function(e){var n,i,r=this,o={},a=[];Object.keys(this.callSets).forEach(function(s){r.callSets[s].forEach(function(r){i="NONE","NONE"!==e&&(n=t.sampleInformation.getAttributes(r.name))&&n[e]&&(i=n[e]),o.hasOwnProperty(i)||(o[i]=[],a.push(i)),o[i].push(r)})}),this.callSets=o,this.callSetGroups=a,this.groupBy=e,this.trackView.update()},t.VariantTrack.prototype.menuItemList=function(n){var r,o=this,a=[];if(r=["COLLAPSED","SQUISHED","EXPANDED"].map(function(t,i){return{object:e((r=i,a=t,s=o.displayMode,l={COLLAPSED:"Collapse",SQUISHED:"Squish",EXPANDED:"Expand"},c=0===r?'<div class="igv-track-menu-border-top">':"<div>",a===s?c+'<i class="fa fa-check fa-check-shim"></i>'+l[a]+"</div>":c+'<i class="fa fa-check fa-check-shim fa-check-hidden"></i>'+l[a]+"</div>")),click:function(){n.hide(),o.displayMode=t,o.trackView.update()}};var r,a,s,l,c}),a=a.concat(r),t.sampleInformation.hasAttributes()){var s={object:e('<div class="igv-track-menu-border-top">Group By:</div>')};a.push(s);var l={},c=t.sampleInformation.getAttributeNames();c.forEach(function(e){var t=e.replace(/([A-Z])/g," $1");t=t.charAt(0).toUpperCase()+t.slice(1),l[e]=t}),c.push("NONE"),l.NONE="None";var h=i.map(c,function(t,i){return{object:e((r=t,a=o.groupBy,s=l,r===a?'<div><i class="fa fa-check fa-check-shim"></i>'+s[r]+"</div>":'<div><i class="fa fa-check fa-check-shim fa-check-hidden"></i>'+s[r]+"</div>")),click:function(){n.hide(),o.groupCallSets(t)}};var r,a,s});a=a.concat(h)}return a},t}((Ae=function(e){function t(e){var t,n,i,r,o,a,s,l,c,h=e.alternateBases.split(","),u=e.referenceBases.length,f=e.referenceBases.length;e.info&&e.info.PERIOD&&(e.type="str"),e.alleles=[],"str"===e.type?(e.start=e.pos-1,e.end=e.start+e.referenceBases.length):(i=e.alternateBases)&&0!==i.trim().length&&"<NON_REF>"!==i&&"<*>"!==i||(e.type="refblock"),"refblock"===e.type?e.heterozygosity=0:("."===e.alternateBases?(t=e.pos-1,n=t+e.referenceBases.length):h.forEach(function(i,r){var o,a,s;e.alleles.push(i),"str"!==e.type&&i.length>0&&(a=(s=e.referenceBases.length-i.length)>0?(o=e.pos-1+i.length)+s:s<0?(o=e.pos-1+e.referenceBases.length)+1:(o=e.pos-1)+1,t=void 0===t?o:Math.min(t,o),n=void 0===n?a:Math.max(n,a)),u=Math.min(u,i.length),f=Math.max(f,i.length)}),e.start=t,e.end=n,e.info&&e.info.AC&&e.info.AN&&(e.heterozygosity=(r=e.info.AC,o=e.info.AN,s=0,l=Array.isArray(r)?r:r.split(","),c=0,o=Array.isArray(o)?parseInt(o[0]):parseInt(o),l.forEach(function(e){var t=parseInt(e),n=t/o;s+=n*n,c+=t}),1-(s+=(a=(o-c)/o)*a)).toFixed(3))),e.minAltLength=u,e.maxAltLength=f}function n(e,t){return void 0===t&&(t=","),Array.isArray(e)?e.join(t):e}return e.createVCFVariant=function(n){var i=new e.Variant;return i.chr=n[0],i.pos=parseInt(n[1]),i.names=n[2],i.referenceBases=n[3],i.alternateBases=n[4],i.quality=parseInt(n[5]),i.filter=n[6],i.info=function(e){if(!e)return;var t={};return e.split("; ").forEach(function(e){var n=e.split("=");t[n[0]]=n[1]}),t}(n[7]),t(i),i},e.createGAVariant=function(i){var r=new e.Variant;r.chr=i.referenceName,r.start=parseInt(i.start),r.end=parseInt(i.end),r.pos=r.start+1,r.names=n(i.names,"; "),r.referenceBases=i.referenceBases,r.alternateBases=n(i.alternateBases),r.quality=i.quality,r.filter=n(i.filter),r.info=i.info,r.calls={};var o;return i.calls&&i.calls.forEach(function(e){o=e.callSetId,r.calls[o]=e,0}),t(r),r},e.Variant=function(){},e.Variant.prototype.popupData=function(e){var t,i,r=this;return t=[{name:"Chr",value:this.chr},{name:"Pos",value:this.pos},{name:"Names",value:this.names?this.names:""},{name:"Ref",value:this.referenceBases},{name:"Alt",value:this.alternateBases},{name:"Qual",value:this.quality},{name:"Filter",value:this.filter}],this.hasOwnProperty("heterozygosity")&&t.push({name:"Heterozygosity",value:this.heterozygosity}),this.calls&&1===this.calls.length&&(t.push("<hr>"),i=this.alleles[this.calls[0].genotype[0]]+this.alleles[this.calls[0].genotype[1]],t.push({name:"Genotype",value:i})),this.info&&(t.push("<hr>"),Object.keys(this.info).forEach(function(e){t.push({name:e,value:n(r.info[e])})})),t},e.Variant.prototype.isRefBlock=function(){return"refblock"===this.type},e}((Ae=((Xe=Ae||{}).UserFeedback=function(t){var n=this;this.userFeedback=e('<div class="igv-user-feedback">'),t.append(this.userFeedback[0]),this.userFeedbackHeader=e("<div>"),this.userFeedback.append(this.userFeedbackHeader[0]),this.userFeedbackAlert=e('<i class="fa fa-exclamation-triangle">'),this.userFeedbackHeader.append(this.userFeedbackAlert[0]),this.userFeedbackDismiss=e('<i class="fa fa-times-circle">'),this.userFeedbackHeader.append(this.userFeedbackDismiss[0]),this.userFeedbackDismiss.click(function(){n.userFeedbackBodyCopy.html(""),n.userFeedback.hide()}),this.userFeedbackBodyCopy=e("<div>"),this.userFeedback.append(this.userFeedbackBodyCopy[0])},Xe.UserFeedback.prototype.show=function(){this.userFeedback.show()},Xe.UserFeedback.prototype.hide=function(){this.userFeedback.hide()},Xe.UserFeedback.prototype.bodyCopy=function(e){this.userFeedbackBodyCopy.html(e)},Xe))||{}))||{}))||{}))||{});return Ae=((Ke=Ae||{}).WindowSizePanel=function(t){this.$content=e('<div class="igv-windowsizepanel-content-div">'),t.append(this.$content)},Ke.WindowSizePanel.prototype.show=function(){this.$content.show()},Ke.WindowSizePanel.prototype.hide=function(){this.$content.hide()},Ke.WindowSizePanel.prototype.updateWithGenomicState=function(e){var t;1===e.locusCount&&"all"!==e.locusSearchString.toLowerCase()?this.show():this.hide(),t=Ke.Viewport.viewportWidthAtLocusIndex(e.locusIndex)*e.referenceFrame.bpPerPixel,this.$content.text(Ke.prettyBasePairNumber(Math.round(t)))},Ke)});